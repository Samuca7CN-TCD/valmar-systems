import{l as C,d as j,o as i,c as w,w as v,a as e,n as q,u as y,h as p,f as L,t as d,i as W,q as $,v as k,e as l,F as O,g as N,b as _,y as P,T as X,Z}from"./app-CQCMULRS.js";import{r as G,_ as H}from"./AppLayout-DVsrCAOA.js";import{_ as J}from"./CreateUpdateModal-CL67BBV8.js";import{_ as K}from"./PrimaryButton-CCpSxDR1.js";import{_ as Y}from"./SecondaryButton-CJwptiz7.js";import{g as A,t as R}from"./general-CW50Zh8a.js";import{r as ee}from"./PlusIcon-C8vVEu5u.js";import{r as te,a as se}from"./XMarkIcon-DDhLJnv-.js";import{r as z}from"./EyeIcon-CE4FUwbj.js";import{_ as oe}from"./FloatButton-C3J_W6e4.js";/* empty css                    */import{r as ae}from"./MagnifyingGlassIcon-4YeFiuBy.js";import"./Modal-15mIg7tU.js";import"./PrinterIcon-CfTT1zCI.js";const ne={class:"pb-12 space-y-12 divide-y-2"},ie={class:"py-4"},re=e("h2",{class:"text-base font-semibold leading-7 text-gray-900"},"Informações Básicas",-1),le=e("p",{class:"mt-1 text-sm leading-6 text-gray-600"},"Informações sobre a entrada como nome do funcionário, data da entrada e observações",-1),de={class:"mt-10 grid grid-cols-1 gap-x-6 gap-y-8 sm:grid-cols-6"},ce={class:"sm:col-span-3"},ue=e("label",{for:"entry-employee",class:"block text-sm font-medium leading-6 text-gray-900 required-input-label"},"Funcionário",-1),me={class:"mt-2"},pe={key:0,class:"text-red-500 text-sm"},ye={class:"sm:col-span-3"},he=e("label",{for:"entry-date",class:"block text-sm font-medium leading-6 text-gray-900 required-input-label"},"Data do Entrada",-1),xe={class:"mt-2"},_e=["max"],ve={key:0,class:"text-red-500 text-sm"},fe={class:"sm:col-span-6"},ge=e("label",{for:"entry-motive",class:"block text-sm font-medium leading-6 text-gray-900 required-input-label"},"Motivo",-1),be={class:"mt-2"},we={key:0,class:"text-red-500 text-sm"},qe={class:"sm:col-span-6"},$e=e("label",{for:"entry-observations",class:"block text-sm font-medium leading-6 text-gray-900"},"Observações",-1),ke={class:"mt-2"},Ce={key:0,class:"text-red-500 text-sm"},Ee={key:0,class:"py-4"},Ve=e("h2",{class:"text-base font-semibold leading-7 text-gray-900"},"Lista de Itens",-1),Se=e("p",{class:"mt-1 text-sm leading-6 text-gray-600"},"Adicione os itens do entrada.",-1),Me={class:"mt-10 grid grid-cols-1 gap-x-6 gap-y-8 sm:grid-cols-4"},Ie={class:"sm:col-span-4"},Ue={class:"relative"},Le=e("label",{for:"item-selecter",class:"block text-sm font-medium leading-6 text-gray-900"},"Selecione os itens de entrada",-1),De=["disabled"],Te={key:0,class:"absolute z-10 w-full mx-auto sm:w-96 bg-white border rounded mt-2 h-96 overflow-y-scroll"},je=["onMousedown"],Oe={class:"sm:col-span-4"},Be={key:0,class:"min-w-full text-left text-sm font-medium leading-6 text-gray-900"},Fe={class:"border-b font-medium"},Ne=e("th",{scope:"col",class:"px-6 py-4 text-center"},"#",-1),Ae=e("th",{scope:"col",class:"px-6 py-4 text-center"},"Item",-1),Re=e("th",{scope:"col",class:"px-6 py-4 text-center"},"Qtd. Estoque",-1),ze=e("th",{scope:"col",class:"px-6 py-4 text-center"},"Qtd. Entrada",-1),Qe=e("th",{scope:"col",class:"px-6 py-4 text-center"},"Und. Medida",-1),We={key:0,scope:"col",class:"px-6 py-4 text-center"},Pe={class:"whitespace-nowrap py-4 text-center font-medium"},Xe={class:"whitespace-nowrap py-4 text-center font-medium"},Ze={class:"whitespace-nowrap py-4 text-center font-medium flex justify-center"},Ge=["value","onInput","disabled"],He={class:"whitespace-nowrap py-4 text-center font-medium"},Je={key:0,class:"whitespace-nowrap py-4 text-center font-mono text-2xl"},Ke=["onClick","title"],Ye={key:1,class:"p-5 bg-gray-200 rounded-md block text-sm font-medium leading-6 text-gray-900"},et={__name:"CreateUpdateEntriesModal",props:{modal:Object,entry:{type:Object,default:null},items:Array},emits:["close","submit"],setup(s,{emit:E}){const V=E,n=s,b=/^\d{4}-\d{2}-\d{2}$/,S=C(()=>{const{motive:a,employee:o,date:t}=n.entry;return!o||!o.length||!a||!a.length?!1:t&&b.test(t)}),D=C(()=>{const{employee:a,motive:o,date:t,items_list:u}=n.entry;return!a||!a.length||!o||!o.length||!t||!b.test(t)||u.length<1?!1:u.every(U=>U.movement_quantity>0)}),h=C(()=>n.modal.mode==="see"),f=j(""),x=j(!1),B=C(()=>n.items.filter(a=>a.name.toLowerCase().includes(f.value.toLowerCase())&&!n.entry.items_list.some(o=>o.id===a.id))),T=a=>{a==="in"&&(x.value=!0),a==="out"&&(x.value=!1)},M=()=>{n.entry.estimated_value=n.entry.items_list.reduce((a,o)=>a+o.price*o.movement_quantity,0),n.entry.total_value=n.entry.estimated_value},F=a=>{n.entry.items_list.push({id:a.id,name:a.name,quantity:a.quantity,max_quantity:a.max_quantity,min_quantity:a.min_quantity,movement_quantity:1,measurement_unit:a.measurement_unit.abbreviation,price:a.price,amount:a.price}),f.value="",x.value=!1,M()},m=a=>{n.entry.items_list=n.entry.items_list.filter(o=>o.id!==a),M()},c=()=>{V("close")},r=()=>{V("submit")};return(a,o)=>(i(),w(J,{show:s.modal.show,maxWidth:S.value||h.value?"3xl":"2xl",onClose:c},{icon:v(()=>[e("div",{class:q(["mx-auto shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-blue-400 sm:mx-0 sm:h-10 sm:w-10",{"bg-yellow-400":s.modal.mode==="update","bg-green-400":s.modal.mode==="pay","bg-gray-400":s.modal.mode==="see"}])},[s.modal.mode==="create"?(i(),w(y(ee),{key:0,class:"w-5 h-5 text-white"})):p("",!0),s.modal.mode==="update"?(i(),w(y(te),{key:1,class:"w-5 h-5 text-white"})):p("",!0),s.modal.mode==="pay"?(i(),w(y(G),{key:2,class:"w-5 h-5 text-white"})):p("",!0),s.modal.mode==="see"?(i(),w(y(z),{key:3,class:"w-5 h-5 text-white"})):p("",!0)],2)]),title:v(()=>[L(d(s.modal.title),1)]),content:v(()=>[e("form",{onSubmit:W(r,["prevent"])},[e("div",ne,[e("section",ie,[re,le,e("div",de,[e("div",ce,[ue,e("div",me,[$(e("input",{type:"text",name:"entry-employee",id:"entry-employee",autocomplete:"on",class:"simple-input disabled:bg-gray-200",placeholder:"Nome do funcionario","onUpdate:modelValue":o[0]||(o[0]=t=>s.entry.employee=t),required:""},null,512),[[k,s.entry.employee]]),s.entry.errors.employee?(i(),l("p",pe,d(s.entry.errors.employee),1)):p("",!0)])]),e("div",ye,[he,e("div",xe,[$(e("input",{type:"date",name:"entry-date",id:"entry-date",autocomplete:"on",class:"simple-input disabled:bg-gray-200",autofocus:"true",placeholder:"Data do Entrada",max:y(A)(),"onUpdate:modelValue":o[1]||(o[1]=t=>s.entry.date=t),required:""},null,8,_e),[[k,s.entry.date]]),s.entry.errors.date?(i(),l("p",ve,d(s.entry.errors.date),1)):p("",!0)])]),e("div",fe,[ge,e("div",be,[$(e("input",{type:"text",name:"entry-motive",id:"entry-motive",autocomplete:"on",class:"simple-input disabled:bg-gray-200",placeholder:"Motivo do Entrada","onUpdate:modelValue":o[2]||(o[2]=t=>s.entry.motive=t),required:""},null,512),[[k,s.entry.motive]]),s.entry.errors.motive?(i(),l("p",we,d(s.entry.errors.motive),1)):p("",!0)])]),e("div",qe,[$e,e("div",ke,[$(e("textarea",{type:"text",observations:"entry-observations",id:"entry-observations",autocomplete:"on",class:"simple-input disabled:bg-gray-200",placeholder:"Descreva a título mais detalhadamente ou insira informações adicionais","onUpdate:modelValue":o[3]||(o[3]=t=>s.entry.observations=t)},null,512),[[k,s.entry.observations]]),s.entry.errors.observations?(i(),l("p",Ce,d(s.entry.errors.observations),1)):p("",!0)])])])]),S.value||h.value?(i(),l("section",Ee,[Ve,Se,e("div",Me,[e("div",Ie,[e("div",Ue,[Le,$(e("input",{id:"item-selecter","onUpdate:modelValue":o[4]||(o[4]=t=>f.value=t),onFocus:o[5]||(o[5]=t=>T("in")),onBlur:o[6]||(o[6]=t=>T("out")),class:"simple-input disabled:bg-gray-200 px-4 py-2 w-full",placeholder:"Digite para pesquisar",disabled:h.value},null,40,De),[[k,f.value]]),x.value?(i(),l("ul",Te,[(i(!0),l(O,null,N(B.value,(t,u)=>(i(),l("li",{key:u,class:"py-2 px-4 cursor-pointer hover:bg-gray-200",onMousedown:I=>F(t)},[e("span",{class:q(["inline",{"text-blue-500":t.quantity!=0&&t.quantity>=t.max_quantity,"text-green-500":t.quantity<t.max_quantity&&t.quantity>=t.min_quantity,"text-yellow-500":t.quantity<t.min_quantity&&t.quantity>0,"text-red-500":t.quantity==0}])},"("+d(t.quantity)+")",3),L(" "+d(t.name),1)],40,je))),128))])):p("",!0)])]),e("div",Oe,[n.entry.items_list.length?(i(),l("table",Be,[e("thead",Fe,[e("tr",null,[Ne,Ae,Re,ze,Qe,s.modal.mode!=="see"?(i(),l("th",We," Deletar")):p("",!0)])]),e("tbody",null,[(i(!0),l(O,null,N(n.entry.items_list,t=>(i(),l("tr",{key:t.id,class:q(["border-b transition duration-300 ease-in-out hover:bg-neutral-100 print:break-inside-avoid",{"bg-yellow-100":t.movement_quantity==t.quantity,"bg-red-100":t.movement_quantity>t.quantity}])},[e("td",Pe,d(t.id),1),e("td",Xe,d(t.name),1),e("td",{class:q(["whitespace-nowrap py-4 text-center font-medium",{"text-blue-500":t.quantity!=0&&t.quantity>=t.max_quantity,"text-green-500":t.quantity<t.max_quantity&&t.quantity>=t.min_quantity,"text-yellow-500":t.quantity<t.min_quantity&&t.quantity>0,"text-red-500":t.quantity==0}])},d(t.quantity),3),e("td",Ze,[e("input",{type:"number",min:"0.01",step:"0.01",value:t.movement_quantity,onInput:u=>{t.movement_quantity=parseFloat(u.target.value),t.amount=t.price*u.target.value,M()},class:"simple-input disabled:bg-gray-200 w-2/3",disabled:s.modal.mode!=="create"},null,40,Ge)]),e("td",He,d(t.measurement_unit),1),s.modal.mode!=="see"?(i(),l("td",Je,[e("button",{onClick:u=>m(t.id),title:"Remover "+t.name},"×",8,Ke)])):p("",!0)],2))),128))])])):(i(),l("p",Ye," Nenhum item selecionado até o momento!"))])])])):p("",!0)])],32)]),footer:v(()=>[s.modal.mode!=="see"?(i(),w(Y,{key:0,class:q({disabled:s.entry.processing}),onClick:o[7]||(o[7]=t=>c())},{default:v(()=>[L(" Cancelar ")]),_:1},8,["class"])):p("",!0),_(K,{class:q({disabled:s.entry.processing||!D.value}),disabled:s.entry.processing||!D.value,onClick:o[8]||(o[8]=t=>r())},{default:v(()=>[L(d(s.modal.primary_button_txt),1)]),_:1},8,["class","disabled"])]),_:1},8,["show","maxWidth"]))}},tt={class:"font-semibold text-xl text-gray-800 leading-tight"},st={class:"pt-12 print:hidden print:pt-0"},ot={class:"max-w-7xl mx-auto sm:px-6 lg:px-8 print:w-full"},at={class:"bg-white overflow-hidden shadow-xl sm:rounded-lg p-5"},nt={class:"flex flex-row items-center space-x-3"},it={class:"py-12 print:py-6"},rt={class:"max-w-7xl mx-auto print:max-w-full"},lt={class:"px-0 print:px-0"},dt={class:"bg-white overflow-hidden shadow-xl sm:rounded-lg print:shadow-none"},ct={class:"flex flex-col"},ut={class:"overflow-x-auto sm:-mx-6 lg:-mx-8"},mt={class:"inline-block min-w-full py-2 sm:px-6 lg:px-8"},pt={class:"overflow-hidden"},yt={class:"min-w-full text-left text-sm font-light"},ht=e("thead",{class:"border-b font-medium"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-4 text-center"},"#"),e("th",{scope:"col",class:"px-6 py-4 text-center"},"Funcionário"),e("th",{scope:"col",class:"px-6 py-4 text-center"},"Motivo"),e("th",{scope:"col",class:"px-6 py-4 text-center"},"Data do Entrada "),e("th",{scope:"col",class:"px-6 py-4 text-center print:hidden",colspan:"2"}," Ações")])],-1),xt={class:"border-b transition duration-300 ease-in-out hover:bg-neutral-100 print:break-inside-avoid"},_t={class:"whitespace-nowrap py-4 text-center font-medium"},vt={class:"whitespace-normal px-6 py-4 text-center trim"},ft=["title"],gt={class:"whitespace-nowrap px-2 py-4 text-center"},bt={class:"whitespace-nowrap px-2 py-4 text-center print:hidden"},wt=["title","onClick"],qt=["title","onClick"],$t={key:1,class:"transition duration-300 ease-in-out hover:bg-neutral-100 print:break-inside-avoid"},kt=e("td",{class:"whitespace-nowrap px-6 py-4 text-center",colspan:"9"},"Não há entradas cadastradas no momento!",-1),Ct=[kt],At={__name:"Entries",props:{page:Object,page_options:{type:Array,default:null},entries_list:Object,items:Object},setup(s){const E=s,V=P.useToast(),n=X({id:null,employee:"",motive:"",date:A(),total_value:0,observations:"",items_list:[]}),b=j(""),S=C(()=>{const m=b.value.toLowerCase();return E.entries_list.filter(c=>{const{id:r,entity_name:a,motive:o,observations:t,date:u,items:I}=c,U=[r.toString(),(a==null?void 0:a.toLowerCase())??"",(o==null?void 0:o.toLowerCase())??"",(t==null?void 0:t.toLowerCase())??"",(u==null?void 0:u.toLowerCase())??""];for(let g of U)if(g.includes(m))return!0;return I.some(g=>g.name.toLowerCase().includes(m))})}),D=C(()=>E.entries_list.reduce((m,c)=>m+c.accounting.partial_value,0)),h=j({mode:"create",show:!1,get title(){switch(this.mode){case"create":return"Criar entrada";case"update":return"Editar entrada";case"see":return"Ver informações da entrada"}},get primary_button_txt(){switch(this.mode){case"create":return"Cadastrar";case"update":return"Atualizar";case"see":return"Fechar"}}}),f=(m,c=null)=>{const r=["update","see"].includes(m);if(c!==null&&r){const a=E.entries_list.find(o=>o.id===c);if(a){const{id:o,entity_name:t,date:u,motive:I,observations:U,accounting:g,items:Q}=a;n.id=o,n.employee=t,n.motive=I,n.date=u,n.estimated_value=g.estimated_value,n.total_value=g.total_value,n.partial_value=g.partial_value,n.observations=U,n.items_list=Q}}h.value.mode=m,h.value.show=!0},x=()=>{n.reset(),h.value.show=!1},B=()=>{n.post(route("entries.store"),{preserveScroll:!0,onSuccess:()=>x(),onError:m=>{console.log(m)}})},T=()=>{n.put(route("entries.update",n.id),{preserveScroll:!0,onSuccess:()=>x()})},M=(m,c)=>{confirm(`Você tem certeza que deseja excluir a entrada de material para "${c}"? Todos os materiais comprados voltarão para o estoque! Esta ação não poderá ser desfeita!`)&&n.delete(route("entries.destroy",m),{preserveScroll:!0,onSuccess:()=>V.success("Entrada deletado com sucesso!")})},F=()=>{switch(h.value.mode){case"create":return B();case"update":return T();case"see":return x();default:V.error("Método desconhecido. Informar o Técnico.")}};return(m,c)=>(i(),l(O,null,[_(y(Z),{title:s.page.name},null,8,["title"]),_(H,{page:s.page,page_options:s.page_options},{header:v(()=>[e("h2",tt,d(s.page.name)+" | "+d(y(R)(D.value)),1),_(oe,{icon:"plus",onClick:c[0]||(c[0]=r=>f("create")),title:"Cadastrar Entry",class:"print:hidden"})]),default:v(()=>[e("div",st,[e("div",ot,[e("div",at,[e("div",nt,[_(y(ae),{class:"w-5 y-5"}),$(e("input",{type:"text",name:"search_term",id:"search_term",autocomplete:"on",class:"simple-input",autofocus:"true",placeholder:"Pesquisar termo...","onUpdate:modelValue":c[1]||(c[1]=r=>b.value=r)},null,512),[[k,b.value]])])])])]),e("div",it,[e("div",rt,[e("div",lt,[e("div",dt,[e("div",ct,[e("div",ut,[e("div",mt,[e("div",pt,[e("table",yt,[ht,e("tbody",null,[S.value.length?(i(!0),l(O,{key:0},N(S.value,r=>(i(),l("tr",xt,[e("td",_t,d(r.id),1),e("td",vt,[L(d(r.entity_name)+" ",1),r.observations?(i(),l("span",{key:0,title:r.observations,class:"inline-flex items-center rounded-md bg-gray-50 px-2 py-1 text-xs font-medium text-gray-600 ring-1 ring-inset ring-gray-500/10 cursor-help"},"OBS",8,ft)):p("",!0)]),e("td",gt,d(y(R)(r.motive)),1),e("td",bt,d(y(A)(r.date,!0)),1),e("td",{class:"whitespace-nowrap px-4 py-4 text-center cursor-pointer hover:text-indigo-700 active:text-indigo-900 select-none print:hidden",title:"VER: Compra de "+r.entity_name,onClick:a=>f("see",r.id)},[_(y(z),{class:"w-5 h-5 m-auto"})],8,wt),e("td",{class:"whitespace-nowrap px-4 py-4 text-center cursor-pointer hover:text-red-700 active:text-red-900 select-none print:hidden",title:"EXCLUIR: Compra de "+r.entity_name,onClick:a=>M(r.id,r.entity_name)},[_(y(se),{class:"w-5 h-5 m-auto"})],8,qt)]))),256)):(i(),l("tr",$t,Ct))])])])])])])])])])]),_(et,{modal:h.value,entry:y(n),items:s.items,onSubmit:F,onClose:x},null,8,["modal","entry","items"])]),_:1},8,["page","page_options"])],64))}};export{At as default};
