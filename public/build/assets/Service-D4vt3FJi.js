import{o as s,e as a,a as e,l as w,T as E,d as M,c as q,w as C,n as z,u as r,h as c,f as j,t as m,i as Q,q as y,v as f,F as N,g as G,b as _,Z as W}from"./app-wIlip3pR.js";import{_ as Y}from"./AppLayout-BbWcPMzy.js";import{r as Z,a as X,_ as ee}from"./CreateUpdateModal-Bn2Rq6uk.js";import{_ as te}from"./PrimaryButton-CFA6HZtj.js";import{_ as se}from"./SecondaryButton-B18wpBTD.js";import{e as k,t as $,g as F}from"./general-B4ZTqOfr.js";import{r as oe,_ as ae}from"./FloatButton-Cl9FbEB0.js";import{r as H}from"./BanknotesIcon-BW4l_CJL.js";import{r as re}from"./EyeIcon-DKKhZS4j.js";import{_ as le}from"./ExtraOptionsButton-IO_FbokD.js";import{r as ie}from"./MagnifyingGlassIcon-Ct-Qocut.js";import"./Modal-DEJQdgPt.js";import"./PrinterIcon-Bt7yR5Wr.js";function ne(t,V){return s(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 12.75 11.25 15 15 9.75M21 12c0 1.268-.63 2.39-1.593 3.068a3.745 3.745 0 0 1-1.043 3.296 3.745 3.745 0 0 1-3.296 1.043A3.745 3.745 0 0 1 12 21c-1.268 0-2.39-.63-3.068-1.593a3.746 3.746 0 0 1-3.296-1.043 3.745 3.745 0 0 1-1.043-3.296A3.745 3.745 0 0 1 3 12c0-1.268.63-2.39 1.593-3.068a3.745 3.745 0 0 1 1.043-3.296 3.746 3.746 0 0 1 3.296-1.043A3.746 3.746 0 0 1 12 3c1.268 0 2.39.63 3.068 1.593a3.746 3.746 0 0 1 3.296 1.043 3.746 3.746 0 0 1 1.043 3.296A3.745 3.745 0 0 1 21 12Z"})])}const de={class:"pb-12 space-y-12 divide-y-2"},ce={class:"py-4"},ue=e("h2",{class:"text-base font-semibold leading-7 text-gray-900"},"Informações Básicas",-1),me=e("p",{class:"mt-1 text-sm leading-6 text-gray-600"},"Informações sobre o serviço como título do serviço, nome do cliente, valores de pagamento e prazo para conclusão",-1),pe={class:"mt-10 grid grid-cols-1 gap-x-6 gap-y-8 sm:grid-cols-6"},ve={class:"sm:col-span-6"},xe=e("label",{for:"service-title",class:"block text-sm font-medium leading-6 text-gray-900 required-input-label"},"Título",-1),he={class:"mt-2"},_e=["disabled"],ge={key:0,class:"text-red-500 text-sm"},be={class:"sm:col-span-3"},ye=e("label",{for:"service-client",class:"block text-sm font-medium leading-6 text-gray-900 required-input-label"},"Cliente",-1),fe={class:"mt-2"},we=["disabled"],ke={key:0,class:"text-red-500 text-sm"},$e={class:"sm:col-span-3"},Ce=e("label",{for:"service-total-amount",class:"block text-sm font-medium leading-6 text-gray-900 required-input-label"},"Valor total",-1),Ve={class:"mt-2"},Se=["disabled"],De={key:0,class:"text-red-500 text-sm"},qe={class:"sm:col-span-6"},Ae=e("label",{for:"service-deadline",class:"block text-sm font-medium leading-6 text-gray-900 required-input-label"},"Prazo para conclusão",-1),Ue={class:"mt-2"},ze=["min","disabled"],Pe={key:0,class:"text-red-500 text-sm"},Re={class:"sm:col-span-6"},Te=e("label",{for:"service-observations",class:"block text-sm font-medium leading-6 text-gray-900"},"Observações",-1),je={class:"mt-2"},Oe=["disabled"],Le={key:0,class:"text-red-500 text-sm"},Ee={key:0,class:"py-4"},Me={class:"sm:col-span-6"},Ne=["title"],Be={class:"flex h-6 items-center"},Ie=["disabled"],Fe={class:"text-sm leading-6"},Ge={key:1,class:"py-4"},Ze={key:0},Xe=e("h2",{class:"text-base font-semibold leading-7 text-gray-900"},"Pagamentos concluídos",-1),He=e("p",{class:"mt-1 text-sm leading-6 text-gray-600"},"Insira o adiantamento ou os serviços parciais já realizando desta título",-1),Je=[Xe,He],Ke={key:1},Qe=e("h2",{class:"text-base font-semibold leading-7 text-gray-900"},"Lista de pagamentos concluídos",-1),We=e("p",{class:"mt-1 text-sm leading-6 text-gray-600"},"Abaixo está listado os registros de serviços realizados. Para adicionar novos serviços, ou remover algum serviço existente, entre na seção de serviço.",-1),Ye=[Qe,We],et={key:2},tt=e("h2",{class:"text-base font-semibold leading-7 text-gray-900"},"Realize um novo pagamento",-1),st=e("p",{class:"mt-1 text-sm leading-6 text-gray-600"},"Adicione um serviço ou remova um serviço existente.",-1),ot=[tt,st],at={key:3},rt=e("h2",{class:"text-base font-semibold leading-7 text-gray-900"},"Veja a lista de pagamentos realizados",-1),lt=e("p",{class:"mt-1 text-sm leading-6 text-gray-600"},"Abaixo segue a lista dos pagamentos concluídos deste serviço",-1),it=[rt,lt],nt={key:4,class:"mt-10 grid grid-cols-1 gap-x-6 gap-y-4 sm:grid-cols-6"},dt={class:"col-span-3"},ct=e("label",{for:"record-amount",class:"block text-sm font-medium leading-6 text-gray-900 required-input-label"},"Valor (R$)",-1),ut={class:"mt-2"},mt=["max","disabled"],pt={class:"text-gray-400 text-xs py-1"},vt={key:0,class:"text-red-500 text-sm"},xt={class:"sm:col-span-3"},ht=e("label",{for:"record-date",class:"block text-sm font-medium leading-6 text-gray-900 required-input-label"},"Data do serviço",-1),_t={class:"mt-2"},gt=["max","disabled"],bt=e("p",{class:"text-gray-400 text-xs py-1"},"Não aceita datas no futuro",-1),yt={key:0,class:"text-red-500 text-sm"},ft={key:5,class:"w-full py-5 flex justify-end"},wt=["disabled"],kt={key:6,class:"flex flex-col"},$t={class:"overflow-x-auto sm:-mx-6 lg:-mx-8"},Ct={class:"inline-block min-w-full py-2 sm:px-6 lg:px-8"},Vt={class:"overflow-hidden"},St={class:"min-w-full text-left text-sm font-light"},Dt={class:"border-b bg-white font-medium dark:border-neutral-500 dark:bg-neutral-600"},qt=e("th",{scope:"col",class:"px-6 py-4 text-center"},"Valor",-1),At=e("th",{scope:"col",class:"px-6 py-4 text-center"},"Data",-1),Ut={key:0,scope:"col",class:"px-6 py-4 text-center"},zt={class:"border-b bg-white dark:border-neutral-500 dark:bg-neutral-700"},Pt={class:"whitespace-nowrap px-6 text-center"},Rt={key:0,class:"w-full relative flex flex-wrap items-stretch"},Tt=e("span",{class:"w-1/4 select-none flex items-center whitespace-nowrap rounded-l border border-r-0 border-solid border-neutral-300 px-3 py-[0.25rem] text-center text-xs font-normal leading-[1.6] text-neutral-700 dark:border-neutral-600 dark:text-neutral-200 dark:placeholder:text-neutral-200",id:"basic-addon1"},"R$",-1),jt=["max","onUpdate:modelValue"],Ot={key:1},Lt={class:"whitespace-nowrap px-6 py-4 text-center"},Et={key:0,class:"w-full relative flex flex-wrap items-stretch"},Mt=["max","onUpdate:modelValue"],Nt={key:1},Bt={key:0,class:"whitespace-nowrap px-6 py-4 select-none"},It={key:1,class:"text-red-500 text-sm"},Ft={key:2,class:"text-red-500 text-sm"},Gt={key:0,class:"text-red-500 text-sm py-5 text-center"},Zt={key:1,class:"text-red-500 text-sm py-5 text-center"},Xt={key:2,class:"text-red-500 text-sm py-5 text-center"},Ht={key:7,class:"py-5 text-gray-400 text-center"},Jt={__name:"CreateUpdatePayModal",props:{modal:Object,service:{type:Object,default:null}},emits:["close","submit"],setup(t,{emit:V}){const v=V,d=t,P=w(()=>d.service.records_list.data.length+1),h=w(()=>R&&d.service.total_value-d.service.records_list.data.reduce((x,l)=>x+l.amount,0)),A=w(()=>{const x=new Date;return d.service.records_list.data.some(l=>new Date(l.date)>x)}),g=w(()=>d.service.records_list.data.some(x=>x.amount<=0)),U=w(()=>d.service.records_list.data.sort((x,l)=>new Date(x.date)-new Date(l.date))),b=w(()=>d.modal.mode==="pay"||d.modal.mode==="see"),R=w(()=>d.modal.mode!=="create"||d.service.records_list.enable_records),S=w(()=>d.service.title.length&&d.service.client.length&&d.service.total_value>0),u=E({id:P,amount:0,past:!1,register_date:k(),filepath:null}),T=M(!1),O=()=>{if(d.service.records_list.enable_records&&d.service.records_list.data.length)if(confirm("Tem certeza que deseja desmarcar? Todos os registros serão excluídos!"))d.service.records_list.data.length=[],u.reset();else return;d.service.records_list.enable_records=!d.service.records_list.enable_records},L=()=>{if(!u.amount||u.amount>h.value){u.errors.amount=`O valor do registro deve ser maior que R$ 0,00 e menor que ${$(h.value)}`;return}if(u.errors.amount="",!u.register_date||new Date(u.register_date)>new Date){u.errors.date=`A data do registro deve ser menor ou igual a ${k()}`;return}u.errors.date="",T.value||(u.filepath=null),d.service.records_list.data.push({...u}),T.value=!1,u.reset()},p=(x,l=null)=>{if(d.modal.mode==="create"){d.service.records_list.data=d.service.records_list.data.filter(o=>o.id!==x);return}else confirm("Você tem certeza que deseja excluir esse registro? (Essa ação não pode ser desfeita)")&&l.delete(route("records.destroy",x),{preserveScroll:!0,onSuccess:()=>{d.service.records_list.data=d.service.records_list.data.filter(o=>o.id!==x)}})},n=()=>{v("close")},i=()=>{v("submit")};return(x,l)=>(s(),q(ee,{show:t.modal.show,onClose:n},{icon:C(()=>[e("div",{class:z(["mx-auto shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-blue-400 sm:mx-0 sm:h-10 sm:w-10",{"bg-yellow-400":t.modal.mode==="update","bg-green-400":t.modal.mode==="pay","bg-gray-400":t.modal.mode==="see"}])},[t.modal.mode==="create"?(s(),q(r(oe),{key:0,class:"w-5 h-5 text-white"})):c("",!0),t.modal.mode==="update"?(s(),q(r(Z),{key:1,class:"w-5 h-5 text-white"})):c("",!0),t.modal.mode==="pay"?(s(),q(r(H),{key:2,class:"w-5 h-5 text-white"})):c("",!0),t.modal.mode==="see"?(s(),q(r(re),{key:3,class:"w-5 h-5 text-white"})):c("",!0)],2)]),title:C(()=>[j(m(t.modal.title),1)]),content:C(()=>[e("form",{onSubmit:Q(i,["prevent"])},[e("div",de,[e("section",ce,[ue,me,e("div",pe,[e("div",ve,[xe,e("div",he,[y(e("input",{type:"text",name:"service-title",id:"service-title",autocomplete:"on",class:"simple-input disabled:bg-gray-200",autofocus:"true",placeholder:"Título da título",disabled:b.value,"onUpdate:modelValue":l[0]||(l[0]=o=>t.service.title=o),required:""},null,8,_e),[[f,t.service.title]]),t.service.errors.title?(s(),a("p",ge,m(t.service.errors.title),1)):c("",!0)])]),e("div",be,[ye,e("div",fe,[y(e("input",{type:"text",name:"service-client",id:"service-client",autocomplete:"on",class:"simple-input disabled:bg-gray-200",placeholder:"Nome do cliente",disabled:b.value,"onUpdate:modelValue":l[1]||(l[1]=o=>t.service.client=o),required:""},null,8,we),[[f,t.service.client]]),t.service.errors.client?(s(),a("p",ke,m(t.service.errors.client),1)):c("",!0)])]),e("div",$e,[Ce,e("div",Ve,[y(e("input",{id:"service-total-amount",name:"service-total-amount",type:"number",step:"0.01",min:"0",autocomplete:"off",class:"simple-input disabled:bg-gray-200",placeholder:"Valor total inicial da título",disabled:b.value,"onUpdate:modelValue":l[2]||(l[2]=o=>t.service.total_value=o),required:""},null,8,Se),[[f,t.service.total_value]]),t.service.errors.total_value?(s(),a("p",De,m(t.service.errors.total_value),1)):c("",!0)])]),e("div",qe,[Ae,e("div",Ue,[y(e("input",{type:"date",name:"service-deadline",id:"service-deadline",autocomplete:"on",class:"simple-input disabled:bg-gray-200",autofocus:"true",placeholder:"Prazo para conclusão",min:r(k)(),disabled:b.value,"onUpdate:modelValue":l[3]||(l[3]=o=>t.service.deadline=o),required:""},null,8,ze),[[f,t.service.deadline]]),t.service.errors.deadline?(s(),a("p",Pe,m(t.service.errors.deadline),1)):c("",!0)])]),e("div",Re,[Te,e("div",je,[y(e("textarea",{type:"text",observations:"service-observations",id:"service-observations",autocomplete:"on",class:"simple-input disabled:bg-gray-200",placeholder:"Descreva a título mais detalhadamente ou insira informações adicionais",disabled:b.value,"onUpdate:modelValue":l[4]||(l[4]=o=>t.service.observations=o)},null,8,Oe),[[f,t.service.observations]]),t.service.errors.observations?(s(),a("p",Le,m(t.service.errors.observations),1)):c("",!0)])])])]),t.modal.mode==="create"?(s(),a("section",Ee,[e("div",Me,[e("div",{class:"mt-2 relative flex gap-x-3",title:S.value?"":"Preencha ao menos a título, o cliente e o valor total."},[e("div",Be,[e("input",{id:"service-enable-records",name:"service-enable-records",type:"checkbox",onChange:l[5]||(l[5]=o=>O()),disabled:!S.value,class:"h-4 w-4 rounded border-gray-300 text-green-600 focus:ring-green-600 disabled:border-gray-100 disabled:text-green-200 disabled:bg-gray-300"},null,40,Ie)]),e("div",Fe,[e("label",{for:"service-enable-records",class:z(["font-medium text-gray-900 select-none cursor-pointer",{"text-gray-300":!S.value,"cursor-not-allowed":!S.value}])},"Adicionar pagamentos concluídos",2)])],8,Ne)])])):c("",!0),R.value?(s(),a("section",Ge,[t.modal.mode==="create"?(s(),a("div",Ze,Je)):c("",!0),t.modal.mode==="update"?(s(),a("div",Ke,Ye)):c("",!0),t.modal.mode==="pay"?(s(),a("div",et,ot)):c("",!0),t.modal.mode==="see"?(s(),a("div",at,it)):c("",!0),t.modal.mode!=="update"&&t.modal.mode!=="see"?(s(),a("div",nt,[e("div",dt,[ct,e("div",ut,[y(e("input",{id:"record-amount",name:"record-amount",type:"number",step:"0.01",min:"0",max:h.value,autocomplete:"off",class:"simple-input disabled:bg-gray-200 disabled:opacity-75",disabled:h.value==0,placeholder:"Valor do serviço parcial","onUpdate:modelValue":l[6]||(l[6]=o=>r(u).amount=o)},null,8,mt),[[f,r(u).amount]]),e("p",pt,"Valor Restante:y "+m(r($)(h.value)),1),r(u).errors.amount?(s(),a("p",vt,m(r(u).errors.amount),1)):c("",!0)])]),e("div",xt,[ht,e("div",_t,[y(e("input",{id:"record-date",name:"record-date",type:"date",max:r(k)(),autocomplete:"off",class:"simple-input disabled:bg-gray-200",disabled:h.value==0,placeholder:"Data de serviço do valor parcial","onUpdate:modelValue":l[7]||(l[7]=o=>r(u).register_date=o)},null,8,gt),[[f,r(u).register_date]]),bt,r(u).errors.date?(s(),a("p",yt,m(r(u).errors.date),1)):c("",!0)])])])):c("",!0),t.modal.mode!=="update"&&t.modal.mode!=="see"?(s(),a("div",ft,[e("button",{type:"button",class:"w-full px-4 py-2 bg-blue-600 border border-gray-300 rounded-md font-semibold text-xs text-white uppercase tracking-widest shadow-sm hover:bg-blue-700 focus:outline-none focus:border-blue-300 focus:ring focus:ring-blue-200 active:text-gray-800 active:bg-gray-50 disabled:opacity-25 transition",disabled:!r(u).amount||!r(u).register_date||r(u).amount>h.value,onClick:l[8]||(l[8]=o=>L())}," Inserir registro ",8,wt)])):c("",!0),t.service.records_list.data.length?(s(),a("div",kt,[e("div",$t,[e("div",Ct,[e("div",Vt,[e("table",St,[e("thead",Dt,[e("tr",null,[qt,At,t.modal.mode!=="pay"&&t.modal.mode!=="see"?(s(),a("th",Ut,"Excluir")):c("",!0)])]),e("tbody",null,[(s(!0),a(N,null,G(U.value,o=>(s(),a("tr",zt,[e("td",Pt,[t.modal.mode!=="update"&&!o.past?(s(),a("div",Rt,[Tt,y(e("input",{id:"record_item-amount-edit",name:"record_item-amount-edit",type:"number",step:"0.01",min:"0",max:h.value,autocomplete:"off",class:"relative m-0 block min-w-0 flex-auto rounded-r border border-solid border-neutral-300 bg-transparent bg-clip-padding px-3 py-[0.25rem] text-xs font-normal leading-[1.6] text-neutral-700 outline-none transition duration-200 ease-in-out focus:z-[3] focus:border-primary focus:text-neutral-700 focus:shadow-[inset_0_0_0_1px_rgb(59,113,202)] focus:outline-none dark:border-neutral-600 dark:text-neutral-200 dark:placeholder:text-neutral-200 dark:focus:border-primary disabled:bg-gray-200",placeholder:"Editar serviço parcial","onUpdate:modelValue":D=>o.amount=D},null,8,jt),[[f,o.amount]])])):(s(),a("p",Ot,m(r($)(o.amount)),1))]),e("td",Lt,[t.modal.mode!=="update"&&!o.past?(s(),a("div",Et,[y(e("input",{id:"record-date",name:"record-date",type:"date",max:r(k)(),autocomplete:"off",class:"w-3/4 relative m-0 block min-w-0 flex-auto rounded-r border border-solid border-neutral-300 bg-transparent bg-clip-padding px-3 py-[0.25rem] text-xs font-normal leading-[1.6] text-neutral-700 outline-none transition duration-200 ease-in-out focus:z-[3] focus:border-primary focus:text-neutral-700 focus:shadow-[inset_0_0_0_1px_rgb(59,113,202)] focus:outline-none dark:border-neutral-600 dark:text-neutral-200 dark:placeholder:text-neutral-200 dark:focus:border-primary disabled:bg-gray-200",placeholder:"Data de serviço do valor parcial","onUpdate:modelValue":D=>o.register_date=D},null,8,Mt),[[f,o.register_date]])])):(s(),a("p",Nt,m(r(k)(o.register_date,!0)),1))]),t.modal.mode!=="pay"&&t.modal.mode!=="see"?(s(),a("td",Bt,[_(r(X),{class:"w-5 h-5 cursor-pointer m-auto text-gray-700 hover:text-red-500 active:text-red-700",onClick:D=>p(o.id,o),title:"Remover este registro"},null,8,["onClick"])])):c("",!0),o.errors.amount?(s(),a("p",It,m(o.errors.amount),1)):c("",!0),o.errors.date?(s(),a("p",Ft,m(o.errors.date),1)):c("",!0)]))),256))])]),h.value<0?(s(),a("p",Gt,"A soma dos serviços não pode ser maior que "+m(r($)(t.service.total_value)),1)):c("",!0),A.value?(s(),a("p",Zt,"Todas as datas de registro devem ser não nulas e menores ou iguais a "+m(r(k)(new Date)),1)):c("",!0),g.value?(s(),a("p",Xt,"Todos os valores devem ser maiores que R$ 0,00")):c("",!0)])])])])):(s(),a("div",Ht,"Não há registro de pagamento no momento."))])):c("",!0)])],32)]),footer:C(()=>[t.modal.mode!=="see"?(s(),q(se,{key:0,class:z({disabled:t.service.processing}),onClick:l[9]||(l[9]=o=>n())},{default:C(()=>[j(" Cancelar ")]),_:1},8,["class"])):c("",!0),_(te,{class:z({disabled:t.service.processing||h.value<0||A.value||g.value}),disabled:t.service.processing||h.value<0||A.value||g.value,onClick:l[10]||(l[10]=o=>i())},{default:C(()=>[j(m(t.modal.primary_button_txt),1)]),_:1},8,["class","disabled"])]),_:1},8,["show"]))}},Kt={class:"font-semibold text-xl text-gray-800 leading-tight"},Qt={class:"pt-12 print:hidden print:pt-0"},Wt={class:"max-w-7xl mx-auto sm:px-6 lg:px-8 print:w-full"},Yt={class:"bg-white overflow-hidden shadow-xl sm:rounded-lg p-5"},es={class:"flex flex-row items-center space-x-3"},ts={class:"py-12 print:py-6"},ss={class:"max-w-7xl mx-auto print:max-w-full"},os={class:"px-0 print:px-0"},as={class:"bg-white overflow-hidden shadow-xl sm:rounded-lg print:shadow-none"},rs={class:"flex flex-col"},ls={class:"overflow-x-auto sm:-mx-6 lg:-mx-8"},is={class:"inline-block min-w-full py-2 sm:px-6 lg:px-8"},ns={class:"overflow-hidden"},ds={class:"min-w-full text-left text-sm font-light"},cs=e("thead",{class:"border-b font-medium dark:border-neutral-500"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-4 text-center"},"#"),e("th",{scope:"col",class:"px-6 py-4 text-center"},"Prazo"),e("th",{scope:"col",class:"px-6 py-4 text-center"},"Título"),e("th",{scope:"col",class:"px-6 py-4 text-center"},"Cliente"),e("th",{scope:"col",class:"px-6 py-4 text-center"},"À pagar"),e("th",{scope:"col",class:"px-6 py-4 text-center"},"Valor total"),e("th",{scope:"col",class:"px-6 py-4 text-center print:hidden"},"Entrega "),e("th",{scope:"col",class:"px-6 py-4 text-center print:hidden",colspan:"4"},"Ações ")])],-1),us={class:"border-b transition duration-300 ease-in-out hover:bg-neutral-100 print:break-inside-avoid"},ms={class:"whitespace-nowrap py-4 text-center font-medium"},ps={class:"whitespace-normal px-6 py-4 text-center trim"},vs=["title"],xs={class:"whitespace-normal px-6 py-4 text-center"},hs={class:"whitespace-nowrap px-2 py-4 text-center"},_s={class:"whitespace-nowrap px-2 py-4 text-center"},gs={class:"whitespace-nowrap px-2 py-4 text-center print:hidden"},bs=["title","onClick"],ys=["title","onClick"],fs={key:0},ws={key:1,class:"m-auto text-center"},ks=["title","onClick"],$s=["title","onClick"],Cs={key:1,class:"transition duration-300 ease-in-out hover:bg-neutral-100 print:break-inside-avoid"},Vs=e("td",{class:"whitespace-nowrap px-6 py-4 text-center",colspan:"9"},"Não há serviços cadastrados no momento!",-1),Ss=[Vs],Ns={__name:"Service",props:{page:Object,page_options:{type:Array,default:null},services_list:Object},setup(t){const V=t,v=E({id:null,title:"",client:"",total_value:0,partial_value:0,observations:"",deadline:k(new Date(Date.now()+15*24*60*60*1e3),"new_date"),records_list:{enable_records:!1,data:[]}}),d=M(""),P=w(()=>{const p=d.value.toLowerCase();return V.services_list.filter(n=>n.motive.toLowerCase().includes(p)||n.entity_name.toLowerCase().includes(p)||n.observations.toLowerCase().includes(p)||$(n.accounting.total_value).toString().toLowerCase().includes(p)||$(n.accounting.partial_value).toString().toLowerCase().includes(p)||n.deadline.includes(p))}),h=w(()=>V.services_list.reduce((p,n)=>p+n.accounting.partial_value,0)),A=p=>{const n=F(p);return n===0?"text-red-500":n>0&&n<8?"text-orange-500":n>7&&n<15?"text-yellow-500":n>14&&n<30?"text-green-500":"text-blue-500"},g=M({mode:"create",show:!1,get title(){switch(this.mode){case"create":return"Criar serviço";case"update":return"Editar serviço";case"pay":return"Pagar serviço";case"see":return"Ver informações do serviço"}},get primary_button_txt(){switch(this.mode){case"create":return"Cadastrar";case"update":return"Atualizar";case"pay":return"Pagar";case"see":return"Fechar"}}}),U=(p,n=null)=>{const i=["update","pay"].includes(p);if(n!==null&&i){const x=V.services_list.find(l=>l.id===n);if(x){const{id:l,motive:o,entity_name:D,observations:J,records:B,accounting:I}=x;v.id=l,v.title=o,v.client=D,v.total_value=I.total_value,v.partial_value=I.partial_value,v.observations=J,v.records_list.enable_records=!!B.length,v.records_list.data=B.map(K=>E(K))}}g.value.mode=p,g.value.show=!0},b=()=>{v.reset(),g.value.show=!1},R=()=>{v.post(route("services.store"),{preserveScroll:!0,onSuccess:()=>b(),onError:p=>{console.log(p)}})},S=()=>{v.put(route("services.update",v.id),{preserveScroll:!0,onSuccess:()=>b()})},u=()=>{v.put(route("services.pay",v.id),{preserveScroll:!0,onSuccess:()=>b()})},T=(p,n)=>{if(n!==0){if(!confirm("O serviço será considerado como concluído e será listado apenas na página de pagamentos"))return}else if(!confirm("O serviço será considerado concluído e pago!"))return;v.put(route("services.conclude",p),{preserveScroll:!0})},O=(p,n)=>{confirm(`Você tem certeza que deseja excluir o serviço "${n}"? Esta ação não poderá ser desfeita!`)&&v.delete(route("services.destroy",p),{preserveScroll:!0,onSuccess:()=>alert("Serviço deletado com sucesso!")})},L=()=>{switch(g.value.mode){case"create":return R();case"update":return S();case"pay":return u();default:alert("Método desconhecido. Informar o Técnico.")}};return(p,n)=>(s(),a(N,null,[_(r(W),{title:t.page.name},null,8,["title"]),_(Y,{page:t.page,page_options:t.page_options},{header:C(()=>[e("h2",Kt,m(t.page.name)+" | "+m(r($)(h.value)),1),_(ae,{icon:"plus",onClick:n[0]||(n[0]=i=>U("create")),title:"Cadastrar Service",class:"print:hidden"})]),default:C(()=>[e("div",Qt,[e("div",Wt,[e("div",Yt,[e("div",es,[_(r(ie),{class:"w-5 y-5"}),y(e("input",{type:"text",name:"search_term",id:"search_term",autocomplete:"on",class:"simple-input",autofocus:"true",placeholder:"Pesquisar termo...","onUpdate:modelValue":n[1]||(n[1]=i=>d.value=i)},null,512),[[f,d.value]])])])])]),e("div",ts,[e("div",ss,[e("div",os,[e("div",as,[e("div",rs,[e("div",ls,[e("div",is,[e("div",ns,[e("table",ds,[cs,e("tbody",null,[P.value.length?(s(!0),a(N,{key:0},G(P.value,i=>(s(),a("tr",us,[e("td",ms,m(i.id),1),e("td",{class:z(["whitespace-nowrap py-4 text-center font-medium",A(i.deadline)])},m(r(F)(i.deadline))+" dias ",3),e("td",ps,[j(m(i.motive)+" ",1),i.observations?(s(),a("span",{key:0,title:i.observations,class:"inline-flex items-center rounded-md bg-gray-50 px-2 py-1 text-xs font-medium text-gray-600 ring-1 ring-inset ring-gray-500/10 cursor-help"},"OBS",8,vs)):c("",!0)]),e("td",xs,m(i.entity_name),1),e("td",hs,m(r($)(i.accounting.partial_value)),1),e("td",_s,m(r($)(i.accounting.total_value)),1),e("td",gs,m(r(k)(i.deadline,!0)),1),e("td",{class:"whitespace-nowrap px-4 py-4 pl-10 text-center cursor-pointer hover:text-blue-700 active:text-blue-900 select-none print:hidden",title:"CONCLUIR: "+i.motive+"("+i.entity_name+")",onClick:x=>T(i.id,i.accounting.partial_value)},[_(r(ne),{class:"w-4 h-4 m-auto"})],8,bs),e("td",{class:"whitespace-nowrap px-4 py-4 text-center cursor-pointer hover:text-green-700 active:text-green-900 select-none print:hidden",title:"PAGAR: "+i.motive+"("+i.entity_name+")",onClick:x=>U("pay",i.id)},[i.accounting.partial_value!==0?(s(),a("span",fs,[_(r(H),{class:"w-4 h-4 m-auto"})])):(s(),a("span",ws,"PAGO"))],8,ys),e("td",{class:"whitespace-nowrap px-4 py-4 text-center cursor-pointer hover:text-yellow-700 active:text-yellow-900 select-none print:hidden",title:"EDITAR: "+i.motive+"("+i.entity_name+")",onClick:x=>U("update",i.id)},[_(r(Z),{class:"w-4 h-4 m-auto"})],8,ks),e("td",{class:"whitespace-nowrap px-4 py-4 text-center cursor-pointer hover:text-red-700 active:text-red-900 select-none print:hidden",title:"EXCLUIR: "+i.motive+"("+i.entity_name+")",onClick:x=>O(i.id,i.name)},[_(r(X),{class:"w-4 h-4 m-auto"})],8,$s)]))),256)):(s(),a("tr",Cs,Ss))])])])])])])])])])]),_(Jt,{show:g.value.show,modal:g.value,service:r(v),onSubmit:L,onClose:b},null,8,["show","modal","service"]),_(le,{mode:["rollup","print_page","link"],link_type:["previous"],link:[p.route("services.previous")]},null,8,["link"])]),_:1},8,["page","page_options"])],64))}};export{Ns as default};
