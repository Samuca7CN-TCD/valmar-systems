import{m as Q,T as W,r as L,p as Y,q as tt,k as $,d as n,o as d,b,u as o,Z as et,w as k,a as t,h as ot,s as m,v as u,e as _,t as l,f as p,F as O,g as j,x as st,y as G}from"./app-nxAEGYom.js";import{_ as it}from"./AppLayout-CD0ic9x9.js";import{f as at,a as lt,b as nt,c as dt,d as rt,t as Z}from"./general-D_37hS-e.js";/* empty css                    */import{_ as ct}from"./ClientSelector-CaM6P7Eb.js";import{_ as mt}from"./PrimaryButton-DeVtbJBJ.js";import{r as ut}from"./TrashIcon-N_mDIAhC.js";import{r as _t}from"./PlusIcon-C0zORJhm.js";import"./lodash-Bti6KRHC.js";const pt={class:"font-semibold text-xl text-gray-800 leading-tight"},bt={class:"py-12"},gt={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},xt={class:"bg-white overflow-hidden shadow-xl sm:rounded-lg"},yt={class:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8 text-sm items-end"},ft=t("div",null,[t("label",{class:"block text-sm font-medium text-gray-700"},[p("ORÇAMENTO Nº: "),t("span",{class:"font-semibold text-gray-900"},"NOVO")])],-1),ht=t("label",{for:"budget_date",class:"block text-sm font-medium text-gray-700"},"EMITIDO EM:",-1),vt=t("label",{for:"validity",class:"block text-sm font-medium text-gray-700"},"VALIDADE (em dias)",-1),kt={class:"mb-8"},Ot=t("h3",{class:"text-lg font-semibold text-gray-900 border-b pb-2 mb-4"},"DADOS DO CLIENTE",-1),Ct={class:"grid grid-cols-1 gap-6"},At={class:"sm:col-span-1"},Et=t("label",{for:"client-selector",class:"block text-sm font-medium text-gray-700 required-input-label"},"Selecionar Cliente",-1),Dt={key:0,class:"text-red-500 text-xs mt-1"},Nt={key:0,class:"mt-4 text-center text-sm text-gray-500"},Bt={key:1,class:"mt-4 p-4 border rounded-lg bg-gray-50 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 text-sm"},It={class:"font-medium text-gray-700"},Vt=t("span",{class:"font-semibold block text-gray-500"},"Nome:",-1),Tt={class:"font-medium text-gray-700"},wt={class:"font-semibold block text-gray-500"},St={class:"font-medium text-gray-700"},Rt=t("span",{class:"font-semibold block text-gray-500"},"E-mail:",-1),Ut={class:"font-medium text-gray-700"},Ft=t("span",{class:"font-semibold block text-gray-500"},"CEP:",-1),Pt={class:"font-medium text-gray-700"},Mt=t("span",{class:"font-semibold block text-gray-500"},"Endereço:",-1),qt={class:"font-medium text-gray-700"},Lt=t("span",{class:"font-semibold block text-gray-500"},"Contatos:",-1),$t={key:1},jt={class:""},Gt=["href"],Zt={class:"mb-8"},Jt=t("h3",{class:"text-lg font-semibold text-gray-900 border-b pb-2 mb-4"},"DADOS DO TÍTULO",-1),Xt=t("label",{for:"title",class:"block text-sm font-medium text-gray-700"},"TÍTULO IDENTIFICADOR DO SERVIÇO",-1),zt={key:0,class:"text-red-500 text-xs mt-1"},Ht={class:"mb-8"},Kt=t("h3",{class:"text-lg font-semibold text-gray-900 border-b pb-2 mb-4"},"ITENS DO ORÇAMENTO",-1),Qt={class:"space-y-4"},Wt=["onClick"],Yt={class:"grid grid-cols-1 md:grid-cols-12 gap-4"},te={class:"md:col-span-10"},ee=t("label",{class:"block text-sm font-medium text-gray-700"},"DESCRIÇÃO",-1),oe=["onUpdate:modelValue"],se={class:"md:col-span-2"},ie=t("label",{class:"block text-sm font-medium text-gray-700"},"VALOR (R$)",-1),ae=["onUpdate:modelValue","onInput"],le={class:"mb-8 p-4 bg-gray-50 rounded-lg"},ne=t("h3",{class:"text-lg font-semibold text-gray-900 border-b pb-2 mb-4"},"TOTAIS",-1),de={class:"grid grid-cols-2 gap-4 items-center"},re=t("label",{for:"discount_amount",class:"block text-sm font-medium text-gray-700"},"DESCONTO (R$)",-1),ce=t("label",{for:"additional_amount",class:"block text-sm font-medium text-gray-700"},"ACRÉSCIMO (R$)",-1),me={class:"text-lg font-semibold text-gray-900"},ue={class:"text-lg font-bold text-gray-900 text-right"},_e={class:"mb-8"},pe=t("h3",{class:"text-lg font-semibold text-gray-900 border-b pb-2 mb-4"},"RESPONSABILIDADES ",-1),be={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ge=t("label",{for:"contracted_responsibility",class:"block text-sm font-medium text-gray-700"},"DA CONTRATADA",-1),xe={key:0,class:"text-red-500 text-xs mt-1"},ye=t("label",{for:"contractor_responsibility",class:"block text-sm font-medium text-gray-700"},"DO CONTRATANTE",-1),fe={key:0,class:"text-red-500 text-xs mt-1"},he={class:"mb-8"},ve=t("h3",{class:"text-lg font-semibold text-gray-900 border-b pb-2 mb-4"},"Outras Informações",-1),ke={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Oe=t("h4",{class:"text-md font-semibold text-gray-800 mb-2"},"DO SERVIÇO",-1),Ce={class:"mb-4"},Ae=t("label",{for:"description",class:"block text-sm font-medium text-gray-700"},"OBSERVAÇÕES",-1),Ee={key:0,class:"text-red-500 text-xs mt-1"},De={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Ne=t("label",{for:"deadline",class:"block text-sm font-medium text-gray-700"},"PRAZO (em dias)",-1),Be={key:0,class:"text-red-500 text-xs mt-1"},Ie=t("label",{for:"deadline_type",class:"block text-sm font-medium text-gray-700"},"TIPO DE PRAZO",-1),Ve=t("option",{value:"dias úteis"},"Dias Úteis",-1),Te=t("option",{value:"dias corridos"},"Dias Corridos",-1),we=[Ve,Te],Se={key:0,class:"text-red-500 text-xs mt-1"},Re={class:"mt-4"},Ue=t("label",{for:"deadline_start_description",class:"block text-sm font-medium text-gray-700"},"INÍCIO DO PRAZO",-1),Fe={key:0,class:"text-red-500 text-xs mt-1"},Pe=t("h4",{class:"text-md font-semibold text-gray-800 mb-2"},"DO PAGAMENTO",-1),Me={class:"mb-4"},qe=t("label",{for:"payment_method_description",class:"block text-sm font-medium text-gray-700"},"FORMA DE PAGAMENTO",-1),Le={key:0,class:"text-red-500 text-xs mt-1"},$e=t("label",{for:"bank_info_description",class:"block text-sm font-medium text-gray-700"},"INFORMAÇÕES BANCÁRIAS",-1),je={key:0,class:"text-red-500 text-xs mt-1"},Ge={class:"flex justify-end space-x-4 mt-8 border-t pt-5"},Ze="Fornecer todo material de fabricação e consumo",Je="a partir do pagamento de entrada",Xe=`50% entrada
50% no ato da entrega do serviço`,ze=`BANCO DO BRASIL
AG: 3175-5 | C/C: 20.439-0
PIX: (73) 9 8855-9571`,io={__name:"Create",props:{page:Object,originalBudget:{type:Object,default:null}},setup(f){var E,D,N,B,I,V,T,w,S,R,U,F,P,M,q;const r=f,h=Q.useToast(),e=W({title:((E=r.originalBudget)==null?void 0:E.title)||"",validity:((D=r.originalBudget)==null?void 0:D.validity)||30,client_id:((N=r.originalBudget)==null?void 0:N.client_id)||null,description:((B=r.originalBudget)==null?void 0:B.description)||"",budget_date:at(null,"new_date"),deadline:((I=r.originalBudget)==null?void 0:I.deadline)||20,deadline_type:((V=r.originalBudget)==null?void 0:V.deadline_type)||"dias úteis",deadline_start_description:((T=r.originalBudget)==null?void 0:T.deadline_start_description)||Je,items:((w=r.originalBudget)==null?void 0:w.items.map(a=>({id:null,item_name:a.item_name,item_description:a.item_description,quantity:a.quantity,unit_price:a.unit_price,subtotal:a.subtotal})))||[{id:null,item_name:"",item_description:"",quantity:1,unit_price:0,subtotal:0}],discount_amount:((S=r.originalBudget)==null?void 0:S.discount_amount)||0,additional_amount:((R=r.originalBudget)==null?void 0:R.additional_amount)||0,total_value:((U=r.originalBudget)==null?void 0:U.total_value)||0,contracted_responsibility:((F=r.originalBudget)==null?void 0:F.contracted_responsibility)||Ze,contractor_responsibility:((P=r.originalBudget)==null?void 0:P.contractor_responsibility)||"",payment_method_description:((M=r.originalBudget)==null?void 0:M.payment_method_description)||Xe,bank_info_description:((q=r.originalBudget)==null?void 0:q.bank_info_description)||ze,budget_type:"Original",original_budget_id:null});r.originalBudget&&(e.budget_type="Correção",e.original_budget_id=r.originalBudget.id,e.title=r.originalBudget.title+" (Cópia)");const c=L(null),v=L(!1);Y(()=>e.client_id,async a=>{if(a){v.value=!0,c.value=null;try{const s=await tt.get(route("clients.show",{client:a}),{headers:{Accept:"application/json"}});c.value=s.data.client}catch(s){console.error("Erro ao buscar dados do cliente:",s),h.error("Não foi possível carregar os dados do cliente.",{position:"top-right"})}finally{v.value=!1}}else c.value=null},{immediate:!0});const J=()=>{e.items.push({id:null,item_name:"",item_description:"",quantity:1,unit_price:0,subtotal:0})},X=a=>{e.items.length>1&&e.items.splice(a,1)},z=a=>{a.subtotal=(a.quantity||0)*(a.unit_price||0)},C=$(()=>e.items.reduce((a,s)=>a+(s.subtotal||0),0)),A=$(()=>{const a=parseFloat(C.value),s=parseFloat(e.discount_amount)||0,x=parseFloat(e.additional_amount)||0;return Math.max(0,a-s+x)}),H=()=>{e.total_value=A.value,e.post(route("budgets.store"),{onSuccess:()=>{h.success("Orçamento criado com sucesso!",{position:"top-right"}),G.visit(route("budgets.index"))},onError:a=>{console.error("Erro ao criar orçamento:",a),h.error("Erro ao criar orçamento. Verifique os campos.",{position:"top-right"})}})},K=()=>{confirm("Tem certeza que deseja cancelar? Todas as alterações serão perdidas.")&&G.visit(route("budgets.index"))};return(a,s)=>(d(),n(O,null,[b(o(et),{title:f.page.name},null,8,["title"]),b(it,{page:f.page},{header:k(()=>[t("h2",pt,l(o(e).budget_type==="Correção"?"Correção de Orçamento":"Novo Orçamento"),1)]),default:k(()=>{var x;return[t("div",bt,[t("div",gt,[t("div",xt,[t("form",{onSubmit:ot(H,["prevent"]),class:"p-6"},[t("div",yt,[ft,t("div",null,[ht,m(t("input",{type:"date",id:"budget_date","onUpdate:modelValue":s[0]||(s[0]=i=>o(e).budget_date=i),class:"simple-input mt-1",disabled:""},null,512),[[u,o(e).budget_date]])]),t("div",null,[vt,m(t("input",{type:"number",id:"validity","onUpdate:modelValue":s[1]||(s[1]=i=>o(e).validity=i),min:"0",class:"simple-input mt-1"},null,512),[[u,o(e).validity,void 0,{number:!0}]])])]),t("section",kt,[Ot,t("div",Ct,[t("div",At,[Et,b(ct,{modelValue:o(e).client_id,"onUpdate:modelValue":s[2]||(s[2]=i=>o(e).client_id=i),id:"client-selector",class:"mt-1",required:!0},null,8,["modelValue"]),o(e).errors.client_id?(d(),n("p",Dt,l(o(e).errors.client_id),1)):_("",!0)]),v.value?(d(),n("div",Nt," Carregando dados do cliente... ")):_("",!0),c.value?(d(),n("div",Bt,[t("div",It,[Vt,p(" "+l(c.value.name),1)]),t("div",Tt,[t("span",wt,l(c.value.type==="fisica"?"CPF:":"CNPJ:"),1),p(" "+l(c.value.type==="CPF"?o(lt)(c.value.document):o(nt)(c.value.document)),1)]),t("div",St,[Rt,p(" "+l(c.value.email||"N/A"),1)]),t("div",Ut,[Ft,p(" "+l(o(dt)(c.value.postal_code)||"Não informado"),1)]),t("div",Pt,[Mt,p(" "+l(c.value.address_street+", "+c.value.address_number+", "+c.value.address_neighborhood||"Não informado"),1)]),t("div",qt,[Lt,p(),(x=c.value.contacts)!=null&&x.length?(d(!0),n(O,{key:0},j(c.value.contacts,(i,y)=>(d(),n("span",{key:y,class:"px-1"},l(o(rt)(i)||"Não informado"),1))),128)):(d(),n("span",$t,"Não informado"))]),t("div",jt,[t("a",{href:a.route("clients.edit",c.value.id),target:"_blank",class:"text-blue-600 hover:underline text-xs"}," Editar dados do cliente ",8,Gt)])])):_("",!0)])]),t("section",Zt,[Jt,Xt,m(t("input",{type:"text",id:"title","onUpdate:modelValue":s[3]||(s[3]=i=>o(e).title=i),maxlength:"255",class:"simple-input mt-1",required:""},null,512),[[u,o(e).title]]),o(e).errors.title?(d(),n("p",zt,l(o(e).errors.title),1)):_("",!0)]),t("section",Ht,[Kt,t("div",Qt,[(d(!0),n(O,null,j(o(e).items,(i,y)=>(d(),n("div",{key:y,class:"p-4 border rounded-lg bg-gray-50 relative"},[o(e).items.length>1?(d(),n("button",{key:0,type:"button",onClick:g=>X(y),class:"absolute top-2 right-2 text-red-500 hover:text-red-700 p-1 rounded-full bg-white"},[b(o(ut),{class:"w-5 h-5"})],8,Wt)):_("",!0),t("div",Yt,[t("div",te,[ee,m(t("textarea",{"onUpdate:modelValue":g=>i.item_name=g,rows:"2",class:"simple-input mt-1",required:"",placeholder:"Descrição do item"},null,8,oe),[[u,i.item_name]])]),t("div",se,[ie,m(t("input",{type:"number","onUpdate:modelValue":g=>i.unit_price=g,onInput:g=>z(i),step:"0.01",min:"0",class:"simple-input mt-1",required:""},null,40,ae),[[u,i.unit_price,void 0,{number:!0}]])])])]))),128))]),t("button",{type:"button",onClick:J,class:"mt-4 px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300 flex items-center text-sm"},[b(o(_t),{class:"w-5 h-5 mr-1"}),p(" Adicionar Item ")])]),t("section",le,[ne,t("div",de,[t("div",null,[re,m(t("input",{type:"number",id:"discount_amount","onUpdate:modelValue":s[4]||(s[4]=i=>o(e).discount_amount=i),step:"0.01",min:"0",class:"simple-input mt-1"},null,512),[[u,o(e).discount_amount,void 0,{number:!0}]])]),t("div",null,[ce,m(t("input",{type:"number",id:"additional_amount","onUpdate:modelValue":s[5]||(s[5]=i=>o(e).additional_amount=i),step:"0.01",min:"0",class:"simple-input mt-1"},null,512),[[u,o(e).additional_amount,void 0,{number:!0}]])]),t("div",me,"SUBTOTAL: "+l(o(Z)(C.value)),1),t("div",ue,"TOTAL FINAL: "+l(o(Z)(A.value)),1)])]),t("section",_e,[pe,t("div",be,[t("div",null,[ge,m(t("textarea",{id:"contracted_responsibility","onUpdate:modelValue":s[6]||(s[6]=i=>o(e).contracted_responsibility=i),rows:"4",class:"mt-1 block w-full simple-input",placeholder:"Ex: Fornecer todo material de fabricação e consumo"},null,512),[[u,o(e).contracted_responsibility]]),o(e).errors.contracted_responsibility?(d(),n("p",xe,l(o(e).errors.contracted_responsibility),1)):_("",!0)]),t("div",null,[ye,m(t("textarea",{id:"contractor_responsibility","onUpdate:modelValue":s[7]||(s[7]=i=>o(e).contractor_responsibility=i),rows:"4",class:"mt-1 block w-full simple-input",placeholder:"Ex: Fornecer acesso ao local"},null,512),[[u,o(e).contractor_responsibility]]),o(e).errors.contractor_responsibility?(d(),n("p",fe,l(o(e).errors.contractor_responsibility),1)):_("",!0)])])]),t("section",he,[ve,t("div",ke,[t("div",null,[Oe,t("div",Ce,[Ae,m(t("textarea",{id:"description","onUpdate:modelValue":s[8]||(s[8]=i=>o(e).description=i),rows:"3",class:"mt-1 block w-full simple-input",placeholder:"Detalhes adicionais sobre o orçamento..."},null,512),[[u,o(e).description]]),o(e).errors.description?(d(),n("p",Ee,l(o(e).errors.description),1)):_("",!0)]),t("div",De,[t("div",null,[Ne,m(t("input",{type:"number",id:"deadline","onUpdate:modelValue":s[9]||(s[9]=i=>o(e).deadline=i),min:"0",class:"mt-1 block w-full simple-input"},null,512),[[u,o(e).deadline,void 0,{number:!0}]]),o(e).errors.deadline?(d(),n("p",Be,l(o(e).errors.deadline),1)):_("",!0)]),t("div",null,[Ie,m(t("select",{id:"deadline_type","onUpdate:modelValue":s[10]||(s[10]=i=>o(e).deadline_type=i),class:"mt-1 block w-full simple-input"},we,512),[[st,o(e).deadline_type]]),o(e).errors.deadline_type?(d(),n("p",Se,l(o(e).errors.deadline_type),1)):_("",!0)])]),t("div",Re,[Ue,m(t("input",{type:"text",id:"deadline_start_description","onUpdate:modelValue":s[11]||(s[11]=i=>o(e).deadline_start_description=i),class:"mt-1 block w-full simple-input",placeholder:"Ex: a partir do pagamento de entrada"},null,512),[[u,o(e).deadline_start_description]]),o(e).errors.deadline_start_description?(d(),n("p",Fe,l(o(e).errors.deadline_start_description),1)):_("",!0)])]),t("div",null,[Pe,t("div",Me,[qe,m(t("textarea",{id:"payment_method_description","onUpdate:modelValue":s[12]||(s[12]=i=>o(e).payment_method_description=i),rows:"4",class:"mt-1 block w-full simple-input",placeholder:`Ex: 50% entrada
50% no ato da entrega do serviço`},null,512),[[u,o(e).payment_method_description]]),o(e).errors.payment_method_description?(d(),n("p",Le,l(o(e).errors.payment_method_description),1)):_("",!0)]),t("div",null,[$e,m(t("textarea",{id:"bank_info_description","onUpdate:modelValue":s[13]||(s[13]=i=>o(e).bank_info_description=i),rows:"4",class:"mt-1 block w-full simple-input",placeholder:`Ex: BANCO DO BRASIL
AG: 3175-5 | C/C: 20.439-0
PIX: (73) 9 8855-9571`},null,512),[[u,o(e).bank_info_description]]),o(e).errors.bank_info_description?(d(),n("p",je,l(o(e).errors.bank_info_description),1)):_("",!0)])])])]),t("div",Ge,[t("button",{type:"button",onClick:K,class:"simple-button-neutral"},"Cancelar"),b(mt,{type:"submit",disabled:o(e).processing||!o(e).client_id},{default:k(()=>[p(" Salvar Orçamento ")]),_:1},8,["disabled"])])],32)])])])]}),_:1},8,["page"])],64))}};export{io as default};
