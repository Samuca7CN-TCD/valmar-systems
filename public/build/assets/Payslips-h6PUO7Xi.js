import{d as a,o as n,a as e,m as ae,T as Y,r as C,k as _,y as j,D as ne,b as x,u as o,Z as ie,w as Z,e as h,s as m,v as g,t as d,F as $,g as M,n as k,H as ce}from"./app-CvAlCVsm.js";import{_ as pe}from"./AppLayout-PcgpBm_n.js";import{t as f,i as V}from"./general-D_37hS-e.js";/* empty css                    */import{l as de}from"./lodash-BFq6OCGj.js";import{r as ue,a as ye}from"./ChevronRightIcon-CwOyBZ9V.js";import{r as G}from"./PencilIcon-G-YSz9bE.js";import{r as J}from"./XMarkIcon-B-8YcTZB.js";import{r as K}from"./PlusIcon-Egh1AfEM.js";function Q(p,l){return n(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m4.5 12.75 6 6 9-13.5"})])}const he={class:"font-semibold text-xl text-gray-800 leading-tight"},xe={class:"pt-6 print:hidden print:pt-0"},ve={class:"max-w-7xl mx-auto sm:px-6 lg:px-8 print:w-full"},me={class:"bg-white overflow-hidden shadow-xl sm:rounded-lg p-5"},_e={class:"mb-2"},ge=e("p",{class:"text-neutral-500 text-xs mb-2"},"Opções de Impressão",-1),be={class:"flex gap-2 divide-neutral-400 text-xs text-neutral-700"},fe=["href"],we=["href"],ke=["href"],Ce=["href"],Ee=["href"],$e=e("label",{for:"observations",class:"text-neutral-500 text-xs"},"Observações",-1),Ve={class:"text-xs text-red-500 mt-2"},Se={class:"py-6 print:py-0"},De={class:"md:max-w-7xl mx-auto sm:px-6 lg:px-8 print:max-w-full print:mx-0 print:sm:px-0 print:lg:px-0"},Te={class:"bg-white overflow-hidden shadow-xl sm:rounded-lg print:shadow-none"},Ue={class:"flex flex-col lg:flex-row justify-between items-center w-full bg-neutral-700 text-white px-3 print:hidden"},je={class:"w-[50px]"},Me={class:"uppercase"},Re={class:"flex items-center justify-center"},ze={key:0,class:"rounded-sm text-white"},Fe=["href"],Ie=["href","title"],Ne={key:1,class:"rounded-sm text-white"},He=["href"],Oe=["href"],Pe={class:"w-full p-3 bg-neutral-600 text-white text-center print:hidden"},qe={class:"grid gris-cols-1 lg:grid-cols-2 gap-0.5"},Be={class:"relative overflow-x-auto"},Ae={class:"w-full text-sm text-left rtl:text-right text-gray-500"},Le=e("thead",{class:"text-xs bg-green-500 text-white uppercase"},[e("tr",{class:"w-full bg-green-600"},[e("th",{scope:"col",colspan:"4",class:"px-6 py-3 text-center"}," Entradas ")]),e("tr",null,[e("th",{scope:"col",class:"px-6 py-3 text-center"},"Descrição"),e("th",{scope:"col",class:"px-6 py-3 text-center"},"Valor"),e("th",{scope:"col",class:"px-6 py-3 text-center",colspan:"2"},"Controles")])],-1),Xe={key:0,class:"px-6 py-4 text-center truncate hover:text-wrap max-w-xs"},Ye={key:1,class:"px-6 py-4 text-center truncate hover:text-wrap max-w-xs"},Ze=["disabled"],Ge={key:0,class:"text-red-500 text-xs"},Je={key:2,class:"px-6 py-4 text-center"},Ke={key:3,class:"px-6 py-4 text-center"},Qe={class:"relative"},We=e("div",{class:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3"},[e("span",{class:"text-gray-500 sm:text-sm"},"R$")],-1),et=["disabled"],tt={key:0,class:"text-red-500 text-xs"},st=["title","onClick"],ot={key:5,class:"px-6 py-4 text-center group cursor-pointer select-none space-y-1",title:"Salvar alterações"},rt=["title","onClick"],lt={key:1,class:"bg-white border-b"},at=e("td",{class:"px-6 py-4 text-center",colspan:"3"},"Não há entradas cadastradas ",-1),nt=[at],it={key:2,class:"border-b select-none bg-neutral-200"},ct={class:"px-1 py-1 text-center"},pt=["disabled"],dt={key:0,class:"text-red-500 text-xs"},ut={class:"px-1 py-1 text-center"},yt={class:"relative"},ht=e("div",{class:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3"},[e("span",{class:"text-gray-500 sm:text-sm"},"R$")],-1),xt=["disabled"],vt={key:0,class:"text-red-500 text-xs"},mt={class:"text-center bg-neutral-600 text-white p-3"},_t={class:"relative overflow-x-auto"},gt={class:"w-full text-sm text-left rtl:text-right text-gray-500"},bt=e("thead",{class:"text-xs bg-red-500 text-white uppercase"},[e("tr",{class:"w-full bg-red-600"},[e("th",{scope:"col",colspan:"5",class:"px-6 py-3 text-center"},"Saídas")]),e("tr",null,[e("th",{scope:"col",class:"px-6 py-3 text-center"},"Descrição"),e("th",{scope:"col",class:"px-6 py-3 text-center"},"Valor"),e("th",{scope:"col",class:"px-6 py-3 text-center"},"Listar"),e("th",{colspan:"2",scope:"col",class:"px-6 py-3 text-center"},"Controles")])],-1),ft={key:0,class:"px-6 py-4 text-center truncate hover:text-wrap max-w-xs"},wt={key:1,class:"px-6 py-4 text-center truncate hover:text-wrap max-w-xs"},kt=["disabled"],Ct={key:0,class:"text-red-500 text-xs"},Et={key:2,class:"px-6 py-4 text-center"},$t={key:3,class:"px-6 py-4 text-center"},Vt={class:"relative"},St=e("div",{class:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3"},[e("span",{class:"text-gray-500 sm:text-sm"},"R$")],-1),Dt=["disabled"],Tt={key:0,class:"text-red-500 text-xs"},Ut={class:"px-6 py-4 text-center"},jt=["checked","onChange","disabled"],Mt=["title","onClick"],Rt={key:5,class:"px-6 py-4 text-center group cursor-pointer select-none space-y-1",title:"Salvar alterações"},zt=["title","onClick"],Ft={key:1,class:"bg-white border-b even:bg-neutral-50"},It=e("td",{class:"px-6 py-4 text-center",colspan:"4"},"Não há saídas cadastradas",-1),Nt=[It],Ht={key:2,class:"border-b select-none bg-neutral-200"},Ot={class:"px-1 py-1 text-center"},Pt=["disabled"],qt={key:0,class:"text-red-500 text-xs"},Bt={class:"px-1 py-1 text-center"},At=["disabled"],Lt={key:0,class:"text-red-500 text-xs"},Xt={class:"px-1 py-1 text-center"},Yt={class:"inline-flex items-center cursor-pointer"},Zt=["disabled"],Gt={key:0,class:"text-red-500 text-xs"},Jt=e("div",{class:"relative w-11 h-6 bg-gray-100 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-red-300 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-red-600"},null,-1),Kt={class:"text-center bg-neutral-600 text-white p-3"},ns={__name:"Payslips",props:{page:Object,page_options:Array,payslips_list:{type:Array,default:()=>[]},employee:{type:Object,default:null},payslip_month:Number,payslip_year:Number,observations:String},setup(p){const l=p,w=ae.useToast(),c=Y({id:null,employee_id:l.employee.id,description:"",value:0,detail:!0,month:l.payslip_month,year:l.payslip_year,mode:"in"}),i=Y({id:null,employee_id:l.employee.id,description:"",value:0,detail:!1,month:l.payslip_month,year:l.payslip_year,mode:"out"}),R=new Date,W=R.getMonth()+1,S=R.getFullYear(),z=["janeiro","fevereiro","março","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro"];C([...l.payslips_list]);const y=C(null),b=C(!1),ee=_(()=>Array.from({length:12},(r,t)=>t+1)),F=C(l.observations),D=C(""),I=_(()=>l.payslip_month===1?{month:12,year:l.payslip_year-1}:{month:l.payslip_month-1,year:l.payslip_year}),N=_(()=>l.payslip_month===12?{month:1,year:l.payslip_year+1}:{month:l.payslip_month+1,year:l.payslip_year}),T=_(()=>l.payslips_list.filter(r=>r.value>0)),H=_(()=>T.value.reduce((r,t)=>r+t.value,0)),U=_(()=>l.payslips_list.filter(r=>r.value<0)),O=_(()=>U.value.reduce((r,t)=>r+t.value,0)),te=_(()=>H.value+O.value),v=_(()=>c.processing||i.processing||b.value),P=r=>(r.clearErrors(),r.description?!r.value||r.value<=0?(r.setError("value","Insira um valor válido"),!1):!0:(r.setError("description","Insira uma descrição"),!1)),q=(r,t)=>{P(r)&&r.transform(s=>({...s,value:t?s.value:-s.value})).post(route("payslip.store"),{preserveScroll:!0,onSuccess:()=>{r.reset(),w.success("Registro cadastrado com sucesso!")},onError:s=>{console.log("Error:",s),w.error("Erro ao cadastrar registro! Comunique o técnico!")}})},se=()=>q(c,!0),oe=()=>q(i,!1),B=r=>{if(y.value!==null)return;const t=l.payslips_list.find(s=>s.id===r);t.value>0?(c.id=t.id,c.employee_id=t.employee_id,c.description=t.description,c.value=t.value,c.detail=t.detail,c.month=t.month,c.year=t.year):(i.id=t.id,i.employee_id=t.employee_id,i.description=t.description,i.value=V(t.value),i.detail=t.detail,i.month=t.month,i.year=t.year),y.value=r},E=()=>{y.value=null,c.reset(),i.reset()},A=r=>{P(r)&&confirm(`Tem certeza que deseja alterar o registro para "${r.description}: ${f(V(r.value))}"?`)&&(b.value=!0,r.transform(t=>({...t,value:r.mode==="in"?t.value:-t.value})).put(route("payslip.update",r.id),{onSuccess:()=>{E(),w.success("Registro atualizado com sucesso!")},onError:t=>{console.log("Error:",t)},onFinish:()=>{b.value=!1}}))},re=(r,t)=>{b.value=!0,j.put(route("payslip.update_detail",r),{},{preserveScroll:!0,onError:s=>{console.log("Error:",s),w.error("Erro ao desabilitar o registro! Tente novamente.")},onFinish:()=>{b.value=!1}})},L=r=>{const t=l.payslips_list.find(s=>s.id===r);confirm(`Você tem certeza que deseja EXCLUIR o registro "${t.description}: ${f(t.value)}"?`)&&(b.value=!0,j.delete(route("payslip.destroy",r),{preserveScroll:!0,onSuccess:()=>{w.success("Registro deletado com sucesso")},onError:s=>{console.log("Error:",s),w.error("Erro ao deletar registro! Tente novamente.")},onFinish:()=>{b.value=!1,E()}}))},le=de.debounce(r=>{const t=r.target.value;j.put(route("payslip.observations",{employee:l.employee.id,month:l.payslip_month,year:l.payslip_year}),{payslip_observations:t},{preserveScroll:!0,onSuccess:()=>{const s=r.target;s.style.height="auto",s.style.height=`${s.scrollHeight}px`,D.value=""},onError:s=>{console.log(s),D.value=s}})},500),X=(r=null)=>{if(!r){const t=document.querySelector("#observations");t.style.height="auto",t.style.height=`${t.scrollHeight}px`;return}le(r)};return ne(()=>{X()}),(r,t)=>(n(),a($,null,[x(o(ie),{title:p.page.name},null,8,["title"]),x(pe,{page:p.page,page_options:p.page_options,payslip_month:p.payslip_month,payslip_year:p.payslip_year},{header:Z(()=>[e("h2",he," Holerite | "+d(l.employee.name)+" "+d(l.employee.surname),1)]),default:Z(()=>[e("div",xe,[e("div",ve,[e("div",me,[e("div",_e,[ge,e("div",be,[p.employee?(n(),a("a",{key:0,href:r.route("payslip.print",{mode:"payslip",employee:l.employee.id,month:l.payslip_month,year:l.payslip_year}),class:"bg-green-500 hover:bg-green-700 active:bg-green-900 text-white rounded-md px-2"}," Holerite individual",8,fe)):h("",!0),e("a",{href:r.route("payslip.print",{mode:"payslip",employee:0,month:l.payslip_month,year:l.payslip_year}),class:"bg-green-500 hover:bg-green-700 active:bg-green-900 text-white rounded-md px-2"},"Todos os holerites",8,we),p.employee&&p.employee.transportation_voucher?(n(),a("a",{key:1,href:r.route("payslip.print",{mode:"transportation-voucher",employee:l.employee.id,month:l.payslip_month,year:l.payslip_year}),class:"bg-green-500 hover:bg-green-700 active:bg-green-900 text-white rounded-md px-2"},"Vale transporte Individual",8,ke)):h("",!0),p.employee.transportation_voucher?(n(),a("a",{key:2,href:r.route("payslip.print",{mode:"transportation-voucher",employee:0,month:l.payslip_month,year:l.payslip_year}),class:"bg-green-500 hover:bg-green-700 active:bg-green-900 text-white rounded-md px-2"},"Todos os vales transporte",8,Ce)):h("",!0),e("a",{href:r.route("payslip.print",{mode:"control",employee:0,month:l.payslip_month,year:l.payslip_year}),class:"bg-green-500 hover:bg-green-700 active:bg-green-900 text-white rounded-md px-2"},"Controle",8,Ee)])]),e("div",null,[$e,m(e("textarea",{id:"observations","onUpdate:modelValue":t[0]||(t[0]=s=>F.value=s),onInput:X,class:"simple-input resize-none overflow-hidden min-h-[50px] p-2 border rounded-md",placeholder:"Observações do Holerite..."},null,544),[[g,F.value]]),e("p",Ve,d(D.value.payslip_observations),1)])])])]),e("div",Se,[e("div",De,[e("div",Te,[e("div",Ue,[e("div",je,[e("span",Me,d(z[p.payslip_month-1])+"/"+d(p.payslip_year),1)]),e("ul",Re,[p.payslip_year>1||p.payslip_month>1?(n(),a("li",ze,[e("a",{href:r.route("payslip.filter",{employee:p.employee.id,month:I.value.month,year:I.value.year}),class:"group py-1 px-3"},[x(o(ue),{class:"w-4 group-hover:scale-150"})],8,Fe)])):h("",!0),(n(!0),a($,null,M(ee.value,s=>(n(),a("li",{key:s,class:"rounded-sm text-white"},[e("a",{href:r.route("payslip.filter",{employee:p.employee.id,month:s,year:p.payslip_year}),class:k(["hover:bg-neutral-600 active:bg-neutral-800 py-3 px-3",{"h-full bg-neutral-900":p.payslip_month===s}]),title:z[s-1]},d(s),11,Ie)]))),128)),p.payslip_year<o(S)||p.payslip_year===o(S)&&p.payslip_month<12?(n(),a("li",Ne,[e("a",{href:r.route("payslip.filter",{employee:p.employee.id,month:N.value.month,year:N.value.year}),class:"group py-1 px-3"},[x(o(ye),{class:"w-4 group-hover:scale-150"})],8,He)])):h("",!0)]),e("a",{href:r.route("payslip.filter",{employee:p.employee.id,month:W,year:o(S)}),class:"text-yellow-500 hover:text-yellow-600 active:text-yellow-700"},"Resetar data",8,Oe)]),e("div",Pe,"Total: "+d(o(f)(te.value)),1),e("div",qe,[e("div",Be,[e("table",Ae,[Le,e("tbody",null,[T.value.length?(n(!0),a($,{key:0},M(T.value,s=>(n(),a("tr",{key:s.id,class:"bg-white border-b even:bg-neutral-50"},[y.value!==s.id?(n(),a("td",Xe,d(s.description),1)):(n(),a("td",Ye,[m(e("input",{type:"text",placeholder:"Descrição","onUpdate:modelValue":t[1]||(t[1]=u=>o(c).description=u),class:"simple-input",disabled:v.value},null,8,Ze),[[g,o(c).description]]),o(c).errors.description?(n(),a("p",Ge,d(o(c).errors.description),1)):h("",!0)])),y.value!==s.id?(n(),a("td",Je,d(o(f)(s.value)),1)):(n(),a("td",Ke,[e("div",Qe,[We,m(e("input",{type:"number",min:"0.01",step:"0.01",placeholder:"Valor","onUpdate:modelValue":t[2]||(t[2]=u=>o(c).value=u),class:"simple-input pl-9",disabled:v.value},null,8,et),[[g,o(c).value]]),o(c).errors.value?(n(),a("p",tt,d(o(c).errors.value),1)):h("",!0)])])),y.value!==s.id?(n(),a("td",{key:4,class:k(["px-6 py-4 text-center group cursor-pointer select-none",{"opacity-50":y.value!==null}]),title:"Editar "+s.description,onClick:u=>B(s.id)},[x(o(G),{class:k(["w-5 h-5 mx-auto",{"group-hover:scale-125 group-active:scale-90":y.value===null}])},null,8,["class"])],10,st)):(n(),a("td",ot,[x(o(Q),{class:"w-5 h-5 mx-auto hover:scale-125 active:scale-90",onClick:t[3]||(t[3]=u=>A(o(c)))}),e("p",{class:"text-xs text-red-500 hover:scale-125 active:scale-90",onClick:t[4]||(t[4]=u=>E())},"Cancelar")])),e("td",{class:"px-6 py-4 text-center group cursor-pointer select-none",title:"Deletar "+s.description,onClick:u=>L(s.id)},[x(o(J),{class:"w-5 h-5 mx-auto group-hover:scale-125 group-active:scale-90"})],8,rt)]))),128)):(n(),a("tr",lt,nt)),y.value===null?(n(),a("tr",it,[e("td",ct,[m(e("input",{type:"text",placeholder:"Descrição","onUpdate:modelValue":t[5]||(t[5]=s=>o(c).description=s),class:"simple-input",disabled:v.value},null,8,pt),[[g,o(c).description]]),o(c).errors.description?(n(),a("p",dt,d(o(c).errors.description),1)):h("",!0)]),e("td",ut,[e("div",yt,[ht,m(e("input",{type:"number",min:"0.01",step:"0.01",placeholder:"Valor","onUpdate:modelValue":t[6]||(t[6]=s=>o(c).value=s),class:"simple-input pl-9",disabled:v.value},null,8,xt),[[g,o(c).value]]),o(c).errors.value?(n(),a("p",vt,d(o(c).errors.value),1)):h("",!0)])]),e("td",{colspan:"2",class:"px-3 py-2 text-center group cursor-pointer",onClick:se},[x(o(K),{class:"w-5 h-5 mx-auto group-hover:scale-125 group-active:scale-90"})])])):h("",!0)])]),e("div",mt,"Total Entradas: "+d(o(f)(H.value)),1)]),e("div",_t,[e("table",gt,[bt,e("tbody",null,[U.value.length?(n(!0),a($,{key:0},M(U.value,s=>(n(),a("tr",{key:s.id,class:k(["bg-white border-b even:bg-neutral-50",{"opacity-80 print:hidden":!s.detail}])},[y.value!==s.id?(n(),a("td",ft,d(s.description),1)):(n(),a("td",wt,[m(e("input",{type:"text",placeholder:"Descrição","onUpdate:modelValue":t[7]||(t[7]=u=>o(i).description=u),class:"simple-input",disabled:v.value},null,8,kt),[[g,o(i).description]]),o(i).errors.description?(n(),a("p",Ct,d(o(i).errors.description),1)):h("",!0)])),y.value!==s.id?(n(),a("td",Et,d(o(f)(o(V)(s.value))),1)):(n(),a("td",$t,[e("div",Vt,[St,m(e("input",{type:"number",min:"0.01",step:"0.01",placeholder:"Valor","onUpdate:modelValue":t[8]||(t[8]=u=>o(i).value=u),class:"simple-input pl-9",disabled:v.value},null,8,Dt),[[g,o(i).value]]),o(i).errors.value?(n(),a("p",Tt,d(o(i).errors.value),1)):h("",!0)])])),e("td",Ut,[e("input",{type:"checkbox",checked:s.detail,onChange:u=>re(s.id,u.target.checked),disabled:y.value!==null||v.value,class:"focus:ring-red-500 text-red-500 border-neutral-500 rounded-sm disabled:opacity-10"},null,40,jt)]),y.value!==s.id?(n(),a("td",{key:4,class:k(["px-6 py-4 text-center group cursor-pointer select-none",{"opacity-50":y.value!==null}]),title:"Editar "+s.description,onClick:u=>B(s.id)},[x(o(G),{class:k(["w-5 h-5 mx-auto",{"group-hover:scale-125 group-active:scale-90":y.value===null}])},null,8,["class"])],10,Mt)):(n(),a("td",Rt,[x(o(Q),{class:"w-5 h-5 mx-auto hover:scale-125 active:scale-90",onClick:t[9]||(t[9]=u=>A(o(i)))}),e("p",{class:"text-xs text-red-500 hover:scale-125 active:scale-90",onClick:t[10]||(t[10]=u=>E())},"Cancelar")])),e("td",{class:"px-6 py-4 text-center group cursor-pointer select-none",title:"Deletar "+s.description,onClick:u=>L(s.id)},[x(o(J),{class:"w-5 h-5 mx-auto group-hover:scale-125 group-active:scale-90"})],8,zt)],2))),128)):(n(),a("tr",Ft,Nt)),y.value===null?(n(),a("tr",Ht,[e("td",Ot,[m(e("input",{type:"text",placeholder:"Descrição","onUpdate:modelValue":t[11]||(t[11]=s=>o(i).description=s),class:"simple-input focus:ring-red-500",disabled:v.value},null,8,Pt),[[g,o(i).description]]),o(i).errors.description?(n(),a("p",qt,d(o(i).errors.description),1)):h("",!0)]),e("td",Bt,[m(e("input",{type:"number",min:"0.01",step:"0.01",placeholder:"Valor","onUpdate:modelValue":t[12]||(t[12]=s=>o(i).value=s),class:"simple-input focus:ring-red-500",disabled:v.value},null,8,At),[[g,o(i).value]]),o(i).errors.value?(n(),a("p",Lt,d(o(i).errors.value),1)):h("",!0)]),e("td",Xt,[e("label",Yt,[m(e("input",{type:"checkbox","onUpdate:modelValue":t[13]||(t[13]=s=>o(i).detail=s),class:"sr-only peer",disabled:v.value},null,8,Zt),[[ce,o(i).detail]]),o(i).errors.detail?(n(),a("p",Gt,d(o(i).errors.detail),1)):h("",!0),Jt])]),e("td",{colspan:"2",class:"px-1 py-1 text-center group cursor-pointer",onClick:oe},[x(o(K),{class:"w-5 h-5 mx-auto group-hover:scale-125 group-active:scale-90"})])])):h("",!0)])]),e("div",Kt,"Total Saídas: "+d(o(f)(o(V)(O.value))),1)])])])])])]),_:1},8,["page","page_options","payslip_month","payslip_year"])],64))}};export{ns as default};
