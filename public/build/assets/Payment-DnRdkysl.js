import{y as q,T as k,d as C,l as P,o as i,e as c,b as n,u as r,Z as I,w as S,a as e,t as l,q as R,v as U,F as $,g as z,f as F,h as G}from"./app-CQCMULRS.js";import{r as X,_ as Z}from"./AppLayout-DVsrCAOA.js";import{_ as H}from"./CreateUpdatePayModal-C6iAup6N.js";import{_ as J}from"./FloatButton-C3J_W6e4.js";import{_ as K}from"./ExtraOptionsButton-BsREayZP.js";import{t as m}from"./general-CW50Zh8a.js";/* empty css                    */import{r as Q}from"./MagnifyingGlassIcon-4YeFiuBy.js";import{r as W,a as Y}from"./XMarkIcon-DDhLJnv-.js";import"./CreateUpdateModal-CL67BBV8.js";import"./Modal-15mIg7tU.js";import"./PrimaryButton-CCpSxDR1.js";import"./SecondaryButton-CJwptiz7.js";import"./PlusIcon-C8vVEu5u.js";import"./PrinterIcon-CfTT1zCI.js";const ee={class:"font-semibold text-xl text-gray-800 leading-tight"},te={class:"pt-12 print:hidden"},se={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},oe={class:"bg-white overflow-hidden shadow-xl sm:rounded-lg p-5"},ae={class:"flex flex-row items-center space-x-3"},ne={class:"py-12 print:py-6"},re={class:"max-w-7xl mx-auto print:max-w-full"},ie={class:"px-0 print:px-0"},ce={class:"bg-white overflow-hidden shadow-xl sm:rounded-lg print:shadow-none"},le={class:"flex flex-col"},de={class:"overflow-x-auto sm:-mx-6 lg:-mx-8"},pe={class:"inline-block min-w-full py-2 sm:px-6 lg:px-8"},ue={class:"overflow-hidden"},me={class:"w-full text-left text-sm font-light"},_e=e("thead",{class:"border-b font-medium"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-4 text-center"},"#"),e("th",{scope:"col",class:"px-6 py-4 text-center"},"Dívida"),e("th",{scope:"col",class:"px-6 py-4 text-center"},"Devedor"),e("th",{scope:"col",class:"px-6 py-4 text-center"},"À pagar"),e("th",{scope:"col",class:"px-6 py-4 text-center"},"Valor total"),e("th",{scope:"col",class:"px-6 py-4 text-center print:hidden"},"Pagar "),e("th",{scope:"col",class:"px-6 py-4 text-center print:hidden"},"Editar "),e("th",{scope:"col",class:"px-6 py-4 text-center print:hidden"},"Excluir ")])],-1),he={class:"border-b transition duration-300 ease-in-out hover:bg-neutral-100 print:break-inside-avoid"},xe={class:"whitespace-nowrap py-4 text-center font-medium"},ve={class:"break-words px-6 py-4 text-center"},ye=["title"],ge={class:"whitespace-normal px-6 py-4 text-center"},we={class:"whitespace-nowrap px-2 py-4 text-center"},fe={class:"whitespace-nowrap px-2 py-4 text-center"},be=["title","onClick"],ke=["title","onClick"],Ce=["title","onClick"],Pe={key:1,class:"whitespace-nowrap px-4 py-4 text-center select-none print:hidden"},Se={key:1,class:"transition duration-300 ease-in-out hover:bg-neutral-100 print:break-inside-avoid"},$e=e("td",{class:"whitespace-nowrap px-6 py-4 text-center",colspan:"9"},"Não há pagamentos cadastrados no momento!",-1),Ee=[$e],Fe={__name:"Payment",props:{page:Object,page_options:{type:Array,default:null},payments_list:Object},setup(p){const h=p,g=q.useToast(),s=k({id:null,debt:"",debtor:"",total_value:0,partial_value:0,observations:"",records_list:{enable_records:!1,data:[]}}),x=C(""),w=P(()=>{const a=x.value.toLowerCase();return h.payments_list.filter(o=>o.motive.toLowerCase().includes(a)||o.entity_name.toLowerCase().includes(a)||m(o.accounting.total_value).toString().toLowerCase().includes(a)||m(o.accounting.partial_value).toString().toLowerCase().includes(a))}),E=P(()=>h.payments_list.reduce((a,o)=>a+o.accounting.partial_value,0)),d=C({mode:"create",show:!1,get title(){switch(this.mode){case"create":return"Criar pagamento";case"update":return"Editar pagamento";case"pay":return"Pagar pagamento"}},get primary_button_txt(){switch(this.mode){case"create":return"Cadastrar";case"update":return"Atualizar";case"pay":return"Pagar"}}}),v=(a,o=null)=>{const t=["update","pay"].includes(a);if(o!==null&&t){const u=h.payments_list.find(y=>y.id===o);if(u){const{id:y,type:B,motive:D,entity_name:N,observations:O,records:f,accounting:b}=u;s.id=y,s.type=B,s.debt=D,s.debtor=N,s.total_value=b.total_value,s.partial_value=b.partial_value,s.observations=O,s.records_list.enable_records=!!f.length,s.records_list.data=f.map(j=>k(j))}}d.value.mode=a,d.value.show=!0},_=()=>{s.reset(),d.value.show=!1},L=()=>{s.post(route("payments.store"),{preserveScroll:!0,onSuccess:()=>_(),onError:a=>{console.log(a)}})},V=()=>{s.put(route("payments.update",s.id),{preserveScroll:!0,onSuccess:()=>_()})},T=()=>{s.put(route("payments.pay",s.id),{preserveScroll:!0,onSuccess:()=>_()})},M=(a,o)=>{confirm(`Você tem certeza que deseja excluir o pagamento "${o}"? Esta ação não poderá ser desfeita!`)&&s.delete(route("payments.destroy",a),{preserveScroll:!0,onSuccess:()=>g.success("Pagamento deletado com sucesso!")})},A=()=>{switch(d.value.mode){case"create":return L();case"update":return V();case"pay":return T();default:g.error("Método desconhecido. Informar o Técnico.")}};return(a,o)=>(i(),c($,null,[n(r(I),{title:p.page.name},null,8,["title"]),n(Z,{page:p.page,page_options:p.page_options},{header:S(()=>[e("h2",ee,l(p.page.name)+" | "+l(r(m)(E.value)),1),n(J,{icon:"plus",onClick:o[0]||(o[0]=t=>v("create")),title:"Cadastrar Payment",class:"print:hidden"})]),default:S(()=>[e("div",te,[e("div",se,[e("div",oe,[e("div",ae,[n(r(Q),{class:"w-5 y-5"}),R(e("input",{type:"text",name:"search_term",id:"search_term",autocomplete:"on",class:"simple-input",autofocus:"true",placeholder:"Pesquisar termo...","onUpdate:modelValue":o[1]||(o[1]=t=>x.value=t)},null,512),[[U,x.value]])])])])]),e("div",ne,[e("div",re,[e("div",ie,[e("div",ce,[e("div",le,[e("div",de,[e("div",pe,[e("div",ue,[e("table",me,[_e,e("tbody",null,[w.value.length?(i(!0),c($,{key:0},z(w.value,t=>(i(),c("tr",he,[e("td",xe,l(t.id),1),e("td",ve,[F(l(t.motive)+" ",1),t.observations?(i(),c("span",{key:0,title:t.observations,class:"inline-flex items-center rounded-md bg-gray-50 px-2 py-1 text-xs font-medium text-gray-600 ring-1 ring-inset ring-gray-500/10 cursor-help"},"OBS",8,ye)):G("",!0)]),e("td",ge,l(t.entity_name),1),e("td",we,l(r(m)(t.accounting.partial_value)),1),e("td",fe,l(r(m)(t.accounting.total_value)),1),e("td",{class:"whitespace-nowrap px-4 py-4 text-center cursor-pointer hover:text-green-700 active:text-green-900 select-none print:hidden",title:"PAGAR: "+t.motive+"("+t.entity_name+")",onClick:u=>v("pay",t.id)},[n(r(X),{class:"w-5 h-5 m-auto"})],8,be),e("td",{class:"whitespace-nowrap px-4 py-4 text-center cursor-pointer hover:text-yellow-700 active:text-yellow-900 select-none print:hidden",title:"EDITAR: "+t.motive+"("+t.entity_name+")",onClick:u=>v("update",t.id)},[n(r(W),{class:"w-5 h-5 m-auto"})],8,ke),t.type!==2?(i(),c("td",{key:0,class:"whitespace-nowrap px-4 py-4 text-center cursor-pointer hover:text-red-700 active:text-red-900 select-none print:hidden",title:"EXCLUIR: "+t.motive+"("+t.entity_name+")",onClick:u=>M(t.id,t.name)},[n(r(Y),{class:"w-5 h-5 m-auto"})],8,Ce)):(i(),c("td",Pe," Venda "))]))),256)):(i(),c("tr",Se,Ee))])])])])])])])])])]),n(H,{show:d.value.show,modal:d.value,payment:r(s),onSubmit:A,onClose:_},null,8,["show","modal","payment"]),n(K,{mode:["rollup","print_page","link"],link_type:["previous"],link:[a.route("payments.previous")]},null,8,["link"])]),_:1},8,["page","page_options"])],64))}};export{Fe as default};
