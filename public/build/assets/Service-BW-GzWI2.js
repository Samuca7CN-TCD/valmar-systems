import{o as c,e as l,a as e,y as U,T as C,d as k,l as S,b as r,u as n,Z as q,w as $,t as i,q as F,v as G,F as A,g as Z,n as X,f as H,h as J}from"./app-CQCMULRS.js";import{r as K,_ as Q}from"./AppLayout-DVsrCAOA.js";import{_ as W}from"./CreateUpdatePayModal-O952ftvN.js";import{_ as Y}from"./FloatButton-C3J_W6e4.js";import{_ as ee}from"./ExtraOptionsButton-BsREayZP.js";import{g as L,t as m,h as D}from"./general-CW50Zh8a.js";/* empty css                    */import{r as te}from"./MagnifyingGlassIcon-4YeFiuBy.js";import{r as se,a as oe}from"./XMarkIcon-DDhLJnv-.js";import"./CreateUpdateModal-CL67BBV8.js";import"./Modal-15mIg7tU.js";import"./PrimaryButton-CCpSxDR1.js";import"./SecondaryButton-CJwptiz7.js";import"./PlusIcon-C8vVEu5u.js";import"./EyeIcon-CE4FUwbj.js";import"./PrinterIcon-CfTT1zCI.js";function ae(d,_){return c(),l("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 12.75 11.25 15 15 9.75M21 12c0 1.268-.63 2.39-1.593 3.068a3.745 3.745 0 0 1-1.043 3.296 3.745 3.745 0 0 1-3.296 1.043A3.745 3.745 0 0 1 12 21c-1.268 0-2.39-.63-3.068-1.593a3.746 3.746 0 0 1-3.296-1.043 3.745 3.745 0 0 1-1.043-3.296A3.745 3.745 0 0 1 3 12c0-1.268.63-2.39 1.593-3.068a3.745 3.745 0 0 1 1.043-3.296 3.746 3.746 0 0 1 3.296-1.043A3.746 3.746 0 0 1 12 3c1.268 0 2.39.63 3.068 1.593a3.746 3.746 0 0 1 3.296 1.043 3.746 3.746 0 0 1 1.043 3.296A3.745 3.745 0 0 1 21 12Z"})])}const ne={class:"font-semibold text-xl text-gray-800 leading-tight"},re={class:"pt-12 print:hidden print:pt-0"},ie={class:"max-w-7xl mx-auto sm:px-6 lg:px-8 print:w-full"},ce={class:"bg-white overflow-hidden shadow-xl sm:rounded-lg p-5"},le={class:"flex flex-row items-center space-x-3"},de={class:"py-12 print:py-6"},pe={class:"max-w-7xl mx-auto print:max-w-full"},ue={class:"px-0 print:px-0"},me={class:"bg-white overflow-hidden shadow-xl sm:rounded-lg print:shadow-none"},_e={class:"flex flex-col"},he={class:"overflow-x-auto sm:-mx-6 lg:-mx-8"},xe={class:"inline-block min-w-full py-2 sm:px-6 lg:px-8"},ve={class:"overflow-hidden"},we={class:"min-w-full text-left text-sm font-light"},fe=e("thead",{class:"border-b font-medium"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-4 text-center"},"#"),e("th",{scope:"col",class:"px-6 py-4 text-center"},"Prazo"),e("th",{scope:"col",class:"px-6 py-4 text-center"},"Título"),e("th",{scope:"col",class:"px-6 py-4 text-center"},"Cliente"),e("th",{scope:"col",class:"px-6 py-4 text-center"},"À pagar"),e("th",{scope:"col",class:"px-6 py-4 text-center"},"Valor total"),e("th",{scope:"col",class:"px-6 py-4 text-center print:hidden"},"Entrega "),e("th",{scope:"col",class:"px-6 py-4 text-center print:hidden",colspan:"4"},"Ações ")])],-1),ge={class:"border-b transition duration-300 ease-in-out hover:bg-neutral-100 print:break-inside-avoid"},ye={class:"whitespace-nowrap py-4 text-center font-medium"},be={class:"whitespace-normal px-6 py-4 text-center trim"},Ce=["title"],ke={class:"whitespace-normal px-6 py-4 text-center"},Se={class:"whitespace-nowrap px-2 py-4 text-center"},$e={class:"whitespace-nowrap px-2 py-4 text-center"},Ae={class:"whitespace-nowrap px-2 py-4 text-center print:hidden"},Le=["title","onClick"],De=["title","onClick"],Ee={key:0},Me={key:1,class:"m-auto text-center"},Oe=["title","onClick"],Te=["title","onClick"],Ve={key:1,class:"transition duration-300 ease-in-out hover:bg-neutral-100 print:break-inside-avoid"},Pe=e("td",{class:"whitespace-nowrap px-6 py-4 text-center",colspan:"9"},"Não há serviços cadastrados no momento!",-1),Be=[Pe],Ye={__name:"Service",props:{page:Object,page_options:{type:Array,default:null},services_list:Object},setup(d){const _=d,f=U.useToast(),a=C({id:null,title:"",client:"",total_value:0,partial_value:0,observations:"",deadline:L(new Date(Date.now()+15*24*60*60*1e3),"new_date"),records_list:{enable_records:!1,data:[]}}),x=k(""),g=S(()=>{const o=x.value.toLowerCase();return _.services_list.filter(s=>s.motive.toLowerCase().includes(o)||s.entity_name.toLowerCase().includes(o)||s.observations.toLowerCase().includes(o)||m(s.accounting.total_value).toString().toLowerCase().includes(o)||m(s.accounting.partial_value).toString().toLowerCase().includes(o)||s.deadline.includes(o))}),E=S(()=>_.services_list.reduce((o,s)=>o+s.accounting.partial_value,0)),M=o=>{const s=D(o);return s===0?"text-red-500":s>0&&s<8?"text-orange-500":s>7&&s<15?"text-yellow-500":s>14&&s<30?"text-green-500":"text-blue-500"},p=k({mode:"create",show:!1,get title(){switch(this.mode){case"create":return"Criar serviço";case"update":return"Editar serviço";case"pay":return"Pagar serviço";case"see":return"Ver informações do serviço"}},get primary_button_txt(){switch(this.mode){case"create":return"Cadastrar";case"update":return"Atualizar";case"pay":return"Pagar";case"see":return"Fechar"}}}),v=(o,s=null)=>{const t=["update","pay"].includes(o);if(s!==null&&t){const u=_.services_list.find(w=>w.id===s);if(u){const{id:w,motive:j,entity_name:z,observations:I,records:y,accounting:b}=u;a.id=w,a.title=j,a.client=z,a.total_value=b.total_value,a.partial_value=b.partial_value,a.observations=I,a.records_list.enable_records=!!y.length,a.records_list.data=y.map(R=>C(R))}}p.value.mode=o,p.value.show=!0},h=()=>{a.reset(),p.value.show=!1},O=()=>{a.post(route("services.store"),{preserveScroll:!0,onSuccess:()=>h(),onError:o=>{console.log(o)}})},T=()=>{a.put(route("services.update",a.id),{preserveScroll:!0,onSuccess:()=>h()})},V=()=>{a.put(route("services.pay",a.id),{preserveScroll:!0,onSuccess:()=>h()})},P=(o,s)=>{if(s!==0){if(!confirm("O serviço será considerado como concluído e será listado apenas na página de pagamentos"))return}else if(!confirm("O serviço será considerado concluído e pago!"))return;a.put(route("services.conclude",o),{preserveScroll:!0})},B=(o,s)=>{confirm(`Você tem certeza que deseja excluir o serviço "${s}"? Esta ação não poderá ser desfeita!`)&&a.delete(route("services.destroy",o),{preserveScroll:!0,onSuccess:()=>f.success("Serviço deletado com sucesso!")})},N=()=>{switch(p.value.mode){case"create":return O();case"update":return T();case"pay":return V();default:f.error("Método desconhecido. Informar o Técnico.")}};return(o,s)=>(c(),l(A,null,[r(n(q),{title:d.page.name},null,8,["title"]),r(Q,{page:d.page,page_options:d.page_options},{header:$(()=>[e("h2",ne,i(d.page.name)+" | "+i(n(m)(E.value)),1),r(Y,{icon:"plus",onClick:s[0]||(s[0]=t=>v("create")),title:"Cadastrar Service",class:"print:hidden"})]),default:$(()=>[e("div",re,[e("div",ie,[e("div",ce,[e("div",le,[r(n(te),{class:"w-5 y-5"}),F(e("input",{type:"text",name:"search_term",id:"search_term",autocomplete:"on",class:"simple-input",autofocus:"true",placeholder:"Pesquisar termo...","onUpdate:modelValue":s[1]||(s[1]=t=>x.value=t)},null,512),[[G,x.value]])])])])]),e("div",de,[e("div",pe,[e("div",ue,[e("div",me,[e("div",_e,[e("div",he,[e("div",xe,[e("div",ve,[e("table",we,[fe,e("tbody",null,[g.value.length?(c(!0),l(A,{key:0},Z(g.value,t=>(c(),l("tr",ge,[e("td",ye,i(t.id),1),e("td",{class:X(["whitespace-nowrap py-4 text-center font-medium",M(t.deadline)])},i(n(D)(t.deadline))+" dias ",3),e("td",be,[H(i(t.motive)+" ",1),t.observations?(c(),l("span",{key:0,title:t.observations,class:"inline-flex items-center rounded-md bg-gray-50 px-2 py-1 text-xs font-medium text-gray-600 ring-1 ring-inset ring-gray-500/10 cursor-help"},"OBS",8,Ce)):J("",!0)]),e("td",ke,i(t.entity_name),1),e("td",Se,i(n(m)(t.accounting.partial_value)),1),e("td",$e,i(n(m)(t.accounting.total_value)),1),e("td",Ae,i(n(L)(t.deadline,!0)),1),e("td",{class:"whitespace-nowrap px-4 py-4 pl-10 text-center cursor-pointer hover:text-blue-700 active:text-blue-900 select-none print:hidden",title:"CONCLUIR: "+t.motive+"("+t.entity_name+")",onClick:u=>P(t.id,t.accounting.partial_value)},[r(n(ae),{class:"w-4 h-4 m-auto"})],8,Le),e("td",{class:"whitespace-nowrap px-4 py-4 text-center cursor-pointer hover:text-green-700 active:text-green-900 select-none print:hidden",title:"PAGAR: "+t.motive+"("+t.entity_name+")",onClick:u=>v("pay",t.id)},[t.accounting.partial_value!==0?(c(),l("span",Ee,[r(n(K),{class:"w-4 h-4 m-auto"})])):(c(),l("span",Me,"PAGO"))],8,De),e("td",{class:"whitespace-nowrap px-4 py-4 text-center cursor-pointer hover:text-yellow-700 active:text-yellow-900 select-none print:hidden",title:"EDITAR: "+t.motive+"("+t.entity_name+")",onClick:u=>v("update",t.id)},[r(n(se),{class:"w-4 h-4 m-auto"})],8,Oe),e("td",{class:"whitespace-nowrap px-4 py-4 text-center cursor-pointer hover:text-red-700 active:text-red-900 select-none print:hidden",title:"EXCLUIR: "+t.motive+"("+t.entity_name+")",onClick:u=>B(t.id,t.name)},[r(n(oe),{class:"w-4 h-4 m-auto"})],8,Te)]))),256)):(c(),l("tr",Ve,Be))])])])])])])])])])]),r(W,{show:p.value.show,modal:p.value,service:n(a),onSubmit:N,onClose:h},null,8,["show","modal","service"]),r(ee,{mode:["rollup","print_page","link"],link_type:["previous"],link:[o.route("services.previous")]},null,8,["link"])]),_:1},8,["page","page_options"])],64))}};export{Ye as default};
