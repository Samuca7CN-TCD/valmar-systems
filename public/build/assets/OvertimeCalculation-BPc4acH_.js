import{o as s,e as r,a as e,d as _,p as ce,q as ee,c as te,w as E,b as f,u,f as S,s as k,v as P,h as T,F as z,g as ae,t as p,B as de,A as ue,l as Y,C as pe,Z as _e,z as q,n as V,D as he}from"./app-CgFoNUGz.js";import{_ as ve}from"./AppLayout-Rf2y2ufC.js";import{_ as fe}from"./CreateUpdateModal-DESotbpE.js";import{_ as xe}from"./SecondaryButton-Dh0wH0Tl.js";import{f as U,t as M}from"./general-BfW9S8hN.js";import{r as me}from"./EyeIcon-Bb83ObiT.js";import{_ as be}from"./ExtraOptionsButton-DHDfDtw5.js";/* empty css                    */import{r as ge}from"./DocumentDuplicateIcon-CiCZJ2KK.js";import"./Modal-Cgf-4gDB.js";import"./PrinterIcon-BGNWiUH-.js";function B(h,x){return s(),r("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 7.5 7.5 3m0 0L12 7.5M7.5 3v13.5m13.5 0L16.5 21m0 0L12 16.5m4.5 4.5V7.5"})])}const we={class:"mx-auto shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-blue-400 sm:mx-0 sm:h-10 sm:w-10"},ke={class:"my-3"},ye=e("label",{for:"older-records-date",class:"text-xs text-neutral-400"},"Dia dos registros",-1),Ce=["max","disabled"],$e={key:0,class:"w-full text-center"},Ve={key:1,class:"text-sm text-neutral-500"},Te={class:"flex justify-between p-3 even:bg-neutral-100 hover:bg-neutral-200"},Ee=["href"],Se={key:2},Ae={__name:"SeeOldOvertimeCalculations",props:{modal:Boolean},emits:["close"],setup(h,{emit:x}){const m=x,c=_([]),A=_(!0),y=_(null),g=async(C="")=>{A.value=!0;try{const o=await de.get(`${route("employee.overtime_calculation_list")}/${C}`);c.value=o.data}catch(o){console.error("Erro ao buscar registros:",o)}finally{A.value=!1}};ce(c,()=>{y.value=c.value.length?U(c.value[0].created_at):U()},{immediate:!0}),ee(()=>{g()});const w=()=>m("close");return(C,o)=>(s(),te(fe,{show:h.modal,maxWidth:"2xl",onClose:w},{icon:E(()=>[e("div",we,[f(u(me),{class:"w-5 h-5 text-white"})])]),title:E(()=>[S(" Tabelas anteriores ")]),content:E(()=>[e("div",ke,[ye,k(e("input",{type:"date",id:"older-records-date",name:"older-records-date",max:u(U)(),"onUpdate:modelValue":o[0]||(o[0]=d=>y.value=d),onChange:o[1]||(o[1]=d=>g(d.target.value)),class:"simple-input disabled:opacity-50",disabled:A.value},null,40,Ce),[[P,y.value]])]),A.value?(s(),r("p",$e,"Carregando dados...")):T("",!0),c.value.length?(s(),r("ul",Ve,[(s(!0),r(z,null,ae(c.value,(d,N)=>{var F,I,i,O;return s(),r("li",Te,[e("span",null,p((I=(F=d==null?void 0:d.procedure)==null?void 0:F.user)==null?void 0:I.name)+" "+p((O=(i=d==null?void 0:d.procedure)==null?void 0:i.user)==null?void 0:O.surname),1),e("span",null,p(u(U)(d.created_at,"reading_date_time")),1),e("a",{href:C.route("employee.overtime_calculation",d.procedure.id),class:"text-green-500 hover:text-green-700 active:text-green-900"},"Ver",8,Ee)])}),256))])):(s(),r("p",Se,"Nenhum registro encontrado."))]),footer:E(()=>[f(xe,{onClick:o[2]||(o[2]=d=>w())},{default:E(()=>[S(" Fechar ")]),_:1})]),_:1},8,["show"]))}},Ne={class:"font-semibold text-xl text-gray-800 leading-tight flex justify-between"},Me={key:0,class:"text-right"},Pe={class:"text-sm text-neutral-500"},Ue={class:"text-xs text-neutral-400"},Fe={class:"pt-6 print:hidden"},Ie={class:"w-fit max-w-7xl mx-auto sm:px-6 lg:px-8 print:w-full"},Oe={class:"bg-white overflow-hidden shadow-xl sm:rounded-lg p-5"},je={class:"flex flex-col items-center justify-center align-middle gap-5"},He=e("h2",{class:"text-green-700 font-extrabold text-2xl"},"Controles da Tabela",-1),Be={key:0,class:"flex flex-col items-center justify-center align-middle gap-5"},De={class:"inline-flex items-center cursor-pointer"},Le=["disabled"],Je=e("div",{class:"relative w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-green-300 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-green-600"},null,-1),Xe=e("span",{class:"ms-3 text-sm font-medium text-gray-900"},"Mostrar funcionário omitidos",-1),qe=["disabled"],ze=["href"],Re={key:2},We={key:0,class:"text-xs text-red-300"},Ze={key:1,class:"text-xs text-neutral-500"},Ge={class:"py-6 print:py-0"},Ke={class:"max-w-full mx-auto print:max-w-full"},Qe={class:"px-0 print:px-0"},Ye={class:"bg-white overflow-hidden shadow-xl sm:rounded-lg print:shadow-none"},et={class:"flex flex-col"},tt={class:"overflow-x-auto sm:-mx-6 lg:-mx-8"},at={class:"inline-block min-w-full sm:px-6 lg:px-8"},nt={class:"overflow-hidden"},st={class:"min-w-full text-left text-sm font-light"},ot={class:"border-b font-medium"},rt={class:"bg-neutral-200"},it={key:0,scope:"col",class:"px-6 py-4 print:px-3 print:py-2 text-center print:hidden"},lt={class:"print:hidden"},ct=["disabled"],dt=e("th",{scope:"col",class:"px-6 py-4 print:px-3 print:py-2 text-center"}," Funcionário ",-1),ut=e("th",{scope:"col",class:"px-6 py-4 print:px-3 print:py-2 text-center print:hidden"}," Salário ",-1),pt=e("th",{scope:"col",class:"px-6 py-4 print:px-3 print:py-2 text-center print:hidden",title:"Início do expediente"}," H. Entrada",-1),_t=e("th",{scope:"col",class:"px-6 py-4 print:px-3 print:py-2 text-center print:hidden",title:"Saída para o horário de Almoço"},"S. Almoço",-1),ht=e("th",{scope:"col",class:"px-6 py-4 print:px-3 print:py-2 text-center print:hidden",title:"Entrada da volta do horário de Almoço"},"E. Almoço",-1),vt=e("th",{scope:"col",class:"px-6 py-4 print:px-3 print:py-2 text-center print:hidden",title:"Saída do expediente"},"H. Saída",-1),ft=e("th",{scope:"col",class:"px-6 py-4 print:px-3 print:py-2 text-center print:hidden",title:"Total de horas do Expediente"},"Total Horas",-1),xt={class:"print:hidden"},mt={class:"print:hidden"},bt=e("th",{scope:"col",class:"px-6 py-4 print:px-3 print:py-2 text-center",colspan:"2"}," Pix",-1),gt={key:0,class:"whitespace-nowrap py-1 print:p-0 text-center font-medium print:hidden"},wt=["value","onChange","checked","disabled"],kt={class:"py-4 text-center font-medium"},yt={class:"whitespace-nowrap py-1 print:p-0 text-center font-medium print:hidden"},Ct={class:"whitespace-nowrap py-1 print:p-0 text-center font-medium print:hidden relative"},$t=["onClick","disabled"],Vt=["disabled","onUpdate:modelValue"],Tt={class:"whitespace-nowrap py-1 print:p-0 text-center font-medium print:hidden relative"},Et=["onClick","disabled"],St=["disabled","onUpdate:modelValue"],At={class:"whitespace-nowrap py-1 print:p-0 text-center font-medium print:hidden relative"},Nt=["onClick","disabled"],Mt=["disabled","onUpdate:modelValue"],Pt={class:"whitespace-nowrap py-1 print:p-0 text-center font-medium print:hidden relative"},Ut=["onClick","disabled"],Ft=["disabled","onUpdate:modelValue"],It={class:"whitespace-nowrap py-1 print:p-0 text-center font-medium print:hidden"},Ot=["onClick"],jt={class:"flex flex-row justify-center items-center align-middle gap-3"},Ht={class:"whitespace-nowrap py-1 print:p-0 text-center font-medium uppercase"},Bt={key:1,class:"border-b transition duration-300 ease-in-out print:break-inside-avoid text-sm print:text-md bg-neutral-200"},Dt={key:0,class:"print:hidden",colspan:"6"},Lt={key:1,class:"print:hidden",colspan:"7"},Jt=e("td",{class:"whitespace-nowrap py-1 print:p-0 font-medium text-center"}," Total ",-1),Xt=e("td",{class:"whitespace-nowrap py-1 print:p-0 text-center font-medium",colspan:"2"},null,-1),qt={key:2,class:"transition duration-300 ease-in-out hover:bg-neutral-100 print:break-inside-avoid"},zt=e("td",{class:"whitespace-nowrap px-6 py-1 text-center",colspan:"11"},"Não há funcionários cadastradas no momento!",-1),Rt=[zt],oa={__name:"OvertimeCalculation",props:{page:Object,page_mode:String,user:Object,procedure_date:String,page_options:{type:Array,default:null},employees_list:Array,account_types_list:Array,payment_methods_list:Array,banks_list:Array,total_fifty_percent_value:Number,total_hundred_percent_value:Number},setup(h){const x=h,m=ue.useToast(),c=_(JSON.parse(JSON.stringify(x.employees_list))),A=JSON.parse(JSON.stringify(x.employees_list)),y=_(!1),g=_(!0),w=_(!0),C=_(!1),o=_(!1),d=_(x.total_fifty_percent_value),N=_(x.total_hundred_percent_value),F=()=>{m.clear(),c.value=A,o.value=!1,m.success("Tabela resetada com sucesso!")},I=()=>{c.value.forEach(t=>W(t,y.value)),y.value=!y.value,o.value=!0},i=Y(()=>x.page_mode==="old"),O=t=>{switch(t){case"pix_email":return"E-mail";case"pix_cpf":return"Cpf";case"pix_phone_number":return"Telefone";case"pix_token":return"Token"}return"-"},ne=t=>{let n=t[t.overtime_payment_method.cod];if(m.clear(),navigator.clipboard&&navigator.clipboard.writeText)return navigator.clipboard.writeText(n).then(()=>{m.success(`PIX de ${t.name} copiado para a área de transferência`)}).catch(a=>{m.error(`Não foi possível copiar o PIX de ${t.name} para a área de transferência`),console.error("Erro ao copiar texto para a área de transferência",a)});{const a=document.createElement("textarea");a.value=n,document.body.appendChild(a),a.focus(),a.select();try{document.execCommand("copy"),m.success(`PIX de ${t.name} copiado para a área de transferência`)}catch(v){m.error(`Não foi possível copiar o PIX de ${t.name} para a área de transferência`),console.error("Erro ao copiar texto para a área de transferência",v)}document.body.removeChild(a)}},j=(t,n)=>{if(!c||!c.value||!Array.isArray(c.value)){console.error("As informações dos funcionários não estão devidamente formatadas.");return}c.value.forEach(a=>{a.show&&(a[n]=t,o.value=!0)})},H=t=>{const[n,a]=t.split(":").map(Number);return n*60+a},se=t=>{if(!t.check_in_time||!t.leave_for_lunch_break||!t.check_in_after_lunch_break||!t.check_out_time)return t.total_time=0,t.fifty_percent_value=0,t.hundred_percent_value=0,0;const n=H(t.check_in_time),a=H(t.leave_for_lunch_break),v=H(t.check_in_after_lunch_break),b=H(t.check_out_time),$=a-n,l=b-v,Q=($+l)/60;return t.total_time=Q.toFixed(2),t.fifty_percent_value=R(t,.5),t.hundred_percent_value=R(t,1),D(),Q.toFixed(2)},R=(t,n)=>{const a=parseFloat(t.total_time)||0,v=t.salary/220,b=1+n;return v*a*b},D=()=>{let t=0,n=0;c.value.forEach(a=>{t+=a.fifty_percent_value||0,n+=a.hundred_percent_value||0}),d.value=t,N.value=n},W=(t,n=null)=>{const v=t.salary/220,b=v*8.75*1.5,$=v*8.75*2;n!==null&&(t.show=!n),t.show?(d.value-=t.fifty_percent_value||0,N.value-=t.hundred_percent_value||0,n!==null&&(t.show=n),t.check_in_time=null,t.leave_for_lunch_break=null,t.check_in_after_lunch_break=null,t.check_out_time=null,t.total_time=0,t.fifty_percent_value=0,t.hundred_percent_value=0,D()):(n!==null&&(t.show=n),t.check_in_time="07:00",t.leave_for_lunch_break="12:00",t.check_in_after_lunch_break="13:15",t.check_out_time="17:00",t.total_time=8.75,t.fifty_percent_value=b,t.hundred_percent_value=$,d.value+=b,N.value+=$,D()),n===null&&(t.show=!t.show),o.value=!0},Z=Y(()=>({totalFiftyPercentValue:d.value,totalHundredPercentValue:N.value})),L=_(!1),oe=()=>{L.value=!0},re=()=>{L.value=!1},G=async()=>{o.value&&x.page_mode!=="old"&&he.post(route("employee.overtime_calculation_save"),{employees:JSON.stringify(c.value)},{preserveScroll:!0,onSuccess:()=>console.log("Dados salvos com sucesso"),onError:t=>console.log("Erro ao salvar dados: ",t),onFinish:()=>o.value=!1})};let J=null;const ie=()=>{J=setInterval(G,1e4)},le=()=>{J&&clearInterval(J)},K=t=>{G()};return ee(()=>{ie(),window.addEventListener("beforeunload",K)}),pe(()=>{le(),window.removeEventListener("beforeunload",K)}),(t,n)=>(s(),r(z,null,[f(u(_e),{title:h.page.name},null,8,["title"]),f(ve,{page:h.page,page_options:h.page_options},{header:E(()=>[e("h2",Ne,[S(" Cálculo de Horas Extras "),h.user?(s(),r("div",Me,[e("p",Pe,p(h.user.name)+" "+p(h.user.surname),1),e("p",Ue,p(u(U)(h.procedure_date)),1)])):T("",!0)])]),default:E(()=>[e("div",Fe,[e("div",Ie,[e("div",Oe,[e("div",je,[He,i.value?T("",!0):(s(),r("div",Be,[e("label",De,[k(e("input",{type:"checkbox",disabled:i.value,"onUpdate:modelValue":n[0]||(n[0]=a=>C.value=a),class:"sr-only peer disabled:opacity-50"},null,8,Le),[[q,C.value]]),Je,Xe]),e("button",{class:"p-2 rounded-md bg-green-700 hover:bg-green-800 active:bg-green-900 text-white disabled:opacity-50",onClick:F,disabled:i.value},"Resetar Tabela",8,qe)])),e("button",{class:"text-xs text-green-600 hover:text-green-800 active:text-green-950 select-none disabled:opacity-50",onClick:oe},"Ver registros anteriores"),i.value?(s(),r("a",{key:1,href:t.route("employee.overtime_calculation"),class:"text-xs text-orange-500 hover:text-orange-700 active:text-orange-900 select-none disabled:opacity-50"},"Voltar para tabela normal",8,ze)):(s(),r("div",Re,[o.value?(s(),r("p",We,"Existem alterações não salvas (aguarde até 10 segundos)")):(s(),r("p",Ze,"Todas as alteraçẽos estão salvas"))]))])])])]),e("div",Ge,[e("div",Ke,[e("div",Qe,[e("div",Ye,[e("div",et,[e("div",tt,[e("div",at,[e("div",nt,[e("table",st,[e("thead",ot,[e("tr",rt,[i.value?T("",!0):(s(),r("th",it,[S(" Mostrar "),e("span",lt,[e("button",{class:"text-green-700 hover:text-green-800 active:text-green-900 text-xs disabled:opacity-50",onClick:I,disabled:i.value},"Alternar",8,ct)])])),dt,ut,pt,_t,ht,vt,ft,e("th",{scope:"col",class:V(["px-6 py-4 print:px-3 print:py-2 text-center",{"opacity-50 print:hidden":!g.value}])},[S(" Valor 50% "),e("span",xt,[k(e("input",{type:"checkbox",class:"focus:bg-green-700 focus:ring-green-700 text-green-700 border-neutral-500 rounded-sm disabled:opacity-50","onUpdate:modelValue":n[1]||(n[1]=a=>g.value=a)},null,512),[[q,g.value]])])],2),e("th",{scope:"col",class:V(["px-6 py-4 print:px-3 print:py-2 text-center",{"opacity-50 print:hidden":!w.value}])},[S(" Valor 100% "),e("span",mt,[k(e("input",{type:"checkbox",class:"focus:bg-green-700 focus:ring-green-700 text-green-700 border-neutral-500 rounded-sm disabled:opacity-50","onUpdate:modelValue":n[2]||(n[2]=a=>w.value=a)},null,512),[[q,w.value]])])],2),bt])]),e("tbody",null,[c.value.length?(s(!0),r(z,{key:0},ae(c.value,a=>{var v,b,$;return s(),r("tr",{class:V(["border-b transition duration-100 hover:bg-neutral-100 print:break-inside-avoid text-sm print:text-md",{"opacity-50 print:hidden":!a.show,hidden:!a.show&&!C.value}])},[i.value?T("",!0):(s(),r("td",gt,[e("input",{type:"checkbox",class:"focus:bg-green-700 focus:ring-green-700 text-green-700 border-neutral-500 rounded-sm disabled:opacity-50",value:a.show,onChange:l=>W(a),checked:a.show,disabled:i.value},null,40,wt)])),e("td",kt,p(a.name+" "+a.surname),1),e("td",yt,p(u(M)(a.salary||0)),1),e("td",Ct,[e("button",{class:"absolute left-0 top-1/2 transform -translate-y-1/2 text-neutral-300 hover:text-neutral-500 active:text-neutral-700 ml-3 disabled:opacity-50",onClick:l=>j(a.check_in_time,"check_in_time"),disabled:i.value},[f(u(B),{class:"w-3 h-3"})],8,$t),k(e("input",{type:"time",class:"focus:ring-green-700 simple-input pl-8 disabled:opacity-50",disabled:!a.show||i.value,"onUpdate:modelValue":l=>a.check_in_time=l,onInput:n[3]||(n[3]=l=>o.value=!0)},null,40,Vt),[[P,a.check_in_time]])]),e("td",Tt,[e("button",{class:"absolute left-0 top-1/2 transform -translate-y-1/2 text-neutral-300 hover:text-neutral-500 active:text-neutral-700 ml-3 disabled:opacity-50",onClick:l=>j(a.leave_for_lunch_break,"leave_for_lunch_break"),disabled:i.value},[f(u(B),{class:"w-3 h-3"})],8,Et),k(e("input",{type:"time",class:"focus:ring-green-700 simple-input pl-8 disabled:opacity-50",disabled:!a.show||i.value,"onUpdate:modelValue":l=>a.leave_for_lunch_break=l,onInput:n[4]||(n[4]=l=>o.value=!0)},null,40,St),[[P,a.leave_for_lunch_break]])]),e("td",At,[e("button",{class:"absolute left-0 top-1/2 transform -translate-y-1/2 text-neutral-300 hover:text-neutral-500 active:text-neutral-700 ml-3 disabled:opacity-50",onClick:l=>j(a.check_in_after_lunch_break,"check_in_after_lunch_break"),disabled:i.value},[f(u(B),{class:"w-3 h-3"})],8,Nt),k(e("input",{type:"time",class:"focus:ring-green-700 simple-input pl-8 disabled:opacity-50",disabled:!a.show||i.value,"onUpdate:modelValue":l=>a.check_in_after_lunch_break=l,onInput:n[5]||(n[5]=l=>o.value=!0)},null,40,Mt),[[P,a.check_in_after_lunch_break]])]),e("td",Pt,[e("button",{class:"absolute left-0 top-1/2 transform -translate-y-1/2 text-neutral-300 hover:text-neutral-500 active:text-neutral-700 ml-3 disabled:opacity-50",onClick:l=>j(a.check_out_time,"check_out_time"),disabled:i.value},[f(u(B),{class:"w-3 h-3"})],8,Ut),k(e("input",{type:"time",class:"focus:ring-green-700 simple-input pl-8 disabled:opacity-50",disabled:!a.show||i.value,"onUpdate:modelValue":l=>a.check_out_time=l,onInput:n[6]||(n[6]=l=>o.value=!0)},null,40,Ft),[[P,a.check_out_time]])]),e("td",It,p(se(a)),1),e("td",{class:V(["whitespace-nowrap py-1 print:p-0 text-center font-medium bg-neutral-50",{"opacity-50 print:hidden":!g.value}])},p(u(M)(a.fifty_percent_value||0)),3),e("td",{class:V(["whitespace-nowrap py-1 print:p-0 text-center font-medium bg-neutral-100",{"opacity-50 print:hidden":!w.value}])},p(u(M)(a.hundred_percent_value||0)),3),e("td",{class:"whitespace-nowrap py-1 print:p-0 text-center font-medium hover:text-green-600 active:text-green-700 cursor-pointer",title:"Clique para copiar PIX para área de transferência",onClick:l=>{var X;return(X=a.overtime_payment_method)!=null&&X.cod?ne(a):null}},[e("span",jt,[S(p((v=a.overtime_payment_method)!=null&&v.cod?a[a.overtime_payment_method.cod]:"-")+" ",1),(b=a.overtime_payment_method)!=null&&b.cod?(s(),te(u(ge),{key:0,class:"w-4 h-4 print:hidden"})):T("",!0)])],8,Ot),e("td",Ht,p(O((($=a.overtime_payment_method)==null?void 0:$.cod)||"-")),1)],2)}),256)):T("",!0),c.value.length?(s(),r("tr",Bt,[i.value?(s(),r("td",Dt)):(s(),r("td",Lt)),Jt,e("td",{class:V(["whitespace-nowrap py-1 print:p-0 text-center font-medium",{"opacity-50 print:hidden":!g.value}])},p(u(M)(Z.value.totalFiftyPercentValue||0)),3),e("td",{class:V(["whitespace-nowrap py-1 print:p-0 text-center font-medium",{"opacity-50 print:hidden":!w.value}])},p(u(M)(Z.value.totalHundredPercentValue||0)),3),Xt])):(s(),r("tr",qt,Rt))])])])])])])])])])]),f(be,{mode:["rollup","print_page"]}),f(Ae,{modal:L.value,onClose:re},null,8,["modal"])]),_:1},8,["page","page_options"])],64))}};export{oa as default};
