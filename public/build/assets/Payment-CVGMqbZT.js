import{y as U,T as k,d as C,l as $,o as i,e as c,b as r,u as n,Z as q,w as P,a as e,f as S,t as l,h as E,p as z,v as F,F as L,g as G}from"./app-xjJ8na4r.js";import{r as X,_ as Z}from"./AppLayout-BOBs5ZEO.js";import{_ as H}from"./CreateUpdatePayModal-2ZmZzX8r.js";import{_ as J}from"./FloatButton-DOifkNz7.js";import{_ as K}from"./ExtraOptionsButton-irMfiu4z.js";import{t as m}from"./general-DyNoCMvo.js";/* empty css                    */import{r as Q}from"./MagnifyingGlassIcon-BlKVGOg-.js";import{r as W,a as Y}from"./XMarkIcon-ClR3zrEp.js";import"./CreateUpdateModal-U7ZkrYrZ.js";import"./Modal-GnKcZS1t.js";import"./PrimaryButton-DYKnFRqk.js";import"./SecondaryButton-C2X9K_i9.js";import"./PlusIcon-Qtp_qUi0.js";import"./PrinterIcon-EuA9oIlG.js";const ee={class:"font-semibold text-xl text-gray-800 leading-tight"},te={key:0},se={class:"pt-12 print:hidden"},oe={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},ae={class:"bg-white overflow-hidden shadow-xl sm:rounded-lg p-5"},re={class:"flex flex-row items-center space-x-3"},ne={class:"py-12 print:py-6"},ie={class:"max-w-7xl mx-auto print:max-w-full"},ce={class:"px-0 print:px-0"},le={class:"bg-white overflow-hidden shadow-xl sm:rounded-lg print:shadow-none"},de={class:"flex flex-col"},pe={class:"overflow-x-auto sm:-mx-6 lg:-mx-8"},ue={class:"inline-block min-w-full py-2 sm:px-6 lg:px-8"},me={class:"overflow-hidden"},_e={class:"w-full text-left text-sm font-light"},he=e("thead",{class:"border-b font-medium"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-4 text-center"},"#"),e("th",{scope:"col",class:"px-6 py-4 text-center"},"Dívida"),e("th",{scope:"col",class:"px-6 py-4 text-center"},"Devedor"),e("th",{scope:"col",class:"px-6 py-4 text-center"},"À pagar"),e("th",{scope:"col",class:"px-6 py-4 text-center"},"Valor total"),e("th",{scope:"col",class:"px-6 py-4 text-center print:hidden"},"Pagar "),e("th",{scope:"col",class:"px-6 py-4 text-center print:hidden"},"Editar "),e("th",{scope:"col",class:"px-6 py-4 text-center print:hidden"},"Excluir ")])],-1),xe={class:"border-b transition duration-300 ease-in-out hover:bg-neutral-100 print:break-inside-avoid"},ve={class:"whitespace-nowrap py-4 text-center font-medium"},ye={class:"break-words px-6 py-4 text-center"},ge=["title"],we={class:"whitespace-normal px-6 py-4 text-center"},fe={class:"whitespace-nowrap px-2 py-4 text-center"},be={class:"whitespace-nowrap px-2 py-4 text-center"},ke=["title","onClick"],Ce=["title","onClick"],$e=["title","onClick"],Pe={key:1,class:"whitespace-nowrap px-4 py-4 text-center select-none print:hidden"},Se={key:1,class:"transition duration-300 ease-in-out hover:bg-neutral-100 print:break-inside-avoid"},Ee=e("td",{class:"whitespace-nowrap px-6 py-4 text-center",colspan:"9"},"Não há pagamentos cadastrados no momento!",-1),Le=[Ee],Ge={__name:"Payment",props:{page:Object,page_options:{type:Array,default:null},payments_list:Object},setup(p){const h=p,g=U.useToast(),s=k({id:null,debt:"",debtor:"",total_value:0,partial_value:0,observations:"",records_list:{enable_records:!1,data:[]}}),x=C(""),w=$(()=>{const o=x.value.toLowerCase();return h.payments_list.filter(a=>a.motive.toLowerCase().includes(o)||a.entity_name.toLowerCase().includes(o)||m(a.accounting.total_value).toString().toLowerCase().includes(o)||m(a.accounting.partial_value).toString().toLowerCase().includes(o))}),V=$(()=>h.payments_list.reduce((o,a)=>o+a.accounting.partial_value,0)),d=C({mode:"create",show:!1,get title(){switch(this.mode){case"create":return"Criar pagamento";case"update":return"Editar pagamento";case"pay":return"Pagar pagamento"}},get primary_button_txt(){switch(this.mode){case"create":return"Cadastrar";case"update":return"Atualizar";case"pay":return"Pagar"}}}),v=(o,a=null)=>{const t=["update","pay"].includes(o);if(a!==null&&t){const u=h.payments_list.find(y=>y.id===a);if(u){const{id:y,type:N,motive:O,entity_name:j,observations:I,records:f,accounting:b}=u;s.id=y,s.type=N,s.debt=O,s.debtor=j,s.total_value=b.total_value,s.partial_value=b.partial_value,s.observations=I,s.records_list.enable_records=!!f.length,s.records_list.data=f.map(R=>k(R))}}d.value.mode=o,d.value.show=!0},_=()=>{s.reset(),d.value.show=!1},T=()=>{s.post(route("payments.store"),{preserveScroll:!0,onSuccess:()=>_(),onError:o=>{console.log(o)}})},M=()=>{s.put(route("payments.update",s.id),{preserveScroll:!0,onSuccess:()=>_()})},A=()=>{s.put(route("payments.pay",s.id),{preserveScroll:!0,onSuccess:()=>_()})},B=(o,a)=>{confirm(`Você tem certeza que deseja excluir o pagamento "${a}"? Esta ação não poderá ser desfeita!`)&&s.delete(route("payments.destroy",o),{preserveScroll:!0,onSuccess:()=>g.success("Pagamento deletado com sucesso!")})},D=()=>{switch(d.value.mode){case"create":return T();case"update":return M();case"pay":return A();default:g.error("Método desconhecido. Informar o Técnico.")}};return(o,a)=>(i(),c(L,null,[r(n(q),{title:p.page.name},null,8,["title"]),r(Z,{page:p.page,page_options:p.page_options},{header:P(()=>[e("h2",ee,[S(l(p.page.name)+" ",1),o.$page.props.auth.user.hierarchy<2?(i(),c("span",te,"| "+l(n(m)(V.value)),1)):E("",!0)]),r(J,{icon:"plus",onClick:a[0]||(a[0]=t=>v("create")),title:"Cadastrar Payment",class:"print:hidden"})]),default:P(()=>[e("div",se,[e("div",oe,[e("div",ae,[e("div",re,[r(n(Q),{class:"w-5 y-5"}),z(e("input",{type:"text",name:"search_term",id:"search_term",autocomplete:"on",class:"simple-input",autofocus:"true",placeholder:"Pesquisar termo...","onUpdate:modelValue":a[1]||(a[1]=t=>x.value=t)},null,512),[[F,x.value]])])])])]),e("div",ne,[e("div",ie,[e("div",ce,[e("div",le,[e("div",de,[e("div",pe,[e("div",ue,[e("div",me,[e("table",_e,[he,e("tbody",null,[w.value.length?(i(!0),c(L,{key:0},G(w.value,t=>(i(),c("tr",xe,[e("td",ve,l(t.id),1),e("td",ye,[S(l(t.motive)+" ",1),t.observations?(i(),c("span",{key:0,title:t.observations,class:"inline-flex items-center rounded-md bg-gray-50 px-2 py-1 text-xs font-medium text-gray-600 ring-1 ring-inset ring-gray-500/10 cursor-help"},"OBS",8,ge)):E("",!0)]),e("td",we,l(t.entity_name),1),e("td",fe,l(n(m)(t.accounting.partial_value)),1),e("td",be,l(n(m)(t.accounting.total_value)),1),e("td",{class:"whitespace-nowrap px-4 py-4 text-center cursor-pointer hover:text-green-700 active:text-green-900 select-none print:hidden",title:"PAGAR: "+t.motive+"("+t.entity_name+")",onClick:u=>v("pay",t.id)},[r(n(X),{class:"w-5 h-5 m-auto"})],8,ke),e("td",{class:"whitespace-nowrap px-4 py-4 text-center cursor-pointer hover:text-yellow-700 active:text-yellow-900 select-none print:hidden",title:"EDITAR: "+t.motive+"("+t.entity_name+")",onClick:u=>v("update",t.id)},[r(n(W),{class:"w-5 h-5 m-auto"})],8,Ce),t.type!==2?(i(),c("td",{key:0,class:"whitespace-nowrap px-4 py-4 text-center cursor-pointer hover:text-red-700 active:text-red-900 select-none print:hidden",title:"EXCLUIR: "+t.motive+"("+t.entity_name+")",onClick:u=>B(t.id,t.motive)},[r(n(Y),{class:"w-5 h-5 m-auto"})],8,$e)):(i(),c("td",Pe," Venda "))]))),256)):(i(),c("tr",Se,Le))])])])])])])])])])]),r(H,{show:d.value.show,modal:d.value,payment:n(s),onSubmit:D,onClose:_},null,8,["show","modal","payment"]),r(K,{mode:["rollup","print_page","link"],link_type:["previous"],link:[o.route("payments.previous")]},null,8,["link"])]),_:1},8,["page","page_options"])],64))}};export{Ge as default};
