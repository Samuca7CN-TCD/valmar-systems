import{l as b,T as I,d as M,o,c as h,w as _,a as e,n as w,u as i,h as l,f as D,t as c,i as O,q as v,v as x,e as r,F as S,g as F,b as T}from"./app-GSE23OBQ.js";import{_ as L}from"./CreateUpdateModal-CoPdkdw9.js";import{_ as G}from"./PrimaryButton-Bmz_jlAu.js";import{_ as H}from"./SecondaryButton-B6ZrvCMw.js";import{f as g,t as k}from"./general-f63YF4ZR.js";import{r as J}from"./PlusIcon-CwGAHxrw.js";import{r as K,a as Q}from"./XMarkIcon-B-R4M4GW.js";import{r as W}from"./AppLayout-D0XooGLR.js";import{r as X}from"./EyeIcon-DSXp5cey.js";const Y={class:"pb-12 space-y-12 divide-y-2"},Z={class:"py-4"},ee=e("h2",{class:"text-base font-semibold leading-7 text-gray-900"},"Informações Básicas",-1),te=e("p",{class:"mt-1 text-sm leading-6 text-gray-600"},"Informações sobre o serviço como título do serviço, nome do cliente, valores de pagamento e prazo para conclusão",-1),se={class:"mt-10 grid grid-cols-1 gap-x-6 gap-y-8 sm:grid-cols-6"},oe={class:"sm:col-span-6"},ae=e("label",{for:"service-title",class:"block text-sm font-medium leading-6 text-gray-900 required-input-label"},"Título",-1),re={class:"mt-2"},le=["disabled"],de={key:0,class:"text-red-500 text-sm"},ie={class:"sm:col-span-3"},ne=e("label",{for:"service-client",class:"block text-sm font-medium leading-6 text-gray-900 required-input-label"},"Cliente",-1),ce={class:"mt-2"},ue=["disabled"],me={key:0,class:"text-red-500 text-sm"},ve={class:"sm:col-span-3"},xe=e("label",{for:"service-total-amount",class:"block text-sm font-medium leading-6 text-gray-900 required-input-label"},"Valor total",-1),be={class:"mt-2"},ge=["disabled"],he={key:0,class:"text-red-500 text-sm"},_e={class:"sm:col-span-6"},pe=e("label",{for:"service-deadline",class:"block text-sm font-medium leading-6 text-gray-900 required-input-label"},"Prazo para conclusão",-1),ye={class:"mt-2"},fe=["min","disabled"],we={key:0,class:"text-red-500 text-sm"},ke={class:"sm:col-span-6"},Ve=e("label",{for:"service-observations",class:"block text-sm font-medium leading-6 text-gray-900"},"Observações",-1),$e={class:"mt-2"},qe=["disabled"],De={key:0,class:"text-red-500 text-sm"},Ce={key:0,class:"py-4"},ze={class:"sm:col-span-6"},Ue=["title"],Re={class:"flex h-6 items-center"},Te=["disabled"],je={class:"text-sm leading-6"},Ne={key:1,class:"py-4"},Ae={key:0},Pe=e("h2",{class:"text-base font-semibold leading-7 text-gray-900"},"Pagamentos concluídos",-1),Be=e("p",{class:"mt-1 text-sm leading-6 text-gray-600"},"Insira o adiantamento ou os serviços parciais já realizando desta título",-1),Ee=[Pe,Be],Ie={key:1},Me=e("h2",{class:"text-base font-semibold leading-7 text-gray-900"},"Lista de pagamentos concluídos ",-1),Oe=e("p",{class:"mt-1 text-sm leading-6 text-gray-600"},"Abaixo está listado os registros de serviços realizados. Para adicionar novos serviços, ou remover algum serviço existente, entre na seção de serviço.",-1),Se=[Me,Oe],Fe={key:2},Le=e("h2",{class:"text-base font-semibold leading-7 text-gray-900"},"Realize um novo pagamento",-1),Ge=e("p",{class:"mt-1 text-sm leading-6 text-gray-600"},"Adicione um serviço ou remova um serviço existente.",-1),He=[Le,Ge],Je={key:3},Ke=e("h2",{class:"text-base font-semibold leading-7 text-gray-900"},"Veja a lista de pagamentos realizados",-1),Qe=e("p",{class:"mt-1 text-sm leading-6 text-gray-600"},"Abaixo segue a lista dos pagamentos concluídos deste serviço",-1),We=[Ke,Qe],Xe={key:4,class:"mt-10 grid grid-cols-1 gap-x-6 gap-y-4 sm:grid-cols-6"},Ye={class:"col-span-3"},Ze=e("label",{for:"record-amount",class:"block text-sm font-medium leading-6 text-gray-900 required-input-label"},"Valor (R$)",-1),et={class:"mt-2"},tt=["max","disabled"],st={class:"text-gray-400 text-xs py-1"},ot={key:0,class:"text-red-500 text-sm"},at={class:"sm:col-span-3"},rt=e("label",{for:"record-date",class:"block text-sm font-medium leading-6 text-gray-900 required-input-label"},"Data do serviço",-1),lt={class:"mt-2"},dt=["max","disabled"],it=e("p",{class:"text-gray-400 text-xs py-1"},"Não aceita datas no futuro",-1),nt={key:0,class:"text-red-500 text-sm"},ct={key:5,class:"w-full py-5 flex justify-end"},ut=["disabled"],mt={key:6,class:"flex flex-col"},vt={class:"overflow-x-auto sm:-mx-6 lg:-mx-8"},xt={class:"inline-block min-w-full py-2 sm:px-6 lg:px-8"},bt={class:"overflow-hidden"},gt={class:"min-w-full text-left text-sm font-light"},ht={class:"border-b bg-white font-medium"},_t=e("th",{scope:"col",class:"px-6 py-4 text-center"},"Valor",-1),pt=e("th",{scope:"col",class:"px-6 py-4 text-center"},"Data",-1),yt={key:0,scope:"col",class:"px-6 py-4 text-center"},ft={class:"border-b bg-white"},wt={class:"whitespace-nowrap px-6 text-center"},kt={key:0,class:"w-full relative flex flex-wrap items-stretch"},Vt=e("span",{class:"w-1/4 select-none flex items-center whitespace-nowrap rounded-l border border-r-0 border-solid border-neutral-300 px-3 py-[0.25rem] text-center text-xs font-normal leading-[1.6] text-neutral-700",id:"basic-addon1"},"R$",-1),$t=["max","onUpdate:modelValue"],qt={key:1},Dt={class:"whitespace-nowrap px-6 py-4 text-center"},Ct={key:0,class:"w-full relative flex flex-wrap items-stretch"},zt=["max","onUpdate:modelValue"],Ut={key:1},Rt={key:0,class:"whitespace-nowrap px-6 py-4 select-none"},Tt={key:1,class:"text-red-500 text-sm"},jt={key:2,class:"text-red-500 text-sm"},Nt={key:0,class:"text-red-500 text-sm py-5 text-center"},At={key:1,class:"text-red-500 text-sm py-5 text-center"},Pt={key:2,class:"text-red-500 text-sm py-5 text-center"},Bt={key:7,class:"py-5 text-gray-400 text-center"},Jt={__name:"CreateUpdatePayModal",props:{modal:Object,service:{type:Object,default:null}},emits:["close","submit"],setup(t,{emit:j}){const C=j,d=t,N=b(()=>d.service.records_list.data.length+1),m=b(()=>z&&d.service.total_value-d.service.records_list.data.reduce((u,a)=>u+a.amount,0)),V=b(()=>{const u=new Date;return d.service.records_list.data.some(a=>new Date(a.date)>u)}),$=b(()=>d.service.records_list.data.some(u=>u.amount<=0)),A=b(()=>d.service.records_list.data.sort((u,a)=>new Date(u.date)-new Date(a.date))),p=b(()=>d.modal.mode==="pay"||d.modal.mode==="see"),z=b(()=>d.modal.mode!=="create"||d.service.records_list.enable_records),y=b(()=>d.service.title.length&&d.service.client.length&&d.service.total_value>0),n=I({id:N,amount:0,past:!1,register_date:g(),filepath:null}),U=M(!1),P=()=>{if(d.service.records_list.enable_records&&d.service.records_list.data.length)if(confirm("Tem certeza que deseja desmarcar? Todos os registros serão excluídos!"))d.service.records_list.data.length=[],n.reset();else return;d.service.records_list.enable_records=!d.service.records_list.enable_records},B=()=>{if(!n.amount||n.amount>m.value){n.errors.amount=`O valor do registro deve ser maior que R$ 0,00 e menor que ${k(m.value)}`;return}if(n.errors.amount="",!n.register_date||new Date(n.register_date)>new Date){n.errors.date=`A data do registro deve ser menor ou igual a ${g()}`;return}n.errors.date="",U.value||(n.filepath=null),d.service.records_list.data.push({...n}),U.value=!1,n.reset()},E=(u,a=null)=>{if(d.modal.mode==="create"){d.service.records_list.data=d.service.records_list.data.filter(s=>s.id!==u);return}else confirm("Você tem certeza que deseja excluir esse registro? (Essa ação não pode ser desfeita)")&&a.delete(route("records.destroy",u),{preserveScroll:!0,onSuccess:()=>{d.service.records_list.data=d.service.records_list.data.filter(s=>s.id!==u)}})},q=()=>{C("close")},R=()=>{C("submit")};return(u,a)=>(o(),h(L,{show:t.modal.show,onClose:q},{icon:_(()=>[e("div",{class:w(["mx-auto shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-blue-400 sm:mx-0 sm:h-10 sm:w-10",{"bg-yellow-400":t.modal.mode==="update","bg-green-400":t.modal.mode==="pay","bg-gray-400":t.modal.mode==="see"}])},[t.modal.mode==="create"?(o(),h(i(J),{key:0,class:"w-5 h-5 text-white"})):l("",!0),t.modal.mode==="update"?(o(),h(i(K),{key:1,class:"w-5 h-5 text-white"})):l("",!0),t.modal.mode==="pay"?(o(),h(i(W),{key:2,class:"w-5 h-5 text-white"})):l("",!0),t.modal.mode==="see"?(o(),h(i(X),{key:3,class:"w-5 h-5 text-white"})):l("",!0)],2)]),title:_(()=>[D(c(t.modal.title),1)]),content:_(()=>[e("form",{onSubmit:O(R,["prevent"])},[e("div",Y,[e("section",Z,[ee,te,e("div",se,[e("div",oe,[ae,e("div",re,[v(e("input",{type:"text",name:"service-title",id:"service-title",autocomplete:"on",class:"simple-input disabled:bg-gray-200",autofocus:"true",placeholder:"Título da título",disabled:p.value,"onUpdate:modelValue":a[0]||(a[0]=s=>t.service.title=s),required:""},null,8,le),[[x,t.service.title]]),t.service.errors.title?(o(),r("p",de,c(t.service.errors.title),1)):l("",!0)])]),e("div",ie,[ne,e("div",ce,[v(e("input",{type:"text",name:"service-client",id:"service-client",autocomplete:"on",class:"simple-input disabled:bg-gray-200",placeholder:"Nome do cliente",disabled:p.value,"onUpdate:modelValue":a[1]||(a[1]=s=>t.service.client=s),required:""},null,8,ue),[[x,t.service.client]]),t.service.errors.client?(o(),r("p",me,c(t.service.errors.client),1)):l("",!0)])]),e("div",ve,[xe,e("div",be,[v(e("input",{id:"service-total-amount",name:"service-total-amount",type:"number",step:"0.01",min:"0",autocomplete:"off",class:"simple-input disabled:bg-gray-200",placeholder:"Valor total inicial da título",disabled:p.value,"onUpdate:modelValue":a[2]||(a[2]=s=>t.service.total_value=s),required:""},null,8,ge),[[x,t.service.total_value]]),t.service.errors.total_value?(o(),r("p",he,c(t.service.errors.total_value),1)):l("",!0)])]),e("div",_e,[pe,e("div",ye,[v(e("input",{type:"date",name:"service-deadline",id:"service-deadline",autocomplete:"on",class:"simple-input disabled:bg-gray-200",autofocus:"true",placeholder:"Prazo para conclusão",min:i(g)(),disabled:p.value,"onUpdate:modelValue":a[3]||(a[3]=s=>t.service.deadline=s),required:""},null,8,fe),[[x,t.service.deadline]]),t.service.errors.deadline?(o(),r("p",we,c(t.service.errors.deadline),1)):l("",!0)])]),e("div",ke,[Ve,e("div",$e,[v(e("textarea",{type:"text",observations:"service-observations",id:"service-observations",autocomplete:"on",class:"simple-input disabled:bg-gray-200",placeholder:"Descreva a título mais detalhadamente ou insira informações adicionais",disabled:p.value,"onUpdate:modelValue":a[4]||(a[4]=s=>t.service.observations=s)},null,8,qe),[[x,t.service.observations]]),t.service.errors.observations?(o(),r("p",De,c(t.service.errors.observations),1)):l("",!0)])])])]),t.modal.mode==="create"?(o(),r("section",Ce,[e("div",ze,[e("div",{class:"mt-2 relative flex gap-x-3",title:y.value?"":"Preencha ao menos a título, o cliente e o valor total."},[e("div",Re,[e("input",{id:"service-enable-records",name:"service-enable-records",type:"checkbox",onChange:a[5]||(a[5]=s=>P()),disabled:!y.value,class:"h-4 w-4 rounded border-gray-300 text-green-600 focus:ring-green-600 disabled:border-gray-100 disabled:text-green-200 disabled:bg-gray-300"},null,40,Te)]),e("div",je,[e("label",{for:"service-enable-records",class:w(["font-medium text-gray-900 select-none cursor-pointer",{"text-gray-300":!y.value,"cursor-not-allowed":!y.value}])},"Adicionar pagamentos concluídos",2)])],8,Ue)])])):l("",!0),z.value?(o(),r("section",Ne,[t.modal.mode==="create"?(o(),r("div",Ae,Ee)):l("",!0),t.modal.mode==="update"?(o(),r("div",Ie,Se)):l("",!0),t.modal.mode==="pay"?(o(),r("div",Fe,He)):l("",!0),t.modal.mode==="see"?(o(),r("div",Je,We)):l("",!0),t.modal.mode!=="update"&&t.modal.mode!=="see"?(o(),r("div",Xe,[e("div",Ye,[Ze,e("div",et,[v(e("input",{id:"record-amount",name:"record-amount",type:"number",step:"0.01",min:"0",max:m.value,autocomplete:"off",class:"simple-input disabled:bg-gray-200 disabled:opacity-75",disabled:m.value==0,placeholder:"Valor do serviço parcial","onUpdate:modelValue":a[6]||(a[6]=s=>i(n).amount=s)},null,8,tt),[[x,i(n).amount]]),e("p",st,"Valor Restante:y "+c(i(k)(m.value)),1),i(n).errors.amount?(o(),r("p",ot,c(i(n).errors.amount),1)):l("",!0)])]),e("div",at,[rt,e("div",lt,[v(e("input",{id:"record-date",name:"record-date",type:"date",max:i(g)(),autocomplete:"off",class:"simple-input disabled:bg-gray-200",disabled:m.value==0,placeholder:"Data de serviço do valor parcial","onUpdate:modelValue":a[7]||(a[7]=s=>i(n).register_date=s)},null,8,dt),[[x,i(n).register_date]]),it,i(n).errors.date?(o(),r("p",nt,c(i(n).errors.date),1)):l("",!0)])])])):l("",!0),t.modal.mode!=="update"&&t.modal.mode!=="see"?(o(),r("div",ct,[e("button",{type:"button",class:"w-full px-4 py-2 bg-blue-600 border border-gray-300 rounded-md font-semibold text-xs text-white uppercase tracking-widest shadow-sm hover:bg-blue-700 focus:outline-none focus:border-blue-300 focus:ring focus:ring-blue-200 active:text-gray-800 active:bg-gray-50 disabled:opacity-25 transition",disabled:!i(n).amount||!i(n).register_date||i(n).amount>m.value,onClick:a[8]||(a[8]=s=>B())}," Inserir registro ",8,ut)])):l("",!0),t.service.records_list.data.length?(o(),r("div",mt,[e("div",vt,[e("div",xt,[e("div",bt,[e("table",gt,[e("thead",ht,[e("tr",null,[_t,pt,t.modal.mode!=="pay"&&t.modal.mode!=="see"?(o(),r("th",yt,"Excluir")):l("",!0)])]),e("tbody",null,[(o(!0),r(S,null,F(A.value,s=>(o(),r("tr",ft,[e("td",wt,[t.modal.mode!=="update"&&!s.past?(o(),r("div",kt,[Vt,v(e("input",{id:"record_item-amount-edit",name:"record_item-amount-edit",type:"number",step:"0.01",min:"0",max:m.value,autocomplete:"off",class:"relative m-0 block min-w-0 flex-auto rounded-r border border-solid border-neutral-300 bg-transparent bg-clip-padding px-3 py-[0.25rem] text-xs font-normal leading-[1.6] text-neutral-700 outline-none transition duration-200 ease-in-out focus:z-[3] focus:border-primary focus:text-neutral-700 focus:shadow-[inset_0_0_0_1px_rgb(59,113,202)] focus:outline-none disabled:bg-gray-200",placeholder:"Editar serviço parcial","onUpdate:modelValue":f=>s.amount=f},null,8,$t),[[x,s.amount]])])):(o(),r("p",qt,c(i(k)(s.amount)),1))]),e("td",Dt,[t.modal.mode!=="update"&&!s.past?(o(),r("div",Ct,[v(e("input",{id:"record-date",name:"record-date",type:"date",max:i(g)(),autocomplete:"off",class:"w-3/4 relative m-0 block min-w-0 flex-auto rounded-r border border-solid border-neutral-300 bg-transparent bg-clip-padding px-3 py-[0.25rem] text-xs font-normal leading-[1.6] text-neutral-700 outline-none transition duration-200 ease-in-out focus:z-[3] focus:border-primary focus:text-neutral-700 focus:shadow-[inset_0_0_0_1px_rgb(59,113,202)] focus:outline-none disabled:bg-gray-200",placeholder:"Data de serviço do valor parcial","onUpdate:modelValue":f=>s.register_date=f},null,8,zt),[[x,s.register_date]])])):(o(),r("p",Ut,c(i(g)(s.register_date,!0)),1))]),t.modal.mode!=="pay"&&t.modal.mode!=="see"?(o(),r("td",Rt,[T(i(Q),{class:"w-5 h-5 cursor-pointer m-auto text-gray-700 hover:text-red-500 active:text-red-700",onClick:f=>E(s.id,s),title:"Remover este registro"},null,8,["onClick"])])):l("",!0),s.errors.amount?(o(),r("p",Tt,c(s.errors.amount),1)):l("",!0),s.errors.date?(o(),r("p",jt,c(s.errors.date),1)):l("",!0)]))),256))])]),m.value<0?(o(),r("p",Nt,"A soma dos serviços não pode ser maior que "+c(i(k)(t.service.total_value)),1)):l("",!0),V.value?(o(),r("p",At," Todas as datas de registro devem ser não nulas e menores ou iguais a "+c(i(g)(new Date)),1)):l("",!0),$.value?(o(),r("p",Pt," Todos os valores devem ser maiores que R$ 0,00")):l("",!0)])])])])):(o(),r("div",Bt,"Não há registro de pagamento no momento. "))])):l("",!0)])],32)]),footer:_(()=>[t.modal.mode!=="see"?(o(),h(H,{key:0,class:w({disabled:t.service.processing}),onClick:a[9]||(a[9]=s=>q())},{default:_(()=>[D(" Cancelar ")]),_:1},8,["class"])):l("",!0),T(G,{class:w({disabled:t.service.processing||m.value<0||V.value||$.value}),disabled:t.service.processing||m.value<0||V.value||$.value,onClick:a[10]||(a[10]=s=>t.modal.mode==="see"?q():R())},{default:_(()=>[D(c(t.modal.primary_button_txt),1)]),_:1},8,["class","disabled"])]),_:1},8,["show"]))}};export{Jt as _};
