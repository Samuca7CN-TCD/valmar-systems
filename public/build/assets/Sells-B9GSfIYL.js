import{d as L,l as U,c as j,o as i,w as V,f as m,b as y,n as P,g as $,t as c,a as e,i as Y,e as u,q as v,v as k,u as n,F as G,h as H,E as ee,m as te,T as Z,Z as se,z as ae}from"./app-CZkq5Z-4.js";import{r as le,a as oe,b as ne,_ as ie}from"./AppLayout-D2xbGot6.js";import{_ as de}from"./CreateUpdateModal-BgXUm0af.js";import{_ as re}from"./PrimaryButton-d3GyyHQH.js";import{_ as ce}from"./SecondaryButton-BvordoBr.js";import{f as X,t as b}from"./general-NIAW1A15.js";import{_ as ue,r as me}from"./SelectSearchItem-CPihEqMs.js";import{r as pe}from"./PlusIcon-BzKLYwAn.js";import{r as _e,a as ge}from"./XMarkIcon-BdHH6tt4.js";import{r as K}from"./EyeIcon-DZjMa3-U.js";import{_ as he}from"./FloatButton-DfXhYRoG.js";/* empty css                    */import{r as ye}from"./MagnifyingGlassIcon-G4Sq5WzV.js";import"./Modal-BmwXH8cy.js";import"./PrinterIcon-4_hv0DdK.js";const xe={class:"pb-12 space-y-12 divide-y-2"},ve={class:"py-4"},fe=e("h2",{class:"text-base font-semibold leading-7 text-gray-900"},"Informações Básicas",-1),be=e("p",{class:"mt-1 text-sm leading-6 text-gray-600"},"Informações sobre a venda como nome do cliente, data da venda e observações",-1),we={class:"mt-10 grid grid-cols-1 gap-x-6 gap-y-8 sm:grid-cols-6"},$e={class:"sm:col-span-3"},ke=e("label",{for:"sell-client",class:"block text-sm font-medium leading-6 text-gray-900 required-input-label"},"Cliente",-1),qe={class:"mt-2"},Ve=["disabled"],Ce={key:0,class:"text-red-500 text-sm"},Se={class:"sm:col-span-3"},Ie=e("label",{for:"sell-date",class:"block text-sm font-medium leading-6 text-gray-900 required-input-label"},"Data da Venda",-1),De={class:"mt-2"},Oe=["disabled","max"],Ue={key:0,class:"text-red-500 text-sm"},Le={class:"sm:col-span-6"},Re=e("label",{for:"sell-observations",class:"block text-sm font-medium leading-6 text-gray-900"},"Observações",-1),Ae={class:"mt-2"},Me=["disabled"],Ee={key:0,class:"text-red-500 text-sm"},je={key:0,class:"py-4"},Ne=e("h2",{class:"text-base font-semibold leading-7 text-gray-900"},"Lista de Itens",-1),Te=e("p",{class:"mt-1 text-sm leading-6 text-gray-600"},"Adicione os itens da venda bem como descontos e valor de pagamento de entrada.",-1),Pe={class:"mt-10 grid grid-cols-1 gap-x-6 gap-y-8 sm:grid-cols-4"},Fe={key:0,class:"sm:col-span-4"},Be=e("label",{for:"item-selecter",class:"block text-sm font-medium leading-6 text-gray-900 required-input-label"},"Selecione os itens de venda",-1),ze={class:"mt-2"},Je={class:"md:col-span-2 lg:col-span-1"},Qe=e("label",{for:"sell-estimated-amount",class:"block text-sm font-medium leading-6 text-gray-900"},"Valor estimado ",-1),We={class:"relative mt-2 rounded-md shadow-sm"},Ge=e("div",{class:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3"},[e("span",{class:"text-gray-500 sm:text-sm"},"R$")],-1),Xe=["disabled"],Ze={key:0,class:"text-red-500 text-sm"},He={class:"md:col-span-2 lg:col-span-1"},Ke=e("label",{for:"sell-total-amount",class:"block text-sm font-medium leading-6 text-gray-900"},"Valor final ",-1),Ye={class:"relative mt-2 rounded-md shadow-sm"},et=e("div",{class:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3"},[e("span",{class:"text-gray-500 sm:text-sm"},"R$")],-1),tt=["disabled","value"],st={key:0,class:"text-red-500 text-sm"},at={class:"md:col-span-2 lg:col-span-1"},lt=e("label",{for:"sell-discount-percent",class:"block text-sm font-medium leading-6 text-gray-900"},"Desconto (%) ",-1),ot={class:"relative mt-2 rounded-md shadow-sm"},nt=["disabled","value"],it=e("div",{class:"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-3"},[e("span",{class:"text-gray-500 sm:text-sm"},"%")],-1),dt={key:0,class:"text-red-500 text-sm"},rt={class:"md:col-span-2 lg:col-span-1"},ct=e("label",{for:"sell-discount",class:"block text-sm font-medium leading-6 text-gray-900"},"Desconto (R$) ",-1),ut={class:"relative mt-2 rounded-md shadow-sm"},mt=e("div",{class:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3"},[e("span",{class:"text-gray-500 sm:text-sm"},"R$")],-1),pt=["disabled","value"],_t={key:0,class:"text-red-500 text-sm"},gt={class:"sm:col-span-4"},ht={key:0,class:"min-w-full text-left text-sm font-medium leading-6 text-gray-900"},yt={class:"border-b font-medium"},xt=e("th",{scope:"col",class:"px-6 py-4 text-center"},"#",-1),vt=e("th",{scope:"col",class:"px-6 py-4 text-center"},"Item",-1),ft=e("th",{scope:"col",class:"px-6 py-4 text-center"},"Qtd. Estoque",-1),bt=e("th",{scope:"col",class:"px-6 py-4 text-center"},"Qtd. Venda",-1),wt=e("th",{scope:"col",class:"px-6 py-4 text-center"},"Und. Medida",-1),$t=e("th",{scope:"col",class:"px-6 py-4 text-center"},"Preço unitário",-1),kt=e("th",{scope:"col",class:"px-6 py-4 text-center"},"Preço montante",-1),qt={key:0,scope:"col",class:"px-6 py-4 text-center"},Vt={class:"whitespace-nowrap py-4 text-center font-medium"},Ct={class:"whitespace-nowrap py-4 text-center font-medium"},St={class:"whitespace-nowrap py-4 text-center font-medium flex justify-center"},It=["value","onInput","disabled"],Dt={class:"whitespace-nowrap py-4 text-center font-medium"},Ot={class:"whitespace-nowrap py-4 text-center font-medium"},Ut={class:"whitespace-nowrap py-4 text-center font-medium"},Lt={key:0,class:"whitespace-nowrap py-4 text-center font-mono text-2xl"},Rt=["onClick","title"],At={key:1,class:"p-5 bg-gray-200 rounded-md block text-sm font-medium leading-6 text-gray-900"},Mt={key:1,class:"w-full py-4"},Et=e("h2",{class:"text-base font-semibold leading-7 text-gray-900"},"Pagamento de entrada",-1),jt=e("p",{class:"mt-1 text-sm leading-6 text-gray-600"},"Após a conclusão da compra, um registro de pagamento será criado na página de PAGAMENTOS. ",-1),Nt=e("p",{class:"mt-1 text-sm leading-6 text-gray-600"},"Se algum pagamento de entrada (ou pagamento total) for realizado, registre aqui.",-1),Tt={class:"mt-10 grid grid-cols-1 gap-x-6 gap-y-8 sm:grid-cols-4"},Pt={class:"md:col-span-2 lg:col-span-1 text-gray-700"},Ft={class:"font-extrabold text-green-500"},Bt={class:"md:col-span-2 lg:col-span-1 text-gray-700"},zt={class:"font-extrabold text-green-500"},Jt={class:"md:col-span-2 lg:col-span-1 text-gray-700"},Qt={class:"font-extrabold text-green-500"},Wt={class:"md:col-span-2 lg:col-span-1 text-gray-700"},Gt={class:"font-extrabold text-green-500"},Xt={class:"sm:col-span-2"},Zt=e("label",{for:"sell-entry-value",class:"block text-sm font-medium leading-6 text-gray-900"},"Pagamento de entrada ",-1),Ht={class:"relative mt-2 rounded-md shadow-sm"},Kt=e("div",{class:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3"},[e("span",{class:"text-gray-500 sm:text-sm"},"R$")],-1),Yt=["disabled"],es={key:0,class:"text-red-500 text-sm"},ts={class:"relative mt-2 rounded-md shadow-sm"},ss=["disabled"],as=e("label",{for:"pay-all",class:"ml-3 text-sm text-neutral-500 select-none"},"Pagar agora",-1),ls={class:"sm:col-span-2"},os=e("label",{for:"sell-partial-value",class:"block text-sm font-medium leading-6 text-gray-900"},"Valor restante ",-1),ns={class:"relative mt-2 rounded-md shadow-sm"},is=e("div",{class:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3"},[e("span",{class:"text-gray-500 sm:text-sm"},"R$")],-1),ds=["value"],rs={key:0,class:"text-red-500 text-sm"},cs={__name:"CreateUpdateSellsModal",props:{modal:Object,sell:{type:Object,default:null},items:Array},emits:["close","submit"],setup(t,{emit:q}){const N=q,l=t,C=L(JSON.parse(JSON.stringify(l.items))),p=L(!1),R=/^\d{4}-\d{2}-\d{2}$/,A=U(()=>{const{client:o,date:a}=l.sell;return!o||!o.length?!1:a&&R.test(a)}),F=U(()=>{const{client:o,date:a,estimated_value:s,total_value:h,entry_value:x,items_list:T}=l.sell;return!o||!o.length||!a||!R.test(a)||!(s>0&&h>0&&x<=h)?!1:T.every(W=>W.quantity>0&&W.movement_quantity<=W.quantity)}),S=U(()=>l.sell.total_value-l.sell.entry_value),g=U(()=>l.modal.mode==="see"),I=L(""),z=L(!1);U(()=>C.value.filter(o=>o.name.toLowerCase().includes(I.value.toLowerCase())));const D=()=>{l.sell.estimated_value=l.sell.items_list.reduce((o,a)=>o+a.price*a.movement_quantity,0),d("estimated_value")},J=o=>{l.sell.items_list.push({id:o.id,name:o.name,quantity:o.quantity,max_quantity:o.max_quantity,min_quantity:o.min_quantity,movement_quantity:1,measurement_unit:o.measurement_unit.abbreviation,price:o.price,amount:o.price}),B(),I.value="",z.value=!1,D()},Q=o=>{l.sell.items_list=l.sell.items_list.filter(a=>a.id!==o),B(),D()},B=()=>{C.value=l.items.filter(o=>!l.sell.items_list.some(a=>a.id===o.id))},_=(o,a)=>{l.sell[a]=o.target.value,d(a)},r=(o,a)=>{const s=10**a;return Math.floor(o*s)/s},d=o=>{let{estimated_value:a,total_value:s,discount_percent:h,discount:x}=l.sell;switch(o){case"estimated_value":case"discount_percent":s=a*(1-h/100),x=a-s;break;case"total_value":x=a-s,h=x/a*100;break;case"discount":h=x/a*100,s=a-x;break}Object.assign(l.sell,{estimated_value:a,total_value:s,discount_percent:h,discount:x})},f=()=>{p.value?l.sell.entry_value=l.sell.total_value:l.sell.entry_value=0},w=()=>{l.sell.partialValue===0?p.value=!0:p.value=!1},O=o=>{J(o)},M=()=>{N("close")},E=()=>{N("submit")};return(o,a)=>(i(),j(de,{show:t.modal.show,maxWidth:A.value||g.value?"6xl":"2xl",onClose:M},{icon:V(()=>[e("div",{class:P(["mx-auto shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-blue-400 sm:mx-0 sm:h-10 sm:w-10",{"bg-yellow-400":t.modal.mode==="update","bg-green-400":t.modal.mode==="pay","bg-gray-400":t.modal.mode==="see"}])},[t.modal.mode==="create"?(i(),j(n(pe),{key:0,class:"w-5 h-5 text-white"})):m("",!0),t.modal.mode==="update"?(i(),j(n(_e),{key:1,class:"w-5 h-5 text-white"})):m("",!0),t.modal.mode==="pay"?(i(),j(n(le),{key:2,class:"w-5 h-5 text-white"})):m("",!0),t.modal.mode==="see"?(i(),j(n(K),{key:3,class:"w-5 h-5 text-white"})):m("",!0)],2)]),title:V(()=>[$(c(t.modal.title),1)]),content:V(()=>[e("form",{onSubmit:Y(E,["prevent"])},[e("div",xe,[e("section",ve,[fe,be,e("div",we,[e("div",$e,[ke,e("div",qe,[v(e("input",{type:"text",name:"sell-client",id:"sell-client",autocomplete:"on",class:"simple-input disabled:bg-gray-200",disabled:g.value,placeholder:"Nome do cliente","onUpdate:modelValue":a[0]||(a[0]=s=>t.sell.client=s),required:""},null,8,Ve),[[k,t.sell.client]]),t.sell.errors.client?(i(),u("p",Ce,c(t.sell.errors.client),1)):m("",!0)])]),e("div",Se,[Ie,e("div",De,[v(e("input",{type:"date",name:"sell-date",id:"sell-date",autocomplete:"on",class:"simple-input disabled:bg-gray-200",disabled:g.value,autofocus:"true",placeholder:"Data da Venda",max:n(X)(),"onUpdate:modelValue":a[1]||(a[1]=s=>t.sell.date=s),required:""},null,8,Oe),[[k,t.sell.date]]),t.sell.errors.date?(i(),u("p",Ue,c(t.sell.errors.date),1)):m("",!0)])]),e("div",Le,[Re,e("div",Ae,[v(e("textarea",{type:"text",observations:"sell-observations",id:"sell-observations",autocomplete:"on",class:"simple-input disabled:bg-gray-200",disabled:g.value,placeholder:"Descreva a título mais detalhadamente ou insira informações adicionais","onUpdate:modelValue":a[2]||(a[2]=s=>t.sell.observations=s)},null,8,Me),[[k,t.sell.observations]]),t.sell.errors.observations?(i(),u("p",Ee,c(t.sell.errors.observations),1)):m("",!0)])])])]),A.value||g.value?(i(),u("section",je,[Ne,Te,e("div",Pe,[g.value?m("",!0):(i(),u("div",Fe,[Be,e("div",ze,[y(ue,{options:t.items,"onUpdate:modelValue":O},null,8,["options"])])])),e("div",Je,[Qe,e("div",We,[Ge,v(e("input",{id:"sell-estimated-amount",type:"number",step:"0.01",min:"0",autocomplete:"off",readonly:"",class:"block w-full rounded-md border-0 py-1.5 pl-9 text-gray-900 ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-green-600 sm:text-sm sm:leading-6 disabled:bg-gray-200",placeholder:"Valor total estimado",disabled:!t.sell.items_list.length||g.value,"onUpdate:modelValue":a[3]||(a[3]=s=>t.sell.estimated_value=s),required:""},null,8,Xe),[[k,t.sell.estimated_value]]),t.sell.errors.estimated_value?(i(),u("p",Ze,c(t.sell.errors.estimated_value),1)):m("",!0)])]),e("div",He,[Ke,e("div",Ye,[et,e("input",{id:"sell-total-amount",type:"number",step:"0.01",min:"0",autocomplete:"off",class:"block w-full rounded-md border-0 py-1.5 pl-9 text-gray-900 ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-green-600 sm:text-sm sm:leading-6 disabled:bg-gray-200",placeholder:"Valor total estimado",disabled:!t.sell.items_list.length||g.value,value:r(t.sell.total_value,2),onInput:a[4]||(a[4]=s=>_(s,"total_value")),required:""},null,40,tt),t.sell.errors.total_value?(i(),u("p",st,c(t.sell.errors.total_value),1)):m("",!0)])]),e("div",at,[lt,e("div",ot,[e("input",{id:"sell-discount-percent",type:"number",step:"0.01",min:"0",autocomplete:"off",class:"block w-full rounded-md border-0 py-1.5 pr-9 text-gray-900 ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-green-600 sm:text-sm sm:leading-6 disabled:bg-gray-200",placeholder:"Valor total estimado",disabled:!t.sell.items_list.length||g.value,value:r(t.sell.discount_percent,3),onInput:a[5]||(a[5]=s=>_(s,"discount_percent")),required:""},null,40,nt),it,t.sell.errors.discount_percent?(i(),u("p",dt,c(t.sell.errors.discount_percent),1)):m("",!0)])]),e("div",rt,[ct,e("div",ut,[mt,e("input",{id:"sell-discount",type:"number",step:"0.01",min:"0",autocomplete:"off",class:"block w-full rounded-md border-0 py-1.5 pl-9 text-gray-900 ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-green-600 sm:text-sm sm:leading-6 disabled:bg-gray-200",placeholder:"Valor total estimado",disabled:!t.sell.items_list.length||g.value,value:r(t.sell.discount,2),onInput:a[6]||(a[6]=s=>_(s,"discount")),required:""},null,40,pt),t.sell.errors.discount?(i(),u("p",_t,c(t.sell.errors.discount),1)):m("",!0)])]),e("div",gt,[l.sell.items_list.length?(i(),u("table",ht,[e("thead",yt,[e("tr",null,[xt,vt,ft,bt,wt,$t,kt,t.modal.mode!=="see"?(i(),u("th",qt," Deletar")):m("",!0)])]),e("tbody",null,[(i(!0),u(G,null,H(l.sell.items_list,s=>(i(),u("tr",{key:s.id,class:P(["border-b transition duration-300 ease-in-out hover:bg-neutral-100 print:break-inside-avoid",{"bg-yellow-100":s.movement_quantity==s.quantity,"bg-red-100":s.movement_quantity>s.quantity}])},[e("td",Vt,c(s.id),1),e("td",Ct,c(s.name),1),e("td",{class:P(["whitespace-nowrap py-4 text-center font-medium",{"text-blue-500":s.quantity!=0&&s.quantity>=s.max_quantity,"text-green-500":s.quantity<s.max_quantity&&s.quantity>=s.min_quantity,"text-yellow-500":s.quantity<s.min_quantity&&s.quantity>0,"text-red-500":s.quantity==0}])},c(s.quantity),3),e("td",St,[e("input",{type:"number",min:"0.01",step:"0.01",value:s.movement_quantity,onInput:h=>{s.movement_quantity=h.target.value,s.amount=s.price*h.target.value,D()},class:"simple-input disabled:bg-gray-200 w-2/3",disabled:t.modal.mode!=="create"},null,40,It)]),e("td",Dt,c(s.measurement_unit),1),e("td",Ot,c(n(b)(s.price)),1),e("td",Ut,c(n(b)(s.amount?s.amount:10)),1),t.modal.mode!=="see"?(i(),u("td",Lt,[e("button",{onClick:h=>Q(s.id),title:"Remover "+s.name},"×",8,Rt)])):m("",!0)],2))),128))])])):(i(),u("p",At," Nenhum item selecionado até o momento!"))])])])):m("",!0),A.value&&t.sell.items_list.length&&t.modal.mode==="create"?(i(),u("section",Mt,[Et,jt,Nt,e("div",Tt,[e("div",Pt,[$("Valor estimado: "),e("span",Ft,c(n(b)(t.sell.estimated_value)),1)]),e("div",Bt,[$("Valor final: "),e("span",zt,c(n(b)(t.sell.total_value)),1)]),e("div",Jt,[$("Desconto (%): "),e("span",Qt,c(r(t.sell.discount_percent,3))+"%",1)]),e("div",Wt,[$("Desconto (R$): "),e("span",Gt,c(n(b)(t.sell.discount)),1)]),e("div",Xt,[Zt,e("div",Ht,[Kt,v(e("input",{id:"sell-entry-value",type:"number",step:"0.01",min:"0",autocomplete:"off",class:"block w-full rounded-md border-0 py-1.5 pl-9 text-gray-900 ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-green-600 sm:text-sm sm:leading-6 disabled:bg-gray-200",placeholder:"Valor de pagamneto de entrada",disabled:!t.sell.items_list.length||g.value,"onUpdate:modelValue":a[7]||(a[7]=s=>t.sell.entry_value=s),onInput:a[8]||(a[8]=s=>w()),required:""},null,40,Yt),[[k,t.sell.entry_value]]),t.sell.errors.entry_value?(i(),u("p",es,c(t.sell.errors.entry_value),1)):m("",!0)]),e("div",ts,[v(e("input",{type:"checkbox",id:"pay-all",class:"focus:bg-green-700 focus:ring-green-700 text-green-700 border-neutral-400 rounded-sm disabled:opacity-50","onUpdate:modelValue":a[9]||(a[9]=s=>p.value=s),onChange:a[10]||(a[10]=s=>f()),disabled:!t.sell.items_list.length||g.value},null,40,ss),[[ee,p.value]]),as])]),e("div",ls,[os,e("div",ns,[is,e("input",{id:"sell-partial-value",type:"number",step:"0.01",min:"0",autocomplete:"off",class:"block w-full rounded-md border-0 py-1.5 pl-9 text-gray-900 ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-green-600 sm:text-sm sm:leading-6 disabled:bg-gray-200",placeholder:"Valor restante para pagamento posterior",disabled:!0,value:r(S.value,2),readonly:"",required:""},null,8,ds),t.sell.errors.partial_value?(i(),u("p",rs,c(t.sell.errors.partial_value),1)):m("",!0)])])])])):m("",!0)])],32)]),footer:V(()=>[t.modal.mode!=="see"?(i(),j(ce,{key:0,class:P({disabled:t.sell.processing}),onClick:a[11]||(a[11]=s=>M())},{default:V(()=>[$(" Cancelar ")]),_:1},8,["class"])):m("",!0),y(re,{class:P({disabled:t.sell.processing||!F.value}),disabled:t.sell.processing||!F.value,onClick:a[12]||(a[12]=s=>E())},{default:V(()=>[$(c(t.modal.primary_button_txt),1)]),_:1},8,["class","disabled"])]),_:1},8,["show","maxWidth"]))}},us={class:"font-semibold text-xl text-gray-800 leading-tight"},ms={key:0},ps={class:"pt-12 print:hidden print:pt-0"},_s={class:"max-w-7xl mx-auto sm:px-6 lg:px-8 print:w-full"},gs={class:"bg-white overflow-hidden shadow-xl sm:rounded-lg p-5"},hs={class:"flex flex-row items-center space-x-3"},ys={class:"cursor-help select-none",title:"O campo de pesquisa ao lado filtra as informações carregadas na pagina. O formulário de pesquisa abaixo busca as informações filtradas no banco de dados e lista na página."},xs={class:"mt-3 grid grid-cols-3 gap-2"},vs={class:"col-span-3 md:col-span-1"},fs=e("label",{for:"search-by-entity-name",class:"block text-sm font-medium leading-6 text-gray-900"},"Cliente",-1),bs={class:"mt-2"},ws={key:0,class:"text-red-500 text-sm"},$s={class:"col-span-3 md:col-span-1"},ks=e("label",{for:"search-by-start-date",class:"block text-sm font-medium leading-6 text-gray-900"},"Data (início)",-1),qs={class:"mt-2"},Vs={key:0,class:"text-red-500 text-sm"},Cs={class:"col-span-3 md:col-span-1"},Ss=e("label",{for:"search-by-end-date",class:"block text-sm font-medium leading-6 text-gray-900"},"Data (fim)",-1),Is={class:"mt-2"},Ds={key:0,class:"text-red-500 text-sm"},Os=["href"],Us={class:"py-12 print:py-0"},Ls={class:"max-w-7xl mx-auto print:max-w-full"},Rs={class:"px-0 print:px-0"},As={class:"bg-white overflow-hidden shadow-xl sm:rounded-lg print:shadow-none"},Ms={class:"flex flex-col"},Es={class:"overflow-x-auto sm:-mx-6 lg:-mx-8"},js={class:"inline-block min-w-full py-2 sm:px-6 lg:px-8"},Ns={class:"overflow-hidden"},Ts={class:"min-w-full text-left text-sm font-light"},Ps=e("thead",{class:"border-b font-medium"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-4 text-center"},"#"),e("th",{scope:"col",class:"px-6 py-4 text-center"},"Cliente"),e("th",{scope:"col",class:"px-6 py-4 text-center"},"À pagar"),e("th",{scope:"col",class:"px-6 py-4 text-center"},"Valor total"),e("th",{scope:"col",class:"px-6 py-4 text-center"},"Data da Venda "),e("th",{scope:"col",class:"px-6 py-4 text-center print:hidden",colspan:"2"}," Ações")])],-1),Fs={class:"border-b transition duration-300 ease-in-out hover:bg-neutral-100 print:break-inside-avoid"},Bs={class:"whitespace-nowrap py-4 text-center font-medium"},zs={class:"whitespace-normal px-6 py-4 text-center trim"},Js=["title"],Qs={class:"whitespace-nowrap px-2 py-4 text-center"},Ws={class:"whitespace-nowrap px-2 py-4 text-center"},Gs={class:"whitespace-nowrap px-2 py-4 text-center"},Xs=["title","onClick"],Zs=["title","onClick"],Hs={key:1,class:"transition duration-300 ease-in-out hover:bg-neutral-100 print:break-inside-avoid"},Ks=e("td",{class:"whitespace-nowrap px-6 py-4 text-center",colspan:"9"},"Não há vendas cadastradas no momento!",-1),Ys=[Ks],ya={__name:"Sells",props:{page:Object,page_options:{type:Array,default:null},sells_list:Object,items:Object,parameters:Object},setup(t){const q=t,N=te.useToast(),l=Z({id:null,client:"",date:X(),estimated_value:0,total_value:0,partial_value:0,discount_percent:0,discount:0,entry_value:0,observations:"",items_list:[]}),C=L(!1),p=Z({entity_name:q.parameters.entity_name,start_date:q.parameters.start_date,end_date:q.parameters.end_date}),R=L(""),A=U(()=>{const _=R.value.toLowerCase();return q.sells_list.filter(r=>{var h,x;const{id:d,entity_name:f,observations:w,date:O,accounting:M,items:E}=r,{total_value:o,partial_value:a}=M,s=[d.toString(),(f==null?void 0:f.toLowerCase())??"",(w==null?void 0:w.toLowerCase())??"",(O==null?void 0:O.toLowerCase())??"",((h=b(o))==null?void 0:h.toLowerCase())??"",((x=b(a))==null?void 0:x.toLowerCase())??""];for(let T of s)if(T.includes(_))return!0;return E.some(T=>T.name.toLowerCase().includes(_))})}),F=U(()=>q.sells_list.reduce((_,r)=>_+r.accounting.partial_value,0)),S=L({mode:"create",show:!1,get title(){switch(this.mode){case"create":return"Criar venda";case"update":return"Editar venda";case"see":return"Ver informações da venda"}},get primary_button_txt(){switch(this.mode){case"create":return"Cadastrar";case"update":return"Atualizar";case"see":return"Fechar"}}}),g=(_,r=null)=>{const d=["update","see"].includes(_);if(r!==null&&d){const f=q.sells_list.find(w=>w.id===r);if(f){const{id:w,entity_name:O,date:M,observations:E,accounting:o,items:a}=f;l.id=w,l.client=O,l.date=M,l.estimated_value=o.estimated_value,l.total_value=o.total_value,l.partial_value=o.partial_value,l.entry_value=0,l.discount=o.estimated_value-o.total_value,l.discount_percent=l.discount/(o.estimated_value||1)*100,l.observations=E,l.items_list=a}}S.value.mode=_,S.value.show=!0},I=()=>{l.reset(),S.value.show=!1},z=()=>{l.post(route("sells.store"),{preserveScroll:!0,onSuccess:()=>I(),onError:_=>{console.log(_)}})},D=()=>{p.post(route("sells.filter"),{preserveScroll:!0})},J=()=>{l.put(route("sells.update",l.id),{preserveScroll:!0,onSuccess:()=>I()})},Q=(_,r)=>{confirm(`Você tem certeza que deseja excluir a venda de material para "${r}"? Todos os materiais comprados voltarão para o estoque! Esta ação não poderá ser desfeita!`)&&l.delete(route("sells.destroy",_),{preserveScroll:!0,onSuccess:()=>N.success("Venda deletado com sucesso!")})},B=()=>{switch(S.value.mode){case"create":return z();case"update":return J();case"see":return I();default:N.error("Método desconhecido. Informar o Técnico.")}};return(_,r)=>(i(),u(G,null,[y(n(se),{class:"print:hidden",title:t.page.name},null,8,["title"]),y(ie,{page:t.page,page_options:t.page_options},{header:V(()=>[e("h2",us,[$(c(t.page.name)+" ",1),_.$page.props.auth.user.hierarchy<2?(i(),u("span",ms,"| "+c(n(b)(F.value)),1)):m("",!0)]),y(he,{icon:"plus",onClick:r[0]||(r[0]=d=>g("create")),title:"Cadastrar Sell",class:"print:hidden"})]),default:V(()=>[e("div",ps,[e("div",_s,[e("div",gs,[e("div",hs,[y(n(ye),{class:"w-5 y-5"}),v(e("input",{type:"text",name:"search_term",id:"search_term",autocomplete:"on",class:"simple-input",autofocus:"true",placeholder:"Pesquisar termo...","onUpdate:modelValue":r[1]||(r[1]=d=>R.value=d)},null,512),[[k,R.value]]),e("span",ys,[y(n(me),{class:"w-5 h-5"})]),C.value?(i(),u("span",{key:1,class:"select-none cursor-pointer",title:"Fechar opções de filtro",onClick:r[3]||(r[3]=d=>C.value=!1)},[y(n(ne),{class:"w-5 y-5"})])):(i(),u("span",{key:0,class:"select-none cursor-pointer",title:"Abrir opções de filtro",onClick:r[2]||(r[2]=d=>C.value=!0)},[y(n(oe),{class:"w-5 y-5"})]))]),v(e("div",xs,[e("div",vs,[fs,e("div",bs,[v(e("input",{type:"text",name:"search-by-entity-name",id:"search-by-entity-name",class:"simple-input disabled:bg-gray-200",placeholder:"Filtrar por nome do cliente","onUpdate:modelValue":r[4]||(r[4]=d=>n(p).entity_name=d),onInput:D,required:""},null,544),[[k,n(p).entity_name]]),n(p).errors.entity_name?(i(),u("p",ws,c(n(p).errors.entity_name),1)):m("",!0)])]),e("div",$s,[ks,e("div",qs,[v(e("input",{type:"date",name:"search-by-start-date",id:"search-by-start-date",class:"simple-input disabled:bg-gray-200",placeholder:"Filtrar por período (início)","onUpdate:modelValue":r[5]||(r[5]=d=>n(p).start_date=d),onInput:D,required:""},null,544),[[k,n(p).start_date]]),n(p).errors.start_date?(i(),u("p",Vs,c(n(p).errors.start_date),1)):m("",!0)])]),e("div",Cs,[Ss,e("div",Is,[v(e("input",{type:"date",name:"search-by-end-date",id:"search-by-end-date",class:"simple-input disabled:bg-gray-200",placeholder:"Filtrar por período (fim)","onUpdate:modelValue":r[6]||(r[6]=d=>n(p).end_date=d),onInput:D,required:""},null,544),[[k,n(p).end_date]]),n(p).errors.end_date?(i(),u("p",Ds,c(n(p).errors.end_date),1)):m("",!0)])]),e("a",{href:_.route("sells.index"),class:"text-red-500 hover:text-red-700 active:text-red-900 text-sm select-none mt-2",onClick:r[7]||(r[7]=d=>n(p).reset())},"Resetar busca",8,Os)],512),[[ae,C.value]])])])]),e("div",Us,[e("div",Ls,[e("div",Rs,[e("div",As,[e("div",Ms,[e("div",Es,[e("div",js,[e("div",Ns,[e("table",Ts,[Ps,e("tbody",null,[A.value.length?(i(!0),u(G,{key:0},H(A.value,d=>(i(),u("tr",Fs,[e("td",Bs,c(d.id),1),e("td",zs,[$(c(d.entity_name)+" ",1),d.observations?(i(),u("span",{key:0,title:d.observations,class:"inline-flex items-center rounded-md bg-gray-50 px-2 py-1 text-xs font-medium text-gray-600 ring-1 ring-inset ring-gray-500/10 cursor-help"},"OBS",8,Js)):m("",!0)]),e("td",Qs,c(n(b)(d.accounting.partial_value)),1),e("td",Ws,c(d.accounting.total_value>0?n(b)(d.accounting.total_value):"Pago"),1),e("td",Gs,c(n(X)(d.date,!0)),1),e("td",{class:"whitespace-nowrap px-4 py-4 text-center cursor-pointer hover:text-indigo-700 active:text-indigo-900 select-none print:hidden",title:"VER: Compra de "+d.entity_name,onClick:f=>g("see",d.id)},[y(n(K),{class:"w-5 h-5 m-auto"})],8,Xs),e("td",{class:"whitespace-nowrap px-4 py-4 text-center cursor-pointer hover:text-red-700 active:text-red-900 select-none print:hidden",title:"EXCLUIR: Compra de "+d.entity_name,onClick:f=>Q(d.id,d.entity_name)},[y(n(ge),{class:"w-5 h-5 m-auto"})],8,Zs)]))),256)):(i(),u("tr",Hs,Ys))])])])])])])])])])]),y(cs,{modal:S.value,sell:n(l),items:t.items,onSubmit:B,onClose:I},null,8,["modal","sell","items"])]),_:1},8,["page","page_options"])],64))}};export{ya as default};
