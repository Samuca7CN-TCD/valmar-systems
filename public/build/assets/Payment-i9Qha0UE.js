import{m as X,T as M,d as g,l as k,e as a,o as r,b as p,u as l,Z,w as V,a as e,q as L,v as H,E as J,f as c,F as T,h as K,n as Q,t as d,g as C}from"./app-BFxaF4G7.js";import{r as W,_ as Y}from"./AppLayout-CJldedpQ.js";import{_ as ee}from"./CreateUpdatePayModal-DZhnif6m.js";import{_ as te}from"./FloatButton-BBUpF2Fy.js";import{_ as se}from"./ExtraOptionsButton-D5-BUO_U.js";import{t as h,f as j}from"./general-ILD4i3rA.js";/* empty css                    */import{r as oe}from"./MagnifyingGlassIcon-CI_tOXrM.js";import{r as ae,a as re}from"./XMarkIcon-Bu3932Y3.js";import"./CreateUpdateModal-BJ2MGO-9.js";import"./Modal-AoLap7Zs.js";import"./PrimaryButton-CWfdoqT9.js";import"./SecondaryButton-DRAXVd-X.js";import"./PlusIcon-MJV1_ixn.js";import"./PrinterIcon-DxrN6vNb.js";import"./ArrowUturnLeftIcon-CQTtVK5Y.js";const ne={class:"font-semibold text-xl text-gray-800 leading-tight"},ie={key:0},ce={key:1,class:"text-neutral-400"},le=e("span",{class:"text-xs"}," (pagamentos + serviços)",-1),de={class:"pt-12 print:hidden"},pe={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},ue={class:"bg-white overflow-hidden shadow-xl sm:rounded-lg p-5"},_e={class:"flex flex-row items-center space-x-3"},he={class:"ml-8 mt-1"},me=["checked"],xe=e("label",{for:"show-services",class:"ml-3 text-xs text-neutral-500 select-none"},"Mostrar serviços",-1),ve={class:"py-12 print:py-0"},ye={class:"max-w-7xl mx-auto print:max-w-full"},we={class:"w-full flex justify-end pb-3 print:hidden"},ge={class:"px-0 print:px-0"},fe={class:"bg-white overflow-hidden shadow-xl sm:rounded-lg print:shadow-none"},be={class:"flex flex-col"},ke={class:"overflow-x-auto sm:-mx-6 lg:-mx-8"},Ce={class:"inline-block min-w-full py-2 sm:px-6 lg:px-8"},$e={class:"overflow-hidden"},Pe={class:"w-full text-left text-sm font-light"},Se={class:"border-b font-medium"},Ee=e("th",{scope:"col",class:"px-6 py-4 text-center"},"#",-1),Me=e("th",{scope:"col",class:"px-6 py-4 text-center"},"Dívida",-1),Ve=e("th",{scope:"col",class:"px-6 py-4 text-center"},"Devedor",-1),Le=e("th",{scope:"col",class:"px-6 py-4 text-center"},"À pagar",-1),Te=e("th",{scope:"col",class:"px-6 py-4 text-center"},"Valor total",-1),je=e("th",{scope:"col",class:"px-6 py-4 text-center print:hidden"},"Pagar ",-1),De=e("th",{scope:"col",class:"px-6 py-4 text-center print:hidden"},"Editar ",-1),Ae=e("th",{scope:"col",class:"px-6 py-4 text-center print:hidden"},"Excluir ",-1),Be={key:0,scope:"col",class:"px-6 py-4 text-center print:hidden"},Ne={key:1,scope:"col",class:"px-6 py-4 text-center print:hidden"},Oe={key:2,scope:"col",class:"px-6 py-4 text-center print:hidden"},Ue={key:3,scope:"col",class:"px-6 py-4 text-center print:hidden"},qe={class:"whitespace-nowrap py-4 text-center font-medium"},ze={class:"break-words px-6 py-4 text-center"},Ie=["title"],Re={class:"whitespace-normal px-6 py-4 text-center"},Fe={class:"whitespace-nowrap px-2 py-4 text-center"},Ge={class:"whitespace-nowrap px-2 py-4 text-center"},Xe=["title","onClick"],Ze=["title","onClick"],He=["title","onClick"],Je={key:1,class:"whitespace-nowrap px-4 py-4 text-center select-none print:hidden"},Ke={key:2,class:"whitespace-nowrap px-2 py-4 text-center print:hidden"},Qe={key:3,class:"whitespace-nowrap px-2 py-4 text-center print:hidden"},We={key:4,class:"whitespace-nowrap px-2 py-4 text-center print:hidden"},Ye={key:5,class:"whitespace-nowrap px-2 py-4 text-center print:hidden"},et={key:1,class:"transition duration-300 ease-in-out hover:bg-neutral-100 print:break-inside-avoid"},tt=e("td",{class:"whitespace-nowrap px-6 py-4 text-center",colspan:"9"},"Não há pagamentos cadastrados no momento!",-1),st=[tt],wt={__name:"Payment",props:{page:Object,page_options:{type:Array,default:null},payments_list:Object},setup(m){const v=m,$=X.useToast(),n=M({id:null,debt:"",debtor:"",total_value:0,partial_value:0,observations:"",records_list:{enable_records:!1,data:[]}}),f=g(""),y=g(!0),i=g(!1),P=k(()=>{const o=f.value.toLowerCase();return v.payments_list.filter(s=>s.motive.toLowerCase().includes(o)||s.entity_name.toLowerCase().includes(o)||h(s.accounting.total_value).toString().toLowerCase().includes(o)||h(s.accounting.partial_value).toString().toLowerCase().includes(o))}),D=k(()=>v.payments_list.reduce((o,s)=>o+s.accounting.partial_value,0)),A=k(()=>v.payments_list.filter(o=>o.type!==1).reduce((o,s)=>o+s.accounting.partial_value,0)),u=g({mode:"create",show:!1,get title(){switch(this.mode){case"create":return"Criar pagamento";case"update":return"Editar pagamento";case"pay":return"Pagar pagamento"}},get primary_button_txt(){switch(this.mode){case"create":return"Cadastrar";case"update":return"Atualizar";case"pay":return"Pagar"}}}),b=(o,s=null)=>{const t=["update","pay"].includes(o);if(s!==null&&t){const x=v.payments_list.find(_=>_.id===s);if(x){const{id:_,type:z,motive:I,entity_name:R,observations:F,records:S,accounting:E}=x;n.id=_,n.type=z,n.debt=I,n.debtor=R,n.total_value=E.total_value,n.partial_value=E.partial_value,n.observations=F,n.records_list.enable_records=!!S.length,n.records_list.data=S.map(G=>M(G))}}u.value.mode=o,u.value.show=!0},w=()=>{n.reset(),u.value.show=!1},B=()=>{n.post(route("payments.store"),{preserveScroll:!0,onSuccess:()=>w(),onError:o=>{console.log(o)}})},N=()=>{n.put(route("payments.update",n.id),{preserveScroll:!0,onSuccess:()=>w()})},O=()=>{n.put(route("payments.pay",n.id),{preserveScroll:!0,onSuccess:()=>w(),onError:o=>{console.log(o)}})},U=(o,s)=>{confirm(`Você tem certeza que deseja excluir o pagamento "${s}"? Esta ação não poderá ser desfeita!`)&&n.delete(route("payments.destroy",o),{preserveScroll:!0,onSuccess:()=>$.success("Pagamento deletado com sucesso!")})},q=()=>{switch(u.value.mode){case"create":return B();case"update":return N();case"pay":return O();default:$.error("Método desconhecido. Informar o Técnico.")}};return(o,s)=>(r(),a(T,null,[p(l(Z),{title:m.page.name},null,8,["title"]),p(Y,{page:m.page,page_options:m.page_options},{header:V(()=>[e("h2",ne,[C(d(m.page.name)+" ",1),o.$page.props.auth.user.hierarchy<2?(r(),a("span",ie,"| "+d(l(h)(A.value)),1)):c("",!0),o.$page.props.auth.user.hierarchy<2?(r(),a("span",ce,[C(" | "+d(l(h)(D.value))+" ",1),le])):c("",!0)]),p(te,{icon:"plus",onClick:s[0]||(s[0]=t=>b("create")),title:"Cadastrar Payment",class:"print:hidden"})]),default:V(()=>[e("div",de,[e("div",pe,[e("div",ue,[e("div",_e,[p(l(oe),{class:"w-5 y-5"}),L(e("input",{type:"text",name:"search_term",id:"search_term",autocomplete:"on",class:"simple-input",autofocus:"true",placeholder:"Pesquisar termo...","onUpdate:modelValue":s[1]||(s[1]=t=>f.value=t)},null,512),[[H,f.value]])]),e("div",he,[L(e("input",{type:"checkbox",id:"show-services",class:"focus:ring-green-700 text-green-700 border-neutral-500 rounded-sm disabled:opacity-50","onUpdate:modelValue":s[2]||(s[2]=t=>y.value=t),checked:y.value},null,8,me),[[J,y.value]]),xe])])])]),e("div",ve,[e("div",ye,[e("div",we,[i.value?c("",!0):(r(),a("button",{key:0,class:"text-blue-500 text-xs justify-end",onClick:s[3]||(s[3]=t=>i.value=!i.value)},"Mostrar dados de usuário")),i.value?(r(),a("button",{key:1,class:"text-red-500 text-xs justify-end",onClick:s[4]||(s[4]=t=>i.value=!i.value)},"Esconder dados de usuário")):c("",!0)]),e("div",ge,[e("div",fe,[e("div",be,[e("div",ke,[e("div",Ce,[e("div",$e,[e("table",Pe,[e("thead",Se,[e("tr",null,[Ee,Me,Ve,Le,Te,je,De,Ae,i.value?(r(),a("th",Be,"Criado em")):c("",!0),i.value?(r(),a("th",Ne,"Criado por")):c("",!0),i.value?(r(),a("th",Oe," Modificado em")):c("",!0),i.value?(r(),a("th",Ue," Modificado por ")):c("",!0)])]),e("tbody",null,[P.value.length?(r(!0),a(T,{key:0},K(P.value,t=>{var x;return r(),a("tr",{class:Q(["border-b transition duration-300 ease-in-out hover:bg-neutral-100 print:break-inside-avoid",{hidden:t.type===1&&y.value===!1}])},[e("td",qe,d(t.id),1),e("td",ze,[C(d(t.motive)+" ",1),t.observations?(r(),a("span",{key:0,title:t.observations,class:"inline-flex items-center rounded-md bg-gray-50 px-2 py-1 text-xs font-medium text-gray-600 ring-1 ring-inset ring-gray-500/10 cursor-help"},"OBS",8,Ie)):c("",!0)]),e("td",Re,d(t.entity_name),1),e("td",Fe,d(l(h)(t.accounting.partial_value)),1),e("td",Ge,d(l(h)(t.accounting.total_value)),1),e("td",{class:"whitespace-nowrap px-4 py-4 text-center cursor-pointer hover:text-green-700 active:text-green-900 select-none print:hidden",title:"PAGAR: "+t.motive+"("+t.entity_name+")",onClick:_=>b("pay",t.id)},[p(l(W),{class:"w-5 h-5 m-auto"})],8,Xe),e("td",{class:"whitespace-nowrap px-4 py-4 text-center cursor-pointer hover:text-yellow-700 active:text-yellow-900 select-none print:hidden",title:"EDITAR: "+t.motive+"("+t.entity_name+")",onClick:_=>b("update",t.id)},[p(l(ae),{class:"w-5 h-5 m-auto"})],8,Ze),t.type!==2?(r(),a("td",{key:0,class:"whitespace-nowrap px-4 py-4 text-center cursor-pointer hover:text-red-700 active:text-red-900 select-none print:hidden",title:"EXCLUIR: "+t.motive+"("+t.entity_name+")",onClick:_=>U(t.id,t.motive)},[p(l(re),{class:"w-5 h-5 m-auto"})],8,He)):(r(),a("td",Je," Venda ")),i.value?(r(),a("td",Ke,d(l(j)(t.created_at,"reading_date_time")),1)):c("",!0),i.value?(r(),a("td",Qe,d(t.procedures[0].user.name),1)):c("",!0),i.value?(r(),a("td",We,d(l(j)(t.updated_at,"reading_date_time")),1)):c("",!0),i.value?(r(),a("td",Ye,d(t.procedures[((x=t.procedures)==null?void 0:x.length)-1].user.name),1)):c("",!0)],2)}),256)):(r(),a("tr",et,st))])])])])])])])])])]),p(ee,{show:u.value.show,modal:u.value,payment:l(n),onSubmit:q,onClose:w},null,8,["show","modal","payment"]),p(se,{mode:["rollup","print_page","link"],link_type:["previous"],link:[o.route("payments.previous")]},null,8,["link"])]),_:1},8,["page","page_options"])],64))}};export{wt as default};
