import{l as p,T as M,d as O,o as s,c as f,w as x,a as e,n as w,u as i,h as l,f as q,t as c,i as P,q as y,v as b,e as d,F as S,g as F,b as C}from"./app-DdquKXfZ.js";import{_ as L}from"./CreateUpdateModal-CtVS32Jf.js";import{_ as G}from"./PrimaryButton-DUFH0Jag.js";import{_ as H}from"./SecondaryButton-BsBTKx1w.js";import{f as _,t as k}from"./general-f63YF4ZR.js";import{r as J}from"./PlusIcon-CUJ6-0d9.js";import{r as K,a as Q}from"./XMarkIcon-DuIn1Nhf.js";import{r as W}from"./AppLayout-C7GMpQlH.js";const X={class:"pb-12 space-y-12 divide-y-2"},Y={class:"py-4"},Z=e("h2",{class:"text-base font-semibold leading-7 text-gray-900"},"Informações Básicas",-1),ee=e("p",{class:"mt-1 text-sm leading-6 text-gray-600"},"Informações sobre o redistro de pagamento como devedor, dívida e valor total da dívida",-1),te={class:"mt-10 grid grid-cols-1 gap-x-6 gap-y-8 sm:grid-cols-6"},ae={class:"sm:col-span-6"},se=e("label",{for:"payment-debt",class:"block text-sm font-medium leading-6 text-gray-900 required-input-label"},"Dívida",-1),oe={class:"mt-2"},de=["disabled"],ne={key:0,class:"text-red-500 text-sm"},re={class:"sm:col-span-3"},le=e("label",{for:"payment-debtor",class:"block text-sm font-medium leading-6 text-gray-900 required-input-label"},"Devedor",-1),ie={class:"mt-2"},ce=["disabled"],me={key:0,class:"text-red-500 text-sm"},ue={class:"sm:col-span-3"},pe=e("label",{for:"payment-total-amount",class:"block text-sm font-medium leading-6 text-gray-900 required-input-label"},"Valor total",-1),ye={class:"mt-2"},be=["disabled"],ge={key:0,class:"text-red-500 text-sm"},xe={class:"sm:col-span-6"},_e=e("label",{for:"payment-observations",class:"block text-sm font-medium leading-6 text-gray-900"},"Observações",-1),ve={class:"mt-2"},he=["disabled"],fe={key:0,class:"text-red-500 text-sm"},we={key:0,class:"py-4"},ke={class:"sm:col-span-6"},Ve=["title"],De={class:"flex h-6 items-center"},$e=["disabled"],qe={class:"text-sm leading-6"},Ce={key:1,class:"py-4"},Ue={key:0},Re=e("h2",{class:"text-base font-semibold leading-7 text-gray-900"},"Pagamentos concluídos",-1),ze=e("p",{class:"mt-1 text-sm leading-6 text-gray-600"},"Insira o adiantamento ou os pagamentos parciais já realizando desta dívida",-1),Te=[Re,ze],je={key:1},Ne=e("h2",{class:"text-base font-semibold leading-7 text-gray-900"},"Lista de pagamentos concluídos ",-1),Ae=e("p",{class:"mt-1 text-sm leading-6 text-gray-600"},"Abaixo está listado os registros de pagamentos realizados. Para adicionar novos pagamentos, ou remover algum pagamento existente, entre na seção de pagamento.",-1),Be=[Ne,Ae],Ee={key:2},Ie=e("h2",{class:"text-base font-semibold leading-7 text-gray-900"},"Realize um novo pagamento",-1),Me=e("p",{class:"mt-1 text-sm leading-6 text-gray-600"},"Adicione um pagamento ou remova um pagamento existente.",-1),Oe=[Ie,Me],Pe={key:3,class:"mt-10 grid grid-cols-1 gap-x-6 gap-y-4 sm:grid-cols-6"},Se={class:"col-span-3"},Fe=e("label",{for:"record-amount",class:"block text-sm font-medium leading-6 text-gray-900 required-input-label"},"Valor (R$)",-1),Le={class:"mt-2"},Ge=["max","disabled"],He={class:"text-gray-400 text-xs py-1"},Je={key:0,class:"text-red-500 text-sm"},Ke={class:"sm:col-span-3"},Qe=e("label",{for:"record-date",class:"block text-sm font-medium leading-6 text-gray-900 required-input-label"},"Data do pagamento",-1),We={class:"mt-2"},Xe=["max","disabled"],Ye=e("p",{class:"text-gray-400 text-xs py-1"},"Não aceita datas no futuro",-1),Ze={key:0,class:"text-red-500 text-sm"},et={key:4,class:"w-full py-5 flex justify-end"},tt=["disabled"],at={key:5,class:"flex flex-col"},st={class:"overflow-x-auto sm:-mx-6 lg:-mx-8"},ot={class:"inline-block min-w-full py-2 sm:px-6 lg:px-8"},dt={class:"overflow-hidden"},nt={class:"min-w-full text-left text-sm font-light"},rt={class:"border-b bg-white font-medium"},lt=e("th",{scope:"col",class:"px-6 py-4 text-center"},"Valor",-1),it=e("th",{scope:"col",class:"px-6 py-4 text-center"},"Data",-1),ct={key:0,scope:"col",class:"px-6 py-4 text-center"},mt={class:"border-b bg-white"},ut={class:"whitespace-nowrap px-6 text-center"},pt={key:0,class:"w-full relative flex flex-wrap items-stretch"},yt=e("span",{class:"w-1/4 select-none flex items-center whitespace-nowrap rounded-l border border-r-0 border-solid border-neutral-300 px-3 py-[0.25rem] text-center text-xs font-normal leading-[1.6] text-neutral-700",id:"basic-addon1"},"R$",-1),bt=["max","onUpdate:modelValue"],gt={key:1},xt={class:"whitespace-nowrap px-6 py-4 text-center"},_t={key:0,class:"w-full relative flex flex-wrap items-stretch"},vt=["max","onUpdate:modelValue"],ht={key:1},ft={key:0,class:"whitespace-nowrap px-6 py-4 select-none"},wt={key:1,class:"text-red-500 text-sm"},kt={key:2,class:"text-red-500 text-sm"},Vt={key:0,class:"text-red-500 text-sm py-5 text-center"},Dt={key:1,class:"text-red-500 text-sm py-5 text-center"},$t={key:2,class:"text-red-500 text-sm py-5 text-center"},qt={key:6,class:"py-5 text-gray-400 text-center"},Bt={__name:"CreateUpdatePayModal",props:{modal:Object,payment:{type:Object,default:null}},emits:["close","submit"],setup(t,{emit:j}){const U=j,n=t,N=p(()=>n.payment.records_list.data.length+1),u=p(()=>R&&n.payment.total_value-n.payment.records_list.data.reduce((m,o)=>m+o.amount,0)),V=p(()=>{const m=new Date;return n.payment.records_list.data.some(o=>new Date(o.date)>m)}),D=p(()=>n.payment.records_list.data.some(m=>m.amount<=0)),A=p(()=>n.payment.records_list.data.sort((m,o)=>new Date(m.date)-new Date(o.date))),g=p(()=>["pay","see"].includes(n.modal.mode)),R=p(()=>n.modal.mode!=="create"||n.payment.records_list.enable_records),v=p(()=>n.payment.debt.length&&n.payment.debtor.length&&n.payment.total_value>0),r=M({id:N,amount:0,past:!1,register_date:_(),filepath:null}),z=O(!1),B=()=>{if(n.payment.records_list.enable_records&&n.payment.records_list.data.length)if(confirm("Tem certeza que deseja desmarcar? Todos os registros serão excluídos!"))n.payment.records_list.data.length=[],r.reset();else return;n.payment.records_list.enable_records=!n.payment.records_list.enable_records},E=()=>{if(!r.amount||r.amount>u.value){r.errors.amount=`O valor do registro deve ser maior que R$ 0,00 e menor que ${k(u.value)}`;return}if(r.errors.amount="",!r.register_date||new Date(r.register_date)>new Date){r.errors.date=`A data do registro deve ser menor ou igual a ${_()}`;return}r.errors.date="",z.value||(r.filepath=null),n.payment.records_list.data.push({...r}),z.value=!1,r.reset()},I=(m,o=null)=>{if(n.modal.mode==="create"){n.payment.records_list.data=n.payment.records_list.data.filter(a=>a.id!==m);return}else confirm("Você tem certeza que deseja excluir esse registro? (Essa ação não pode ser desfeita)")&&o.delete(route("records.destroy",m),{preserveScroll:!0,onSuccess:()=>{n.payment.records_list.data=n.payment.records_list.data.filter(a=>a.id!==m)}})},$=()=>{U("close")},T=()=>{U("submit")};return(m,o)=>(s(),f(L,{show:t.modal.show,onClose:$},{icon:x(()=>[e("div",{class:w(["mx-auto shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-blue-400 sm:mx-0 sm:h-10 sm:w-10",{"bg-yellow-400":t.modal.mode==="update","bg-green-400":t.modal.mode==="pay"}])},[t.modal.mode==="create"?(s(),f(i(J),{key:0,class:"w-5 h-5 text-white"})):l("",!0),t.modal.mode==="update"?(s(),f(i(K),{key:1,class:"w-5 h-5 text-white"})):l("",!0),t.modal.mode==="pay"?(s(),f(i(W),{key:2,class:"w-5 h-5 text-white"})):l("",!0)],2)]),title:x(()=>[q(c(t.modal.title),1)]),content:x(()=>[e("form",{onSubmit:P(T,["prevent"])},[e("div",X,[e("section",Y,[Z,ee,e("div",te,[e("div",ae,[se,e("div",oe,[y(e("input",{type:"text",name:"payment-debt",id:"payment-debt",autocomplete:"on",class:"simple-input disabled:bg-gray-200",autofocus:"true",placeholder:"Título da dívida",disabled:g.value||t.payment.type===2,"onUpdate:modelValue":o[0]||(o[0]=a=>t.payment.debt=a),required:""},null,8,de),[[b,t.payment.debt]]),t.payment.errors.debt?(s(),d("p",ne,c(t.payment.errors.debt),1)):l("",!0)])]),e("div",re,[le,e("div",ie,[y(e("input",{type:"text",name:"payment-debtor",id:"payment-debtor",autocomplete:"on",class:"simple-input disabled:bg-gray-200",placeholder:"Nome do devedor",disabled:g.value,"onUpdate:modelValue":o[1]||(o[1]=a=>t.payment.debtor=a),required:""},null,8,ce),[[b,t.payment.debtor]]),t.payment.errors.debtor?(s(),d("p",me,c(t.payment.errors.debtor),1)):l("",!0)])]),e("div",ue,[pe,e("div",ye,[y(e("input",{id:"payment-total-amount",name:"payment-total-amount",type:"number",step:"0.01",min:"0",autocomplete:"off",class:"simple-input disabled:bg-gray-200",placeholder:"Valor total inicial da dívida",disabled:g.value,"onUpdate:modelValue":o[2]||(o[2]=a=>t.payment.total_value=a),required:""},null,8,be),[[b,t.payment.total_value]]),t.payment.errors.total_value?(s(),d("p",ge,c(t.payment.errors.total_value),1)):l("",!0)])]),e("div",xe,[_e,e("div",ve,[y(e("textarea",{type:"text",observations:"payment-observations",id:"payment-observations",autocomplete:"on",class:"simple-input disabled:bg-gray-200",placeholder:"Descreva a dívida mais detalhadamente ou insira informações adicionais",disabled:g.value,"onUpdate:modelValue":o[3]||(o[3]=a=>t.payment.observations=a)},null,8,he),[[b,t.payment.observations]]),t.payment.errors.observations?(s(),d("p",fe,c(t.payment.errors.observations),1)):l("",!0)])])])]),t.modal.mode==="create"?(s(),d("section",we,[e("div",ke,[e("div",{class:"mt-2 relative flex gap-x-3",title:v.value?"":"Preencha ao menos a dívida, o devedor e o valor total."},[e("div",De,[e("input",{id:"payment-enable-records",name:"payment-enable-records",type:"checkbox",onChange:o[4]||(o[4]=a=>B()),disabled:!v.value,class:"h-4 w-4 rounded border-gray-300 text-green-600 focus:ring-green-600 disabled:border-gray-100 disabled:text-green-200 disabled:bg-gray-300"},null,40,$e)]),e("div",qe,[e("label",{for:"payment-enable-records",class:w(["font-medium text-gray-900 select-none cursor-pointer",{"text-gray-300":!v.value,"cursor-not-allowed":!v.value}])},"Adicionar pagamentos concluídos",2)])],8,Ve)])])):l("",!0),R.value?(s(),d("section",Ce,[t.modal.mode==="create"?(s(),d("div",Ue,Te)):l("",!0),t.modal.mode==="update"?(s(),d("div",je,Be)):l("",!0),t.modal.mode==="pay"?(s(),d("div",Ee,Oe)):l("",!0),t.modal.mode!=="update"?(s(),d("div",Pe,[e("div",Se,[Fe,e("div",Le,[y(e("input",{id:"record-amount",name:"record-amount",type:"number",step:"0.01",min:"0",max:u.value,autocomplete:"off",class:"simple-input disabled:bg-gray-200 disabled:opacity-75",disabled:u.value==0,placeholder:"Valor do pagamento parcial","onUpdate:modelValue":o[5]||(o[5]=a=>i(r).amount=a)},null,8,Ge),[[b,i(r).amount]]),e("p",He,"Valor Restante:y "+c(i(k)(u.value)),1),i(r).errors.amount?(s(),d("p",Je,c(i(r).errors.amount),1)):l("",!0)])]),e("div",Ke,[Qe,e("div",We,[y(e("input",{id:"record-date",name:"record-date",type:"date",max:i(_)(),autocomplete:"off",class:"simple-input disabled:bg-gray-200",disabled:u.value==0,placeholder:"Data de pagamento do valor parcial","onUpdate:modelValue":o[6]||(o[6]=a=>i(r).register_date=a)},null,8,Xe),[[b,i(r).register_date]]),Ye,i(r).errors.date?(s(),d("p",Ze,c(i(r).errors.date),1)):l("",!0)])])])):l("",!0),t.modal.mode!=="update"?(s(),d("div",et,[e("button",{type:"button",class:"w-full px-4 py-2 bg-blue-600 border border-gray-300 rounded-md font-semibold text-xs text-white uppercase tracking-widest shadow-sm hover:bg-blue-700 focus:outline-none focus:border-blue-300 focus:ring focus:ring-blue-200 active:text-gray-800 active:bg-gray-50 disabled:opacity-25 transition",disabled:!i(r).amount||!i(r).register_date||i(r).amount>u.value,onClick:o[7]||(o[7]=a=>E())}," Inserir registro ",8,tt)])):l("",!0),t.payment.records_list.data.length?(s(),d("div",at,[e("div",st,[e("div",ot,[e("div",dt,[e("table",nt,[e("thead",rt,[e("tr",null,[lt,it,g.value?l("",!0):(s(),d("th",ct,"Excluir"))])]),e("tbody",null,[(s(!0),d(S,null,F(A.value,a=>(s(),d("tr",mt,[e("td",ut,[t.modal.mode!=="update"&&!a.past?(s(),d("div",pt,[yt,y(e("input",{id:"record_item-amount-edit",name:"record_item-amount-edit",type:"number",step:"0.01",min:"0",max:u.value,autocomplete:"off",class:"relative m-0 block min-w-0 flex-auto rounded-r border border-solid border-neutral-300 bg-transparent bg-clip-padding px-3 py-[0.25rem] text-xs font-normal leading-[1.6] text-neutral-700 outline-none transition duration-200 ease-in-out focus:z-[3] focus:border-primary focus:text-neutral-700 focus:shadow-[inset_0_0_0_1px_rgb(59,113,202)] focus:outline-none disabled:bg-gray-200",placeholder:"Editar pagamento parcial","onUpdate:modelValue":h=>a.amount=h},null,8,bt),[[b,a.amount]])])):(s(),d("p",gt,c(i(k)(a.amount)),1))]),e("td",xt,[t.modal.mode!=="update"&&!a.past?(s(),d("div",_t,[y(e("input",{id:"record-date",name:"record-date",type:"date",max:i(_)(),autocomplete:"off",class:"w-3/4 relative m-0 block min-w-0 flex-auto rounded-r border border-solid border-neutral-300 bg-transparent bg-clip-padding px-3 py-[0.25rem] text-xs font-normal leading-[1.6] text-neutral-700 outline-none transition duration-200 ease-in-out focus:z-[3] focus:border-primary focus:text-neutral-700 focus:shadow-[inset_0_0_0_1px_rgb(59,113,202)] focus:outline-none disabled:bg-gray-200",placeholder:"Data de pagamento do valor parcial","onUpdate:modelValue":h=>a.register_date=h},null,8,vt),[[b,a.register_date]])])):(s(),d("p",ht,c(i(_)(a.register_date,!0)),1))]),g.value?l("",!0):(s(),d("td",ft,[C(i(Q),{class:"w-5 h-5 cursor-pointer m-auto text-gray-700 hover:text-red-500 active:text-red-700",onClick:h=>I(a.id,a),title:"Remover este registro"},null,8,["onClick"])])),a.errors.amount?(s(),d("p",wt,c(a.errors.amount),1)):l("",!0),a.errors.date?(s(),d("p",kt,c(a.errors.date),1)):l("",!0)]))),256))])]),u.value<0?(s(),d("p",Vt,"A soma dos pagamentos não pode ser maior que "+c(i(k)(t.payment.total_value)),1)):l("",!0),V.value?(s(),d("p",Dt," Todas as datas de registro devem ser não nulas e menores ou iguais a "+c(i(_)(new Date)),1)):l("",!0),D.value?(s(),d("p",$t," Todos os valores devem ser maiores que R$ 0,00")):l("",!0)])])])])):(s(),d("div",qt,"Não há registro de pagamento no momento. "))])):l("",!0)])],32)]),footer:x(()=>[C(H,{class:w({disabled:t.payment.processing}),onClick:o[8]||(o[8]=a=>$())},{default:x(()=>[q("Cancelar ")]),_:1},8,["class"]),C(G,{class:w({disabled:t.payment.processing||u.value<0||V.value||D.value}),disabled:t.payment.processing||u.value<0||V.value||D.value,onClick:o[9]||(o[9]=a=>t.modal.mode==="see"?$():T())},{default:x(()=>[q(c(t.modal.primary_button_txt),1)]),_:1},8,["class","disabled"])]),_:1},8,["show"]))}};export{Bt as _};
