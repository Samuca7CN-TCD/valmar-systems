import{r,D as pe,p as Y,k as F,d as a,o,C as ge,a as t,t as n,e as L,F as h,g as w,u as k,b as I,w as M,f as T,i as U,n as v,s as ee,x as te,q as se,j as me}from"./app-nxAEGYom.js";import{C as he}from"./auto-BeiC2jW3.js";import{t as j,f as _e}from"./general-D_37hS-e.js";const ye={class:"mb-6"},fe=ge('<h2 class="text-xl font-bold text-neutral-800 border-l-4 border-teal-500 pl-4 mb-4">ðŸ“Š ServiÃ§os e OrÃ§amentos</h2><div class="grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-4 gap-6 mb-6"><div class="bg-white rounded-lg shadow-sm p-5 border border-teal-100 flex justify-center items-center min-h-[350px] relative"><canvas id="service-status-chart-count" class="w-full h-full"></canvas></div><div class="bg-white rounded-lg shadow-sm p-5 border border-teal-100 flex justify-center items-center min-h-[350px] relative"><canvas id="service-status-chart-value" class="w-full h-full"></canvas></div><div class="bg-white rounded-lg shadow-sm p-5 border border-teal-100 flex justify-center items-center min-h-[350px] relative"><canvas id="budget-status-chart-count" class="w-full h-full"></canvas></div><div class="bg-white rounded-lg shadow-sm p-5 border border-teal-100 flex justify-center items-center min-h-[350px] relative"><canvas id="budget-status-chart-value" class="w-full h-full"></canvas></div></div>',2),we={class:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6"},ke={class:"bg-white rounded-lg shadow-sm p-5 border border-green-100 text-center"},Ce=t("h3",{class:"text-md font-semibold text-green-700 mb-2"},"Total de OrÃ§amentos",-1),Se={class:"text-3xl font-bold text-neutral-800"},Pe={class:"bg-white rounded-lg shadow-sm p-5 border border-green-100 text-center"},Ve=t("h3",{class:"text-md font-semibold text-green-700 mb-2"},"OrÃ§amentos que Geraram ServiÃ§o",-1),$e={class:"text-3xl font-bold text-neutral-800"},Ae={class:"bg-white rounded-lg shadow-sm p-5 border border-green-100 text-center"},je=t("h3",{class:"text-md font-semibold text-green-700 mb-2"},"Taxa de AprovaÃ§Ã£o",-1),Be={class:"text-3xl font-bold text-neutral-800"},Ne={class:"bg-white rounded-lg shadow-sm p-5 border border-green-100 mb-6"},Oe={class:"text-lg font-semibold text-green-700 mb-4"},Re={class:"overflow-x-auto"},Ee={key:0,class:"table-auto min-w-full divide-y divide-neutral-200"},De=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-6 py-3 text-center text-sm font-medium text-neutral-900"},"ID"),t("th",{class:"px-6 py-3 text-center text-sm font-medium text-neutral-900"},"Entidade"),t("th",{class:"px-6 py-3 text-center text-sm font-medium text-neutral-900"},"Motivo"),t("th",{class:"px-6 py-3 text-center text-sm font-medium text-neutral-900"},"Valor Pendente "),t("th",{class:"px-6 py-3 text-center text-sm font-medium text-neutral-900"},"ConcluÃ­do em"),t("th",{class:"px-6 py-3 text-center text-sm font-medium text-neutral-900"},"AÃ§Ãµes")])],-1),Fe={class:"bg-white divide-y divide-neutral-200"},Le={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-neutral-900"},Ie={class:"px-6 py-4 whitespace-nowrap text-sm text-neutral-700"},Me={class:"px-6 py-4 whitespace-nowrap text-sm text-neutral-700"},Te={class:"px-6 py-4 whitespace-nowrap text-sm text-neutral-700"},Ue={class:"px-6 py-4 whitespace-nowrap text-sm text-neutral-700"},ze={class:"px-6 py-4 whitespace-nowrap text-center text-sm font-medium"},qe={key:1,class:"text-sm text-neutral-500 text-center py-4 border-t border-neutral-200 mt-4 pt-4"},Qe={key:0,class:"flex justify-center mt-4 space-x-1 flex-wrap"},Ze=["disabled"],Ge=["disabled"],We={key:0,class:"px-3 py-1 text-sm text-gray-500"},He=["onClick"],Je=["disabled"],Ke=["disabled"],Xe={class:"bg-white rounded-lg shadow-sm p-5 border border-green-100 mb-6"},Ye=t("h3",{class:"text-lg font-semibold text-green-700 mb-4"},"ServiÃ§os",-1),et={class:"mb-4 flex items-center gap-2"},tt=t("label",{for:"service-status-filter",class:"text-sm text-neutral-600"},"Filtrar por Status:",-1),st=["value"],at={class:"overflow-x-auto"},ot={key:0,class:"table-auto min-w-full divide-y divide-neutral-200"},rt=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-6 py-3 text-center text-sm font-medium text-neutral-900"},"ID"),t("th",{class:"px-6 py-3 text-center text-sm font-medium text-neutral-900"},"Entidade"),t("th",{class:"px-6 py-3 text-center text-sm font-medium text-neutral-900"},"Status"),t("th",{class:"px-6 py-3 text-center text-sm font-medium text-neutral-900"},"Valor Parcial "),t("th",{class:"px-6 py-3 text-center text-sm font-medium text-neutral-900"},"AÃ§Ãµes")])],-1),lt={class:"bg-white divide-y divide-neutral-200"},nt={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-neutral-900"},dt={class:"px-6 py-4 whitespace-nowrap text-sm text-neutral-700"},ut={class:"px-6 py-4 whitespace-nowrap text-sm text-neutral-700"},it={class:"px-6 py-4 whitespace-nowrap text-sm text-neutral-700"},ct={class:"px-6 py-4 whitespace-nowrap text-center text-sm font-medium"},vt={key:1,class:"text-sm text-neutral-500 text-center py-4 border-t border-neutral-200 mt-4 pt-4"},bt={key:0,class:"flex justify-center mt-4 space-x-1 flex-wrap"},xt=["disabled"],pt=["disabled"],gt={key:0,class:"px-3 py-1 text-sm text-gray-500"},mt=["onClick"],ht=["disabled"],_t=["disabled"],yt={class:"bg-white rounded-lg shadow-sm p-5 border border-green-100"},ft=t("h3",{class:"text-lg font-semibold text-green-700 mb-4"},"OrÃ§amentos",-1),wt={class:"mb-4 flex items-center gap-2"},kt=t("label",{for:"budget-status-filter",class:"text-sm text-neutral-600"},"Filtrar por Status:",-1),Ct=["value"],St={class:"overflow-x-auto"},Pt={key:0,class:"table-auto min-w-full divide-y divide-neutral-200"},Vt=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-6 py-3 text-center text-sm font-medium text-neutral-900"},"ID"),t("th",{class:"px-6 py-3 text-center text-sm font-medium text-neutral-900"},"TÃ­tulo"),t("th",{class:"px-6 py-3 text-center text-sm font-medium text-neutral-900"},"Status"),t("th",{class:"px-6 py-3 text-center text-sm font-medium text-neutral-900"},"Valor Total "),t("th",{class:"px-6 py-3 text-center text-sm font-medium text-neutral-900"},"AÃ§Ãµes")])],-1),$t={class:"bg-white divide-y divide-neutral-200"},At={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-neutral-900"},jt={class:"px-6 py-4 whitespace-nowrap text-sm text-neutral-700"},Bt={class:"px-6 py-4 whitespace-nowrap text-sm text-neutral-700"},Nt={class:"px-6 py-4 whitespace-nowrap text-sm text-neutral-700"},Ot={class:"px-6 py-4 whitespace-nowrap text-center text-sm font-medium"},Rt={key:1,class:"text-sm text-neutral-500 text-center py-4 border-t border-neutral-200 mt-4 pt-4"},Et={key:0,class:"flex justify-center mt-4 space-x-1 flex-wrap"},Dt=["disabled"],Ft=["disabled"],Lt={key:0,class:"px-3 py-1 text-sm text-gray-500"},It=["onClick"],Mt=["disabled"],Tt=["disabled"],Zt={__name:"Servico",setup(Ut){const z=r({}),q=r({}),Q=r({}),Z=r({}),B=r({total_budgets:0,budgets_with_service:0,approval_rate:"0.00%"}),R=r([]),E=r([]),G=r(!0),d=r(1),x=r(1),ae=r(0),W=r(10),u=r(1),p=r(1),oe=r(0),H=r(10),S=r("all"),P=r("all"),re=r([{value:"all",label:"Todos"},{value:"NÃ£o Iniciado",label:"NÃ£o Iniciado"},{value:"Em Andamento",label:"Em Andamento"},{value:"Finalizado",label:"Finalizado"},{value:"Cancelado",label:"Cancelado"}]),le=r([{value:"all",label:"Todos"},{value:"Criado",label:"Criado/Rascunho"},{value:"Enviado",label:"Enviado"},{value:"Aprovado",label:"Aprovado"},{value:"Rejeitado",label:"Rejeitado"},{value:"Cancelado",label:"Cancelado"}]),N=r([]),i=r(1),g=r(1),ne=r(0),J=r(10);let de=r(null),ue=r(null),ie=r(null),ce=r(null);const O=(l,s,c,e,b,C)=>{const m=document.getElementById(l);if(!m)return;const f={labels:Object.keys(e.value),datasets:[{label:c==="doughnut"?"Quantidade":"Valor (R$)",data:Object.values(e.value),backgroundColor:c==="doughnut"?C:C.map(y=>y.replace("rgb","rgba").replace(")",", 0.6)")),borderColor:c==="bar"?C.map(y=>y.replace("rgb","rgba").replace(")",", 1)")):void 0,borderWidth:c==="bar"?1:void 0,hoverOffset:c==="doughnut"?4:void 0}]},_={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"},title:{display:!0,text:b+(c==="doughnut"?" (Quantidade)":" (Valor)")},tooltip:{callbacks:{label:function(y){return c==="bar"?y.dataset.label+": "+j(y.raw):y.label+": "+y.formattedValue}}}},scales:c==="bar"?{x:{beginAtZero:!0,grid:{display:!1}},y:{beginAtZero:!0,ticks:{callback:function(y){return j(y)}},grid:{color:"rgba(200, 200, 200, 0.2)"}}}:{}};s.value?(s.value.data=f,s.value.options=_,s.value.update()):s.value=new he(m,{type:c,data:f,options:_})},K=async()=>{G.value=!0;try{const s=(await se.get(route("dashboard.data.services_budgets",{service_status:S.value==="all"?null:S.value,budget_status:P.value==="all"?null:P.value,service_page:d.value,budget_page:u.value,service_per_page:W.value,budget_per_page:H.value,start_date:"last_30_days"}))).data;z.value=s.serviceReports.byCount,q.value=s.serviceReports.byValue,Q.value=s.budgetReports.byCount,Z.value=s.budgetReports.byValue,B.value=s.combinedReports,R.value=s.services.data,d.value=s.services.current_page,x.value=s.services.last_page,ae.value=s.services.total,W.value=s.services.per_page,E.value=s.budgets.data,u.value=s.budgets.current_page,p.value=s.budgets.last_page,oe.value=s.budgets.total,H.value=s.budgets.per_page,me(()=>{const c=["rgb(144, 202, 249)","rgb(255, 241, 118)","rgb(165, 214, 167)","rgb(239, 154, 154)"],e=["rgb(144, 202, 249)","rgb(165, 214, 167)","rgb(255, 204, 128)","rgb(239, 154, 154)","rgb(207, 216, 220)"];O("service-status-chart-count",de,"doughnut",z,"ServiÃ§os por Status",c),O("service-status-chart-value",ie,"bar",q,"ServiÃ§os por Status",c),O("budget-status-chart-count",ue,"doughnut",Q,"OrÃ§amentos por Status",e),O("budget-status-chart-value",ce,"bar",Z,"OrÃ§amentos por Status",e)})}catch(l){console.error("Erro ao carregar dados do dashboard de serviÃ§os/orÃ§amentos:",l)}finally{G.value=!1}},X=async()=>{try{const s=(await se.get(route("dashboard.data.unpaid_completed_services",{unpaid_page:i.value,unpaid_per_page:J.value}))).data.unpaid_services_list;N.value=s.data,i.value=s.current_page,g.value=s.last_page,ne.value=s.total,J.value=s.per_page}catch(l){console.error("Erro ao carregar serviÃ§os concluÃ­dos nÃ£o pagos:",l)}};pe(()=>{K(),X()}),Y([S,P,d,u],()=>{K()}),Y(i,()=>{X()});const V=l=>{l>=1&&l<=x.value&&(d.value=l)},$=l=>{l>=1&&l<=p.value&&(u.value=l)},A=l=>{l>=1&&l<=g.value&&(i.value=l)},D=(l,s,c=5)=>{const e=[],b="...",C=Math.floor(c/2);if(s<=c+2){for(let _=1;_<=s;_++)e.push(_);return e}let m=l-C,f=l+C;m<1&&(m=1,f=c),f>s&&(f=s,m=s-c+1),m=Math.max(1,m),m>1&&(e.push(1),m>2&&e.push(b));for(let _=m;_<=f;_++)e.push(_);return f<s&&(f<s-1&&e.push(b),e.push(s)),e},ve=F(()=>D(d.value,x.value)),be=F(()=>D(u.value,p.value)),xe=F(()=>D(i.value,g.value));return(l,s)=>{var c;return o(),a("div",ye,[fe,t("div",we,[t("div",ke,[Ce,t("p",Se,n(B.value.total_budgets),1)]),t("div",Pe,[Ve,t("p",$e,n(B.value.budgets_with_service),1)]),t("div",Ae,[je,t("p",Be,n(B.value.approval_rate),1)])]),t("div",Ne,[t("h3",Oe,"ServiÃ§os ConcluÃ­dos e NÃ£o Pagos (x"+n((c=N.value)==null?void 0:c.length)+")",1),t("div",Re,[N.value.length?(o(),a("table",Ee,[De,t("tbody",Fe,[(o(!0),a(h,null,w(N.value,e=>{var b;return o(),a("tr",{key:e.id},[t("td",Le,n(e.id),1),t("td",Ie,n(e.entity_name),1),t("td",Me,n(e.motive),1),t("td",Te,n(k(j)((b=e.accounting)==null?void 0:b.partial_value)),1),t("td",Ue,n(k(_e)(e.completion_date,"short_date")),1),t("td",ze,[I(k(U),{href:l.route("services.show",e.id),target:"_blank",class:"text-green-600 hover:text-green-900"},{default:M(()=>[T("Ver")]),_:2},1032,["href"])])])}),128))])])):(o(),a("p",qe," Nenhum serviÃ§o concluÃ­do e nÃ£o pago encontrado. "))]),g.value>1?(o(),a("div",Qe,[t("button",{onClick:s[0]||(s[0]=e=>A(1)),disabled:i.value===1,class:v(["px-3 py-1 border rounded-md text-sm transition-colors duration-150 ease-in-out",{"bg-gray-200 text-gray-500 cursor-not-allowed":i.value===1,"hover:bg-green-100 hover:text-green-700":i.value!==1}])}," Primeira ",10,Ze),t("button",{onClick:s[1]||(s[1]=e=>A(i.value-1)),disabled:i.value===1,class:v(["px-3 py-1 border rounded-md text-sm transition-colors duration-150 ease-in-out",{"bg-gray-200 text-gray-500 cursor-not-allowed":i.value===1,"hover:bg-green-100 hover:text-green-700":i.value!==1}])}," Anterior ",10,Ge),(o(!0),a(h,null,w(xe.value,e=>(o(),a(h,{key:e},[e==="..."?(o(),a("span",We,"...")):(o(),a("button",{key:1,onClick:b=>A(e),class:v(["px-3 py-1 border rounded-md text-sm transition-colors duration-150 ease-in-out",{"bg-green-600 text-white border-green-600":e===i.value,"bg-gray-100 text-green-700 hover:bg-green-200 hover:text-green-800":e!==i.value}])},n(e),11,He))],64))),128)),t("button",{onClick:s[2]||(s[2]=e=>A(i.value+1)),disabled:i.value===g.value,class:v(["px-3 py-1 border rounded-md text-sm transition-colors duration-150 ease-in-out",{"bg-gray-200 text-gray-500 cursor-not-allowed":i.value===g.value,"hover:bg-green-100 hover:text-green-700":i.value!==g.value}])}," PrÃ³xima ",10,Je),t("button",{onClick:s[3]||(s[3]=e=>A(g.value)),disabled:i.value===g.value,class:v(["px-3 py-1 border rounded-md text-sm transition-colors duration-150 ease-in-out",{"bg-gray-200":i.value===g.value,"hover:bg-green-100 hover:text-green-700":i.value!==g.value}])}," Ãšltima ",10,Ke)])):L("",!0)]),t("div",null,[t("div",Xe,[Ye,t("div",et,[tt,ee(t("select",{id:"service-status-filter","onUpdate:modelValue":s[4]||(s[4]=e=>S.value=e),class:"simple-select w-48"},[(o(!0),a(h,null,w(re.value,e=>(o(),a("option",{key:e.value,value:e.value},n(e.label),9,st))),128))],512),[[te,S.value]])]),t("div",at,[R.value.length?(o(),a("table",ot,[rt,t("tbody",lt,[(o(!0),a(h,null,w(R.value,e=>{var b;return o(),a("tr",{key:e.id},[t("td",nt,n(e.id),1),t("td",dt,n(e.entity_name),1),t("td",ut,n(e.service_status),1),t("td",it,n(k(j)((b=e.accounting)==null?void 0:b.partial_value)),1),t("td",ct,[I(k(U),{href:l.route("services.show",e.id),target:"_blank",class:"text-green-600 hover:text-green-900"},{default:M(()=>[T("Ver")]),_:2},1032,["href"])])])}),128))])])):(o(),a("p",vt," Nenhum serviÃ§o encontrado com este status. "))]),x.value>1?(o(),a("div",bt,[t("button",{onClick:s[5]||(s[5]=e=>V(1)),disabled:d.value===1,class:v(["px-3 py-1 border rounded-md text-sm transition-colors duration-150 ease-in-out",{"bg-gray-200 text-gray-500 cursor-not-allowed":d.value===1,"hover:bg-green-100 hover:text-green-700":d.value!==1}])}," Primeira ",10,xt),t("button",{onClick:s[6]||(s[6]=e=>V(d.value-1)),disabled:d.value===1,class:v(["px-3 py-1 border rounded-md text-sm transition-colors duration-150 ease-in-out",{"bg-gray-200 text-gray-500 cursor-not-allowed":d.value===1,"hover:bg-green-100 hover:text-green-700":d.value!==1}])}," Anterior ",10,pt),(o(!0),a(h,null,w(ve.value,e=>(o(),a(h,{key:e},[e==="..."?(o(),a("span",gt,"...")):(o(),a("button",{key:1,onClick:b=>V(e),class:v(["px-3 py-1 border rounded-md text-sm transition-colors duration-150 ease-in-out",{"bg-green-600 text-white border-green-600":e===d.value,"bg-gray-100 text-green-700 hover:bg-green-200 hover:text-green-800":e!==d.value}])},n(e),11,mt))],64))),128)),t("button",{onClick:s[7]||(s[7]=e=>V(d.value+1)),disabled:d.value===x.value,class:v(["px-3 py-1 border rounded-md text-sm transition-colors duration-150 ease-in-out",{"bg-gray-200 text-gray-500 cursor-not-allowed":d.value===x.value,"hover:bg-green-100 hover:text-green-700":d.value!==x.value}])}," PrÃ³xima ",10,ht),t("button",{onClick:s[8]||(s[8]=e=>V(x.value)),disabled:d.value===x.value,class:v(["px-3 py-1 border rounded-md text-sm transition-colors duration-150 ease-in-out",{"bg-gray-200":d.value===x.value,"hover:bg-green-100 hover:text-green-700":d.value!==x.value}])}," Ãšltima ",10,_t)])):L("",!0)]),t("div",yt,[ft,t("div",wt,[kt,ee(t("select",{id:"budget-status-filter","onUpdate:modelValue":s[9]||(s[9]=e=>P.value=e),class:"simple-select w-48"},[(o(!0),a(h,null,w(le.value,e=>(o(),a("option",{key:e.value,value:e.value},n(e.label),9,Ct))),128))],512),[[te,P.value]])]),t("div",St,[E.value.length?(o(),a("table",Pt,[Vt,t("tbody",$t,[(o(!0),a(h,null,w(E.value,e=>(o(),a("tr",{key:e.id},[t("td",At,n(e.id),1),t("td",jt,n(e.title),1),t("td",Bt,n(e.status),1),t("td",Nt,n(k(j)(e.total_value)),1),t("td",Ot,[I(k(U),{href:l.route("budgets.show",e.id),target:"_blank",class:"text-green-600 hover:text-green-900"},{default:M(()=>[T("Ver")]),_:2},1032,["href"])])]))),128))])])):(o(),a("p",Rt," Nenhum orÃ§amento encontrado com este status. "))]),p.value>1?(o(),a("div",Et,[t("button",{onClick:s[10]||(s[10]=e=>$(1)),disabled:u.value===1,class:v(["px-3 py-1 border rounded-md text-sm transition-colors duration-150 ease-in-out",{"bg-gray-200 text-gray-500 cursor-not-allowed":u.value===1,"hover:bg-green-100 hover:text-green-700":u.value!==1}])}," Primeira ",10,Dt),t("button",{onClick:s[11]||(s[11]=e=>$(u.value-1)),disabled:u.value===1,class:v(["px-3 py-1 border rounded-md text-sm transition-colors duration-150 ease-in-out",{"bg-gray-200 text-gray-500 cursor-not-allowed":u.value===1,"hover:bg-green-100 hover:text-green-700":u.value!==1}])}," Anterior ",10,Ft),(o(!0),a(h,null,w(be.value,e=>(o(),a(h,{key:e},[e==="..."?(o(),a("span",Lt,"...")):(o(),a("button",{key:1,onClick:b=>$(e),class:v(["px-3 py-1 border rounded-md text-sm transition-colors duration-150 ease-in-out",{"bg-green-600 text-white border-green-600":e===u.value,"bg-gray-100 text-green-700 hover:bg-green-200 hover:text-green-800":e!==u.value}])},n(e),11,It))],64))),128)),t("button",{onClick:s[12]||(s[12]=e=>$(u.value+1)),disabled:u.value===p.value,class:v(["px-3 py-1 border rounded-md text-sm transition-colors duration-150 ease-in-out",{"bg-gray-200 text-gray-500 cursor-not-allowed":u.value===p.value,"hover:bg-green-100 hover:text-green-700":u.value!==p.value}])}," PrÃ³xima ",10,Mt),t("button",{onClick:s[13]||(s[13]=e=>$(p.value)),disabled:u.value===p.value,class:v(["px-3 py-1 border rounded-md text-sm transition-colors duration-150 ease-in-out",{"bg-gray-200":u.value===p.value,"hover:bg-green-100 hover:text-green-700":u.value!==p.value}])}," Ãšltima ",10,Tt)])):L("",!0)])])])}}};export{Zt as default};
