import{l as D,d as E,o,c as M,w as V,a as e,n as O,u as i,h as m,f as w,t as r,i as J,p as f,v as $,e as c,F as B,g as Q,b as v,y as K,T as Z,Z as Y,G as ee}from"./app-xjJ8na4r.js";import{r as te,a as se,b as ae,_ as le}from"./AppLayout-BOBs5ZEO.js";import{_ as oe}from"./CreateUpdateModal-U7ZkrYrZ.js";import{_ as ne}from"./PrimaryButton-DYKnFRqk.js";import{_ as ie}from"./SecondaryButton-C2X9K_i9.js";import{f as W,t as k}from"./general-DyNoCMvo.js";import{r as re}from"./PlusIcon-Qtp_qUi0.js";import{r as de,a as ce}from"./XMarkIcon-ClR3zrEp.js";import{r as H}from"./EyeIcon-Dl0r3gu1.js";import{_ as ue}from"./FloatButton-DOifkNz7.js";/* empty css                    */import{r as me}from"./MagnifyingGlassIcon-BlKVGOg-.js";import{r as pe}from"./InformationCircleIcon-CFTkfDvi.js";import"./Modal-GnKcZS1t.js";import"./PrinterIcon-EuA9oIlG.js";const _e={class:"pb-12 space-y-12 divide-y-2"},ge={class:"py-4"},ye=e("h2",{class:"text-base font-semibold leading-7 text-gray-900"},"Informações Básicas",-1),he=e("p",{class:"mt-1 text-sm leading-6 text-gray-600"},"Informações sobre a venda como nome do cliente, data da venda e observações",-1),xe={class:"mt-10 grid grid-cols-1 gap-x-6 gap-y-8 sm:grid-cols-6"},ve={class:"sm:col-span-3"},fe=e("label",{for:"sell-client",class:"block text-sm font-medium leading-6 text-gray-900 required-input-label"},"Cliente",-1),be={class:"mt-2"},we={key:0,class:"text-red-500 text-sm"},$e={class:"sm:col-span-3"},ke=e("label",{for:"sell-date",class:"block text-sm font-medium leading-6 text-gray-900 required-input-label"},"Data da Venda",-1),qe={class:"mt-2"},Ve=["max"],Ce={key:0,class:"text-red-500 text-sm"},Se={class:"sm:col-span-6"},Ie=e("label",{for:"sell-observations",class:"block text-sm font-medium leading-6 text-gray-900"},"Observações",-1),De={class:"mt-2"},Ue={key:0,class:"text-red-500 text-sm"},Le={key:0,class:"py-4"},Me=e("h2",{class:"text-base font-semibold leading-7 text-gray-900"},"Lista de Itens",-1),Oe=e("p",{class:"mt-1 text-sm leading-6 text-gray-600"},"Adicione os itens da venda bem como descontos e valor de pagamento de entrada.",-1),Re={class:"mt-10 grid grid-cols-1 gap-x-6 gap-y-8 sm:grid-cols-4"},je={class:"sm:col-span-4"},Ae={class:"relative"},Ee=e("label",{for:"item-selecter",class:"block text-sm font-medium leading-6 text-gray-900"},"Selecione os itens de venda",-1),Te=["disabled"],Fe={key:0,class:"absolute z-10 w-full mx-auto sm:w-96 bg-white border rounded mt-2 h-96 overflow-y-scroll"},Ne=["onMousedown"],Be={class:"md:col-span-2 lg:col-span-1"},Pe=e("label",{for:"sell-estimated-amount",class:"block text-sm font-medium leading-6 text-gray-900"},"Valor estimado ",-1),ze={class:"relative mt-2 rounded-md shadow-sm"},Ge=e("div",{class:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3"},[e("span",{class:"text-gray-500 sm:text-sm"},"R$")],-1),Qe=["disabled"],We={key:0,class:"text-red-500 text-sm"},Xe={class:"md:col-span-2 lg:col-span-1"},Ze=e("label",{for:"sell-total-amount",class:"block text-sm font-medium leading-6 text-gray-900"},"Valor final ",-1),He={class:"relative mt-2 rounded-md shadow-sm"},Je=e("div",{class:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3"},[e("span",{class:"text-gray-500 sm:text-sm"},"R$")],-1),Ke=["disabled","value"],Ye={key:0,class:"text-red-500 text-sm"},et={class:"md:col-span-2 lg:col-span-1"},tt=e("label",{for:"sell-discount-percent",class:"block text-sm font-medium leading-6 text-gray-900"},"Desconto (%) ",-1),st={class:"relative mt-2 rounded-md shadow-sm"},at=["disabled","value"],lt=e("div",{class:"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-3"},[e("span",{class:"text-gray-500 sm:text-sm"},"%")],-1),ot={key:0,class:"text-red-500 text-sm"},nt={class:"md:col-span-2 lg:col-span-1"},it=e("label",{for:"sell-discount",class:"block text-sm font-medium leading-6 text-gray-900"},"Desconto (R$) ",-1),rt={class:"relative mt-2 rounded-md shadow-sm"},dt=e("div",{class:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3"},[e("span",{class:"text-gray-500 sm:text-sm"},"R$")],-1),ct=["disabled","value"],ut={key:0,class:"text-red-500 text-sm"},mt={class:"sm:col-span-4"},pt={key:0,class:"min-w-full text-left text-sm font-medium leading-6 text-gray-900"},_t={class:"border-b font-medium"},gt=e("th",{scope:"col",class:"px-6 py-4 text-center"},"#",-1),yt=e("th",{scope:"col",class:"px-6 py-4 text-center"},"Item",-1),ht=e("th",{scope:"col",class:"px-6 py-4 text-center"},"Qtd. Estoque",-1),xt=e("th",{scope:"col",class:"px-6 py-4 text-center"},"Qtd. Venda",-1),vt=e("th",{scope:"col",class:"px-6 py-4 text-center"},"Und. Medida",-1),ft=e("th",{scope:"col",class:"px-6 py-4 text-center"},"Preço unitário",-1),bt=e("th",{scope:"col",class:"px-6 py-4 text-center"},"Preço montante",-1),wt={key:0,scope:"col",class:"px-6 py-4 text-center"},$t={class:"whitespace-nowrap py-4 text-center font-medium"},kt={class:"whitespace-nowrap py-4 text-center font-medium"},qt={class:"whitespace-nowrap py-4 text-center font-medium flex justify-center"},Vt=["value","onInput","disabled"],Ct={class:"whitespace-nowrap py-4 text-center font-medium"},St={class:"whitespace-nowrap py-4 text-center font-medium"},It={class:"whitespace-nowrap py-4 text-center font-medium"},Dt={key:0,class:"whitespace-nowrap py-4 text-center font-mono text-2xl"},Ut=["onClick","title"],Lt={key:1,class:"p-5 bg-gray-200 rounded-md block text-sm font-medium leading-6 text-gray-900"},Mt={key:1,class:"w-full py-4"},Ot=e("h2",{class:"text-base font-semibold leading-7 text-gray-900"},"Pagamento de entrada",-1),Rt=e("p",{class:"mt-1 text-sm leading-6 text-gray-600"},"Após a conclusão da compra, um registro de pagamento será criado na página de PAGAMENTOS. ",-1),jt=e("p",{class:"mt-1 text-sm leading-6 text-gray-600"},"Se algum pagamento de entrada (ou pagamento total) for realizado, registre aqui.",-1),At={class:"mt-10 grid grid-cols-1 gap-x-6 gap-y-8 sm:grid-cols-4"},Et={class:"md:col-span-2 lg:col-span-1 text-gray-700"},Tt={class:"font-extrabold text-green-500"},Ft={class:"md:col-span-2 lg:col-span-1 text-gray-700"},Nt={class:"font-extrabold text-green-500"},Bt={class:"md:col-span-2 lg:col-span-1 text-gray-700"},Pt={class:"font-extrabold text-green-500"},zt={class:"md:col-span-2 lg:col-span-1 text-gray-700"},Gt={class:"font-extrabold text-green-500"},Qt={class:"sm:col-span-2"},Wt=e("label",{for:"sell-entry-value",class:"block text-sm font-medium leading-6 text-gray-900"},"Pagamento de entrada ",-1),Xt={class:"relative mt-2 rounded-md shadow-sm"},Zt=e("div",{class:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3"},[e("span",{class:"text-gray-500 sm:text-sm"},"R$")],-1),Ht=["disabled"],Jt={key:0,class:"text-red-500 text-sm"},Kt={class:"sm:col-span-2"},Yt=e("label",{for:"sell-partial-value",class:"block text-sm font-medium leading-6 text-gray-900"},"Valor restante ",-1),es={class:"relative mt-2 rounded-md shadow-sm"},ts=e("div",{class:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3"},[e("span",{class:"text-gray-500 sm:text-sm"},"R$")],-1),ss=["disabled","value"],as={key:0,class:"text-red-500 text-sm"},ls={__name:"CreateUpdateSellsModal",props:{modal:Object,sell:{type:Object,default:null},items:Array},emits:["close","submit"],setup(s,{emit:q}){const R=q,n=s,C=/^\d{4}-\d{2}-\d{2}$/,_=D(()=>{const{client:l,date:a}=n.sell;return!l||!l.length?!1:a&&C.test(a)}),U=D(()=>{const{client:l,date:a,estimated_value:t,total_value:y,entry_value:g,items_list:A}=n.sell;return!l||!l.length||!a||!C.test(a)||!(t>0&&y>0&&g<=y)?!1:A.every(G=>G.quantity>0&&G.movement_quantity<=G.quantity)}),T=D(()=>n.sell.total_value-n.sell.entry_value),h=D(()=>n.modal.mode==="see"),b=E(""),S=E(!1),L=D(()=>n.items.filter(l=>l.name.toLowerCase().includes(b.value.toLowerCase()))),F=l=>{l==="in"&&(S.value=!0),l==="out"&&(S.value=!1)},I=()=>{n.sell.estimated_value=n.sell.items_list.reduce((l,a)=>l+a.price*a.movement_quantity,0),u("estimated_value")},P=l=>{n.sell.items_list.push({id:l.id,name:l.name,quantity:l.quantity,max_quantity:l.max_quantity,min_quantity:l.min_quantity,movement_quantity:1,measurement_unit:l.measurement_unit.abbreviation,price:l.price,amount:l.price}),b.value="",S.value=!1,I()},z=l=>{n.sell.items_list=n.sell.items_list.filter(a=>a.id!==l),I()},j=(l,a)=>{n.sell[a]=l.target.value,u(a)},p=(l,a)=>{const t=10**a;return Math.floor(l*t)/t},u=l=>{let{estimated_value:a,total_value:t,discount_percent:y,discount:g}=n.sell;switch(l){case"estimated_value":case"discount_percent":t=a*(1-y/100),g=a-t;break;case"total_value":g=a-t,y=g/a*100;break;case"discount":y=g/a*100,t=a-g;break}Object.assign(n.sell,{estimated_value:a,total_value:t,discount_percent:y,discount:g})},d=()=>{R("close")},x=()=>{R("submit")};return(l,a)=>(o(),M(oe,{show:s.modal.show,maxWidth:_.value||h.value?"6xl":"2xl",onClose:d},{icon:V(()=>[e("div",{class:O(["mx-auto shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-blue-400 sm:mx-0 sm:h-10 sm:w-10",{"bg-yellow-400":s.modal.mode==="update","bg-green-400":s.modal.mode==="pay","bg-gray-400":s.modal.mode==="see"}])},[s.modal.mode==="create"?(o(),M(i(re),{key:0,class:"w-5 h-5 text-white"})):m("",!0),s.modal.mode==="update"?(o(),M(i(de),{key:1,class:"w-5 h-5 text-white"})):m("",!0),s.modal.mode==="pay"?(o(),M(i(te),{key:2,class:"w-5 h-5 text-white"})):m("",!0),s.modal.mode==="see"?(o(),M(i(H),{key:3,class:"w-5 h-5 text-white"})):m("",!0)],2)]),title:V(()=>[w(r(s.modal.title),1)]),content:V(()=>[e("form",{onSubmit:J(x,["prevent"])},[e("div",_e,[e("section",ge,[ye,he,e("div",xe,[e("div",ve,[fe,e("div",be,[f(e("input",{type:"text",name:"sell-client",id:"sell-client",autocomplete:"on",class:"simple-input disabled:bg-gray-200",placeholder:"Nome do cliente","onUpdate:modelValue":a[0]||(a[0]=t=>s.sell.client=t),required:""},null,512),[[$,s.sell.client]]),s.sell.errors.client?(o(),c("p",we,r(s.sell.errors.client),1)):m("",!0)])]),e("div",$e,[ke,e("div",qe,[f(e("input",{type:"date",name:"sell-date",id:"sell-date",autocomplete:"on",class:"simple-input disabled:bg-gray-200",autofocus:"true",placeholder:"Data da Venda",max:i(W)(),"onUpdate:modelValue":a[1]||(a[1]=t=>s.sell.date=t),required:""},null,8,Ve),[[$,s.sell.date]]),s.sell.errors.date?(o(),c("p",Ce,r(s.sell.errors.date),1)):m("",!0)])]),e("div",Se,[Ie,e("div",De,[f(e("textarea",{type:"text",observations:"sell-observations",id:"sell-observations",autocomplete:"on",class:"simple-input disabled:bg-gray-200",placeholder:"Descreva a título mais detalhadamente ou insira informações adicionais","onUpdate:modelValue":a[2]||(a[2]=t=>s.sell.observations=t)},null,512),[[$,s.sell.observations]]),s.sell.errors.observations?(o(),c("p",Ue,r(s.sell.errors.observations),1)):m("",!0)])])])]),_.value||h.value?(o(),c("section",Le,[Me,Oe,e("div",Re,[e("div",je,[e("div",Ae,[Ee,f(e("input",{id:"item-selecter","onUpdate:modelValue":a[3]||(a[3]=t=>b.value=t),onFocus:a[4]||(a[4]=t=>F("in")),onBlur:a[5]||(a[5]=t=>F("out")),class:"simple-input disabled:bg-gray-200 px-4 py-2 w-full",placeholder:"Digite para pesquisar",disabled:h.value},null,40,Te),[[$,b.value]]),S.value?(o(),c("ul",Fe,[(o(!0),c(B,null,Q(L.value,(t,y)=>(o(),c("li",{key:y,class:"py-2 px-4 cursor-pointer hover:bg-gray-200",onMousedown:g=>P(t)},[e("span",{class:O(["inline",{"text-blue-500":t.quantity!=0&&t.quantity>=t.max_quantity,"text-green-500":t.quantity<t.max_quantity&&t.quantity>=t.min_quantity,"text-yellow-500":t.quantity<t.min_quantity&&t.quantity>0,"text-red-500":t.quantity==0}])},"("+r(t.quantity)+")",3),w(" "+r(t.name),1)],40,Ne))),128))])):m("",!0)])]),e("div",Be,[Pe,e("div",ze,[Ge,f(e("input",{id:"sell-estimated-amount",type:"number",step:"0.01",min:"0",autocomplete:"off",readonly:"",class:"block w-full rounded-md border-0 py-1.5 pl-9 text-gray-900 ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-green-600 sm:text-sm sm:leading-6 disabled:bg-gray-200",placeholder:"Valor total estimado",disabled:!s.sell.items_list.length||h.value,"onUpdate:modelValue":a[6]||(a[6]=t=>s.sell.estimated_value=t),required:""},null,8,Qe),[[$,s.sell.estimated_value]]),s.sell.errors.estimated_value?(o(),c("p",We,r(s.sell.errors.estimated_value),1)):m("",!0)])]),e("div",Xe,[Ze,e("div",He,[Je,e("input",{id:"sell-total-amount",type:"number",step:"0.01",min:"0",autocomplete:"off",class:"block w-full rounded-md border-0 py-1.5 pl-9 text-gray-900 ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-green-600 sm:text-sm sm:leading-6 disabled:bg-gray-200",placeholder:"Valor total estimado",disabled:!s.sell.items_list.length||h.value,value:p(s.sell.total_value,2),onInput:a[7]||(a[7]=t=>j(t,"total_value")),required:""},null,40,Ke),s.sell.errors.total_value?(o(),c("p",Ye,r(s.sell.errors.total_value),1)):m("",!0)])]),e("div",et,[tt,e("div",st,[e("input",{id:"sell-discount-percent",type:"number",step:"0.01",min:"0",autocomplete:"off",class:"block w-full rounded-md border-0 py-1.5 pr-9 text-gray-900 ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-green-600 sm:text-sm sm:leading-6 disabled:bg-gray-200",placeholder:"Valor total estimado",disabled:!s.sell.items_list.length||h.value,value:p(s.sell.discount_percent,3),onInput:a[8]||(a[8]=t=>j(t,"discount_percent")),required:""},null,40,at),lt,s.sell.errors.discount_percent?(o(),c("p",ot,r(s.sell.errors.discount_percent),1)):m("",!0)])]),e("div",nt,[it,e("div",rt,[dt,e("input",{id:"sell-discount",type:"number",step:"0.01",min:"0",autocomplete:"off",class:"block w-full rounded-md border-0 py-1.5 pl-9 text-gray-900 ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-green-600 sm:text-sm sm:leading-6 disabled:bg-gray-200",placeholder:"Valor total estimado",disabled:!s.sell.items_list.length||h.value,value:p(s.sell.discount,2),onInput:a[9]||(a[9]=t=>j(t,"discount")),required:""},null,40,ct),s.sell.errors.discount?(o(),c("p",ut,r(s.sell.errors.discount),1)):m("",!0)])]),e("div",mt,[n.sell.items_list.length?(o(),c("table",pt,[e("thead",_t,[e("tr",null,[gt,yt,ht,xt,vt,ft,bt,s.modal.mode!=="see"?(o(),c("th",wt," Deletar")):m("",!0)])]),e("tbody",null,[(o(!0),c(B,null,Q(n.sell.items_list,t=>(o(),c("tr",{key:t.id,class:O(["border-b transition duration-300 ease-in-out hover:bg-neutral-100 print:break-inside-avoid",{"bg-yellow-100":t.movement_quantity==t.quantity,"bg-red-100":t.movement_quantity>t.quantity}])},[e("td",$t,r(t.id),1),e("td",kt,r(t.name),1),e("td",{class:O(["whitespace-nowrap py-4 text-center font-medium",{"text-blue-500":t.quantity!=0&&t.quantity>=t.max_quantity,"text-green-500":t.quantity<t.max_quantity&&t.quantity>=t.min_quantity,"text-yellow-500":t.quantity<t.min_quantity&&t.quantity>0,"text-red-500":t.quantity==0}])},r(t.quantity),3),e("td",qt,[e("input",{type:"number",min:"0.01",step:"0.01",value:t.movement_quantity,onInput:y=>{t.movement_quantity=y.target.value,t.amount=t.price*y.target.value,I()},class:"simple-input disabled:bg-gray-200 w-2/3",disabled:s.modal.mode!=="create"},null,40,Vt)]),e("td",Ct,r(t.measurement_unit),1),e("td",St,r(i(k)(t.price)),1),e("td",It,r(i(k)(t.amount?t.amount:10)),1),s.modal.mode!=="see"?(o(),c("td",Dt,[e("button",{onClick:y=>z(t.id),title:"Remover "+t.name},"×",8,Ut)])):m("",!0)],2))),128))])])):(o(),c("p",Lt," Nenhum item selecionado até o momento!"))])])])):m("",!0),_.value&&s.sell.items_list.length&&s.modal.mode==="create"?(o(),c("section",Mt,[Ot,Rt,jt,e("div",At,[e("div",Et,[w("Valor estimado: "),e("span",Tt,r(i(k)(s.sell.estimated_value)),1)]),e("div",Ft,[w("Valor final: "),e("span",Nt,r(i(k)(s.sell.total_value)),1)]),e("div",Bt,[w("Desconto (%): "),e("span",Pt,r(p(s.sell.discount_percent,3))+"%",1)]),e("div",zt,[w("Desconto (R$): "),e("span",Gt,r(i(k)(s.sell.discount)),1)]),e("div",Qt,[Wt,e("div",Xt,[Zt,f(e("input",{id:"sell-entry-value",type:"number",step:"0.01",min:"0",autocomplete:"off",class:"block w-full rounded-md border-0 py-1.5 pl-9 text-gray-900 ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-green-600 sm:text-sm sm:leading-6 disabled:bg-gray-200",placeholder:"Valor de pagamneto de entrada",disabled:!s.sell.items_list.length||h.value,"onUpdate:modelValue":a[10]||(a[10]=t=>s.sell.entry_value=t),required:""},null,8,Ht),[[$,s.sell.entry_value]]),s.sell.errors.entry_value?(o(),c("p",Jt,r(s.sell.errors.entry_value),1)):m("",!0)])]),e("div",Kt,[Yt,e("div",es,[ts,e("input",{id:"sell-partial-value",type:"number",step:"0.01",min:"0",autocomplete:"off",class:"block w-full rounded-md border-0 py-1.5 pl-9 text-gray-900 ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-green-600 sm:text-sm sm:leading-6 disabled:bg-gray-200",placeholder:"Valor restante para pagamento posterior",disabled:!s.sell.items_list.length||h.value,value:p(T.value,2),readonly:"",required:""},null,8,ss),s.sell.errors.partial_value?(o(),c("p",as,r(s.sell.errors.partial_value),1)):m("",!0)])])])])):m("",!0)])],32)]),footer:V(()=>[s.modal.mode!=="see"?(o(),M(ie,{key:0,class:O({disabled:s.sell.processing}),onClick:a[11]||(a[11]=t=>d())},{default:V(()=>[w(" Cancelar ")]),_:1},8,["class"])):m("",!0),v(ne,{class:O({disabled:s.sell.processing||!U.value}),disabled:s.sell.processing||!U.value,onClick:a[12]||(a[12]=t=>x())},{default:V(()=>[w(r(s.modal.primary_button_txt),1)]),_:1},8,["class","disabled"])]),_:1},8,["show","maxWidth"]))}},os={class:"font-semibold text-xl text-gray-800 leading-tight"},ns={key:0},is={class:"pt-12 print:hidden print:pt-0"},rs={class:"max-w-7xl mx-auto sm:px-6 lg:px-8 print:w-full"},ds={class:"bg-white overflow-hidden shadow-xl sm:rounded-lg p-5"},cs={class:"flex flex-row items-center space-x-3"},us={class:"cursor-help select-none",title:"O campo de pesquisa ao lado filtra as informações carregadas na pagina. O formulário de pesquisa abaixo busca as informações filtradas no banco de dados e lista na página."},ms={class:"mt-3 grid grid-cols-3 gap-2"},ps={class:"col-span-3 md:col-span-1"},_s=e("label",{for:"search-by-entity-name",class:"block text-sm font-medium leading-6 text-gray-900"},"Cliente",-1),gs={class:"mt-2"},ys={key:0,class:"text-red-500 text-sm"},hs={class:"col-span-3 md:col-span-1"},xs=e("label",{for:"search-by-start-date",class:"block text-sm font-medium leading-6 text-gray-900"},"Data (início)",-1),vs={class:"mt-2"},fs={key:0,class:"text-red-500 text-sm"},bs={class:"col-span-3 md:col-span-1"},ws=e("label",{for:"search-by-end-date",class:"block text-sm font-medium leading-6 text-gray-900"},"Data (fim)",-1),$s={class:"mt-2"},ks={key:0,class:"text-red-500 text-sm"},qs=["href"],Vs={class:"py-12 print:py-6"},Cs={class:"max-w-7xl mx-auto print:max-w-full"},Ss={class:"px-0 print:px-0"},Is={class:"bg-white overflow-hidden shadow-xl sm:rounded-lg print:shadow-none"},Ds={class:"flex flex-col"},Us={class:"overflow-x-auto sm:-mx-6 lg:-mx-8"},Ls={class:"inline-block min-w-full py-2 sm:px-6 lg:px-8"},Ms={class:"overflow-hidden"},Os={class:"min-w-full text-left text-sm font-light"},Rs=e("thead",{class:"border-b font-medium"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-4 text-center"},"#"),e("th",{scope:"col",class:"px-6 py-4 text-center"},"Cliente"),e("th",{scope:"col",class:"px-6 py-4 text-center"},"À pagar"),e("th",{scope:"col",class:"px-6 py-4 text-center"},"Valor total"),e("th",{scope:"col",class:"px-6 py-4 text-center"},"Data da Venda "),e("th",{scope:"col",class:"px-6 py-4 text-center print:hidden",colspan:"2"}," Ações")])],-1),js={class:"border-b transition duration-300 ease-in-out hover:bg-neutral-100 print:break-inside-avoid"},As={class:"whitespace-nowrap py-4 text-center font-medium"},Es={class:"whitespace-normal px-6 py-4 text-center trim"},Ts=["title"],Fs={class:"whitespace-nowrap px-2 py-4 text-center"},Ns={class:"whitespace-nowrap px-2 py-4 text-center"},Bs={class:"whitespace-nowrap px-2 py-4 text-center print:hidden"},Ps=["title","onClick"],zs=["title","onClick"],Gs={key:1,class:"transition duration-300 ease-in-out hover:bg-neutral-100 print:break-inside-avoid"},Qs=e("td",{class:"whitespace-nowrap px-6 py-4 text-center",colspan:"9"},"Não há vendas cadastradas no momento!",-1),Ws=[Qs],da={__name:"Sells",props:{page:Object,page_options:{type:Array,default:null},sells_list:Object,items:Object,parameters:Object},setup(s){const q=s,R=K.useToast(),n=Z({id:null,client:"",date:W(),estimated_value:0,total_value:0,partial_value:0,discount_percent:0,discount:0,entry_value:0,observations:"",items_list:[]}),C=E(!1),_=Z({entity_name:q.parameters.entity_name,start_date:q.parameters.start_date,end_date:q.parameters.end_date}),U=E(""),T=D(()=>{const p=U.value.toLowerCase();return q.sells_list.filter(u=>{const{id:d,entity_name:x,observations:l,date:a,accounting:t,items:y}=u,{total_value:g,partial_value:A}=t,X=[d.toString(),(x==null?void 0:x.toLowerCase())??"",(l==null?void 0:l.toLowerCase())??"",(a==null?void 0:a.toLowerCase())??"",k(g).toLowerCase()??"",k(A).toLowerCase()??""];for(let N of X)if(N.includes(p))return!0;return y.some(N=>N.name.toLowerCase().includes(p))})}),h=D(()=>q.sells_list.reduce((p,u)=>p+u.accounting.partial_value,0)),b=E({mode:"create",show:!1,get title(){switch(this.mode){case"create":return"Criar venda";case"update":return"Editar venda";case"see":return"Ver informações da venda"}},get primary_button_txt(){switch(this.mode){case"create":return"Cadastrar";case"update":return"Atualizar";case"see":return"Fechar"}}}),S=(p,u=null)=>{const d=["update","see"].includes(p);if(u!==null&&d){const x=q.sells_list.find(l=>l.id===u);if(x){const{id:l,entity_name:a,date:t,observations:y,accounting:g,items:A}=x;n.id=l,n.client=a,n.date=t,n.estimated_value=g.estimated_value,n.total_value=g.total_value,n.partial_value=g.partial_value,n.entry_value=0,n.discount=g.estimated_value-g.total_value,n.discount_percent=n.discount/(g.estimated_value||1)*100,n.observations=y,n.items_list=A}}b.value.mode=p,b.value.show=!0},L=()=>{n.reset(),b.value.show=!1},F=()=>{n.post(route("sells.store"),{preserveScroll:!0,onSuccess:()=>L(),onError:p=>{console.log(p)}})},I=()=>{_.post(route("sells.filter"),{preserveScroll:!0})},P=()=>{n.put(route("sells.update",n.id),{preserveScroll:!0,onSuccess:()=>L()})},z=(p,u)=>{confirm(`Você tem certeza que deseja excluir a venda de material para "${u}"? Todos os materiais comprados voltarão para o estoque! Esta ação não poderá ser desfeita!`)&&n.delete(route("sells.destroy",p),{preserveScroll:!0,onSuccess:()=>R.success("Venda deletado com sucesso!")})},j=()=>{switch(b.value.mode){case"create":return F();case"update":return P();case"see":return L();default:R.error("Método desconhecido. Informar o Técnico.")}};return(p,u)=>(o(),c(B,null,[v(i(Y),{title:s.page.name},null,8,["title"]),v(le,{page:s.page,page_options:s.page_options},{header:V(()=>[e("h2",os,[w(r(s.page.name)+" ",1),p.$page.props.auth.user.hierarchy<2?(o(),c("span",ns,"| "+r(i(k)(h.value)),1)):m("",!0)]),v(ue,{icon:"plus",onClick:u[0]||(u[0]=d=>S("create")),title:"Cadastrar Sell",class:"print:hidden"})]),default:V(()=>[e("div",is,[e("div",rs,[e("div",ds,[e("div",cs,[v(i(me),{class:"w-5 y-5"}),f(e("input",{type:"text",name:"search_term",id:"search_term",autocomplete:"on",class:"simple-input",autofocus:"true",placeholder:"Pesquisar termo...","onUpdate:modelValue":u[1]||(u[1]=d=>U.value=d)},null,512),[[$,U.value]]),e("span",us,[v(i(pe),{class:"w-5 h-5"})]),C.value?(o(),c("span",{key:1,class:"select-none cursor-pointer",title:"Fechar opções de filtro",onClick:u[3]||(u[3]=d=>C.value=!1)},[v(i(ae),{class:"w-5 y-5"})])):(o(),c("span",{key:0,class:"select-none cursor-pointer",title:"Abrir opções de filtro",onClick:u[2]||(u[2]=d=>C.value=!0)},[v(i(se),{class:"w-5 y-5"})]))]),f(e("div",ms,[e("div",ps,[_s,e("div",gs,[f(e("input",{type:"text",name:"search-by-entity-name",id:"search-by-entity-name",class:"simple-input disabled:bg-gray-200",placeholder:"Filtrar por nome do cliente","onUpdate:modelValue":u[4]||(u[4]=d=>i(_).entity_name=d),onInput:I,required:""},null,544),[[$,i(_).entity_name]]),i(_).errors.entity_name?(o(),c("p",ys,r(i(_).errors.entity_name),1)):m("",!0)])]),e("div",hs,[xs,e("div",vs,[f(e("input",{type:"date",name:"search-by-start-date",id:"search-by-start-date",class:"simple-input disabled:bg-gray-200",placeholder:"Filtrar por período (início)","onUpdate:modelValue":u[5]||(u[5]=d=>i(_).start_date=d),onInput:I,required:""},null,544),[[$,i(_).start_date]]),i(_).errors.start_date?(o(),c("p",fs,r(i(_).errors.start_date),1)):m("",!0)])]),e("div",bs,[ws,e("div",$s,[f(e("input",{type:"date",name:"search-by-end-date",id:"search-by-end-date",class:"simple-input disabled:bg-gray-200",placeholder:"Filtrar por período (fim)","onUpdate:modelValue":u[6]||(u[6]=d=>i(_).end_date=d),onInput:I,required:""},null,544),[[$,i(_).end_date]]),i(_).errors.end_date?(o(),c("p",ks,r(i(_).errors.end_date),1)):m("",!0)])]),e("a",{href:p.route("sells.index"),class:"text-red-500 hover:text-red-700 active:text-red-900 text-sm select-none mt-2",onClick:u[7]||(u[7]=d=>i(_).reset())},"Resetar busca",8,qs)],512),[[ee,C.value]])])])]),e("div",Vs,[e("div",Cs,[e("div",Ss,[e("div",Is,[e("div",Ds,[e("div",Us,[e("div",Ls,[e("div",Ms,[e("table",Os,[Rs,e("tbody",null,[T.value.length?(o(!0),c(B,{key:0},Q(T.value,d=>(o(),c("tr",js,[e("td",As,r(d.id),1),e("td",Es,[w(r(d.entity_name)+" ",1),d.observations?(o(),c("span",{key:0,title:d.observations,class:"inline-flex items-center rounded-md bg-gray-50 px-2 py-1 text-xs font-medium text-gray-600 ring-1 ring-inset ring-gray-500/10 cursor-help"},"OBS",8,Ts)):m("",!0)]),e("td",Fs,r(i(k)(d.accounting.partial_value)),1),e("td",Ns,r(d.accounting.total_value>0?i(k)(d.accounting.total_value):"Pago"),1),e("td",Bs,r(i(W)(d.date,!0)),1),e("td",{class:"whitespace-nowrap px-4 py-4 text-center cursor-pointer hover:text-indigo-700 active:text-indigo-900 select-none print:hidden",title:"VER: Compra de "+d.entity_name,onClick:x=>S("see",d.id)},[v(i(H),{class:"w-5 h-5 m-auto"})],8,Ps),e("td",{class:"whitespace-nowrap px-4 py-4 text-center cursor-pointer hover:text-red-700 active:text-red-900 select-none print:hidden",title:"EXCLUIR: Compra de "+d.entity_name,onClick:x=>z(d.id,d.entity_name)},[v(i(ce),{class:"w-5 h-5 m-auto"})],8,zs)]))),256)):(o(),c("tr",Gs,Ws))])])])])])])])])])]),v(ls,{modal:b.value,sell:i(n),items:s.items,onSubmit:j,onClose:L},null,8,["modal","sell","items"])]),_:1},8,["page","page_options"])],64))}};export{da as default};
