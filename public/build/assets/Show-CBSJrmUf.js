import{e as a,o,a as e,m as I,d as L,T as G,l as R,b as l,u as d,Z as J,w as h,f as c,c as Z,j as y,g as m,F as _,h as A,n as k,t as s,q as H,z as U,x as f}from"./app-BFxaF4G7.js";import{_ as K}from"./AppLayout-CJldedpQ.js";/* empty css                    */import{t as p,f as B}from"./general-ILD4i3rA.js";import{r as Q,_ as W}from"./BudgetRejectionCancellationModal-rfspm5Hz.js";import{r as X}from"./XMarkIcon-Bu3932Y3.js";import{r as T}from"./XCircleIcon-U1V430Vf.js";import{r as Y}from"./DocumentDuplicateIcon-Be0IihZJ.js";import{r as ee}from"./PrinterIcon-DxrN6vNb.js";import{r as te}from"./ArrowUturnLeftIcon-CQTtVK5Y.js";import"./CreateUpdateModal-BJ2MGO-9.js";import"./Modal-AoLap7Zs.js";import"./PrimaryButton-CWfdoqT9.js";import"./SecondaryButton-DRAXVd-X.js";function se(t,b){return o(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"})])}function oe(t,b){return o(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})])}const re={class:"flex items-center justify-between"},ae={class:"font-semibold text-xl text-gray-800 leading-tight"},ne=e("span",null,"Voltar para Orçamentos",-1),ie={class:"py-12"},de={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},ce={class:"bg-white overflow-hidden shadow-xl sm:rounded-lg"},le={class:"p-6 lg:p-8 bg-white border-b border-gray-200"},ue={class:"flex flex-wrap gap-3 mb-6 border-b pb-4 items-center justify-between"},ge=e("h3",{class:"text-xl font-bold text-gray-700"},"Ações do Orçamento",-1),me={class:"flex flex-wrap gap-2 select-none"},be={key:0,class:"bg-gray-50 p-4 rounded-lg shadow-sm mb-6"},xe=e("h4",{class:"text-lg font-semibold text-gray-800 mb-3"},"Histórico de Recriações",-1),he={class:"flex flex-wrap gap-2 items-center"},fe={key:0,class:"text-gray-400"},pe=e("p",{class:"text-sm text-gray-500 mt-2"}," Clique para navegar entre os orçamentos da mesma cadeia de recriação. ",-1),ye={class:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6"},_e={class:"bg-gray-50 p-4 rounded-lg shadow-sm"},ve=e("h4",{class:"text-lg font-semibold text-gray-800 mb-3"},"Informações Gerais",-1),we={class:"grid grid-cols-2 gap-4"},ke=e("p",{class:"text-sm font-medium text-gray-500"},"Título:",-1),Ce={class:"text-sm text-gray-900 font-bold"},je=e("p",{class:"text-sm font-medium text-gray-500"},"Status:",-1),Ee=e("p",{class:"text-sm font-medium text-gray-500"},"Valor Total:",-1),Oe={class:"text-sm text-gray-900 font-bold"},Re=e("p",{class:"text-sm font-medium text-gray-500"},"Data do Orçamento:",-1),Ae={class:"text-sm text-gray-900"},Be=e("p",{class:"text-sm font-medium text-gray-500"},"Validade (dias):",-1),Te={class:"text-sm text-gray-900"},$e=e("p",{class:"text-sm font-medium text-gray-500"},"Tipo de Orçamento:",-1),Se={class:"text-sm text-gray-900"},De={key:0},Ne=e("p",{class:"text-sm font-medium text-gray-500"},"Orçamento Original:",-1),Me={key:1},Ve=e("p",{class:"text-sm font-medium text-gray-500"},"Serviço Gerado:",-1),ze=["href"],Pe={class:"bg-gray-50 p-4 rounded-lg shadow-sm"},qe=e("h4",{class:"text-lg font-semibold text-gray-800 mb-3"},"Informações do Cliente",-1),Fe={class:"grid grid-cols-2 gap-4"},Ie=e("p",{class:"text-sm font-medium text-gray-500"},"Nome do Cliente:",-1),Le={class:"text-sm text-gray-900"},Ge={key:0},Je=e("p",{class:"text-sm font-medium text-gray-500"},"Email:",-1),Ze={class:"text-sm text-gray-900"},He={key:1},Ue=e("p",{class:"text-sm font-medium text-gray-500"},"Telefone:",-1),Ke={class:"text-sm text-gray-900"},Qe={key:2},We=e("p",{class:"text-sm font-medium text-gray-500"},"CPF/CNPJ:",-1),Xe={class:"text-sm text-gray-900"},Ye={key:3},et=e("p",{class:"text-sm font-medium text-gray-500"},"Endereço:",-1),tt={class:"text-sm text-gray-900"},st={key:4},ot=e("p",{class:"text-sm font-medium text-gray-500"},"CEP:",-1),rt={class:"text-sm text-gray-900"},at={key:1,class:"bg-gray-50 p-4 rounded-lg shadow-sm col-span-2 mb-5"},nt={class:"text-lg font-semibold text-gray-800 mb-3"},it={key:0},dt={key:1},ct={class:"text-sm font-medium text-gray-500"},lt={class:"bg-white p-4 rounded-lg shadow-sm mb-6 border border-gray-200"},ut=e("h4",{class:"text-lg font-semibold text-gray-800 mb-3"},"Itens do Orçamento",-1),gt={class:"overflow-x-auto"},mt={class:"min-w-full divide-y divide-gray-200"},bt=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Item"),e("th",{scope:"col",class:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"}," Preço")])],-1),xt={class:"bg-white divide-y divide-gray-200"},ht={class:"px-6 py-4 text-sm text-gray-900"},ft={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-bold text-gray-900"},pt={class:"mt-4 flex justify-end items-center space-x-4 text-sm"},yt=e("p",{class:"text-gray-600"},"Desconto:",-1),_t={class:"font-semibold text-red-600"},vt=e("p",{class:"text-gray-600"},"Acréscimo:",-1),wt={class:"font-semibold text-green-600"},kt=e("p",{class:"text-gray-800 text-lg font-bold"},"Total Final:",-1),Ct={class:"text-gray-900 text-lg font-bold"},jt={key:2,class:"bg-gray-50 p-4 rounded-lg shadow-sm mb-6"},Et=e("h4",{class:"text-lg font-semibold text-gray-800 mb-3"},"Observações",-1),Ot={class:"text-sm text-gray-900 whitespace-pre-wrap"},Rt={class:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6"},At={class:"bg-gray-50 p-4 rounded-lg shadow-sm"},Bt=e("h4",{class:"text-lg font-semibold text-gray-800 mb-3"},"Prazos e Responsabilidades",-1),Tt={class:"space-y-2"},$t=e("p",{class:"text-sm font-medium text-gray-500"},"Prazo de Entrega:",-1),St={class:"text-sm text-gray-900"},Dt=e("p",{class:"text-sm font-medium text-gray-500"},"Início do Prazo:",-1),Nt={class:"text-sm text-gray-900 whitespace-pre-wrap"},Mt=e("p",{class:"text-sm font-medium text-gray-500"},"Responsabilidade do Contratado: ",-1),Vt={class:"text-sm text-gray-900 whitespace-pre-wrap"},zt={key:0},Pt=e("p",{class:"text-sm font-medium text-gray-500"},"Responsabilidade do Contratante: ",-1),qt={class:"text-sm text-gray-900 whitespace-pre-wrap"},Ft={class:"bg-gray-50 p-4 rounded-lg shadow-sm"},It=e("h4",{class:"text-lg font-semibold text-gray-800 mb-3"},"Informações Financeiras",-1),Lt={class:"space-y-2"},Gt=e("p",{class:"text-sm font-medium text-gray-500"},"Método de Pagamento:",-1),Jt={class:"text-sm text-gray-900 whitespace-pre-wrap"},Zt=e("p",{class:"text-sm font-medium text-gray-500"},"Informações Bancárias:",-1),Ht={class:"text-sm text-gray-900 whitespace-pre-wrap"},ds={__name:"Show",props:{page:Object,budget:Object,budgetChain:Array,currentBudgetId:Number},setup(t){const b=t,g=I.useToast(),v=L(!1),u=G({id:null,rejection_reason:null,cancellation_reason:null,actionType:null}),C=R(()=>[...b.budgetChain].sort((n,r)=>new Date(n.created_at)-new Date(r.created_at))),j=(n,r)=>{u.id=n,u.actionType=r,u.rejection_reason=null,u.cancellation_reason=null,v.value=!0},w=()=>{v.value=!1,u.reset()},$=()=>{u.actionType==="reject"?N(u.id,u.rejection_reason):u.actionType==="cancel"&&M(u.id,u.cancellation_reason)},S=()=>{confirm("Tem certeza que deseja APROVAR este orçamento e gerar um serviço?")&&f.post(route("budgets.approve",b.budget.id),{},{preserveScroll:!0,onSuccess:()=>g.success("Orçamento aprovado e serviço gerado!"),onError:n=>{console.error(n),g.error(n.message||"Erro ao aprovar orçamento.")}})},D=()=>{confirm("Tem certeza que deseja marcar este orçamento como ENVIADO?")&&f.post(route("budgets.send",b.budget.id),{},{preserveScroll:!0,onSuccess:()=>g.success("Orçamento marcado como enviado!"),onError:n=>{console.error(n),g.error(n.message||"Erro ao marcar como enviado.")}})},N=(n,r)=>{if(!r||r.length<10){g.error("O motivo da rejeição deve ter pelo menos 10 caracteres.");return}confirm("Tem certeza que deseja REJEITAR este orçamento?")&&f.post(route("budgets.reject",n),{rejection_reason:r},{preserveScroll:!0,onSuccess:()=>{g.success("Orçamento rejeitado!"),w()},onError:x=>{console.error(x),g.error(x.message||"Erro ao rejeitar orçamento.")}})},M=(n,r)=>{if(!r||r.length<10){g.error("O motivo do cancelamento deve ter pelo menos 10 caracteres.");return}confirm("Tem certeza que deseja CANCELAR este orçamento?")&&f.post(route("budgets.cancel",n),{cancellation_reason:r},{preserveScroll:!0,onSuccess:()=>{g.success("Orçamento cancelado!"),w()},onError:x=>{console.error(x),g.error(x.message||"Erro ao cancelar orçamento.")}})},V=()=>{confirm("Tem certeza que deseja DUPLICAR este orçamento? Isso criará um NOVO orçamento sem vínculo.")&&f.get(route("budgets.create",{duplicate_from:b.budget.id}))},z=()=>{confirm('Tem certeza que deseja RECRIAR este orçamento? O orçamento atual será CANCELADO e um NOVO orçamento será criado como "Correção" vinculado a este.')&&f.post(route("budgets.recreate",b.budget.id),{},{preserveScroll:!0,onError:n=>{console.error(n),g.error(n.message||"Erro ao recriar orçamento.")}})},P=()=>{window.open(route("budgets.print",b.budget.id),"_blank")},q=R(()=>{switch(b.budget.status){case"Rascunho":return"bg-gray-100 text-gray-800";case"Enviado":return"bg-blue-100 text-blue-800";case"Aprovado":return"bg-green-100 text-green-800";case"Rejeitado":return"bg-orange-100 text-orange-800";case"Cancelado":return"bg-red-100 text-red-800";case"Expirado":return"bg-purple-100 text-purple-800";default:return"bg-gray-100 text-gray-800"}});return(n,r)=>(o(),a(_,null,[l(d(J),{title:`Orçamento #${t.budget.id}`},null,8,["title"]),l(K,{page:t.page},{header:h(()=>[e("div",re,[e("h2",ae," Detalhes do Orçamento #"+s(t.budget.id),1),l(d(y),{href:n.route("budgets.index"),class:"text-gray-600 hover:text-gray-900 flex items-center space-x-2"},{default:h(()=>[l(d(te),{class:"w-4 h-4"}),ne]),_:1},8,["href"])])]),default:h(()=>{var x,E,O;return[e("div",ie,[e("div",de,[e("div",ce,[e("div",le,[e("div",ue,[ge,e("div",me,[["Rascunho"].includes(t.budget.status)?(o(),Z(d(y),{key:0,href:n.route("budgets.edit",t.budget.id),class:"inline-flex items-center px-2 py-1 bg-yellow-500 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-yellow-600 focus:bg-yellow-600 active:bg-yellow-700 focus:outline-none focus:ring-2 focus:ring-yellow-500 focus:ring-offset-2 transition ease-in-out duration-150"},{default:h(()=>[l(d(X),{class:"w-4 h-4 mr-2"}),m(" Editar ")]),_:1},8,["href"])):c("",!0),["Rascunho"].includes(t.budget.status)?(o(),a("button",{key:1,onClick:r[0]||(r[0]=i=>D()),class:"inline-flex items-center px-2 py-1 bg-blue-500 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-blue-600 focus:bg-blue-600 active:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition ease-in-out duration-150"},[l(d(Q),{class:"w-4 h-4 mr-2"}),m(" Marcar como Enviado ")])):c("",!0),["Enviado"].includes(t.budget.status)?(o(),a("button",{key:2,onClick:r[1]||(r[1]=i=>j(t.budget.id,"reject")),class:"inline-flex items-center px-2 py-1 bg-orange-500 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-orange-600 focus:bg-orange-600 active:bg-orange-700 focus:outline-none focus:ring-2 focus:ring-orange-500 focus:ring-offset-2 transition ease-in-out duration-150"},[l(d(T),{class:"w-4 h-4 mr-2"}),m(" Rejeitar ")])):c("",!0),["Enviado"].includes(t.budget.status)?(o(),a("button",{key:3,onClick:r[2]||(r[2]=i=>S()),class:"inline-flex items-center px-2 py-1 bg-green-500 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-green-600 focus:bg-green-600 active:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition ease-in-out duration-150"},[l(d(oe),{class:"w-4 h-4 mr-2"}),m(" Aprovar ")])):c("",!0),e("button",{onClick:r[3]||(r[3]=i=>V()),class:"inline-flex items-center px-2 py-1 bg-purple-500 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-purple-600 focus:bg-purple-600 active:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2 transition ease-in-out duration-150"},[l(d(Y),{class:"w-4 h-4 mr-2"}),m(" Duplicar (Novo) ")]),["Enviado"].includes(t.budget.status)?(o(),a("button",{key:4,onClick:r[4]||(r[4]=i=>z()),class:"inline-flex items-center px-2 py-1 bg-indigo-500 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-indigo-600 focus:bg-indigo-600 active:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition ease-in-out duration-150"},[l(d(se),{class:"w-4 h-4 mr-2"}),m(" Recriar (Revisão) ")])):c("",!0),e("button",{onClick:r[5]||(r[5]=i=>P()),class:"inline-flex items-center px-2 py-1 bg-gray-500 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-gray-600 focus:bg-gray-600 active:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 transition ease-in-out duration-150"},[l(d(ee),{class:"w-4 h-4 mr-2"}),m(" Imprimir ")]),!["Aprovado","Rejeitado","Cancelado"].includes(t.budget.status)&&n.$page.props.auth.user.hierarchy<2?(o(),a("button",{key:5,onClick:r[6]||(r[6]=i=>j(t.budget.id,"cancel")),class:"inline-flex items-center px-2 py-1 bg-red-500 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-red-600 focus:bg-red-600 active:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 transition ease-in-out duration-150"},[l(d(T),{class:"w-4 h-4 mr-2"}),m(" Cancelar Orçamento ")])):c("",!0)])]),t.budgetChain&&t.budgetChain.length>1?(o(),a("div",be,[xe,e("div",he,[(o(!0),a(_,null,A(C.value,(i,F)=>(o(),a(_,{key:i.id},[l(d(y),{href:n.route("budgets.show",i.id),"preserve-scroll":"",class:k(["px-3 py-1 rounded-full text-xs font-semibold transition ease-in-out duration-150",{"bg-teal-600 text-white shadow-md":i.id===t.currentBudgetId,"bg-gray-200 text-gray-700 hover:bg-gray-300":i.id!==t.currentBudgetId}])},{default:h(()=>[m(s(i.title)+" (#"+s(i.id)+") ",1),e("span",{class:k(["ml-1",{"text-red-300":i.status==="Cancelado","text-orange-300":i.status==="Rejeitado","text-green-300":i.status==="Aprovado","text-blue-300":i.status==="Enviado","text-neutral-300":i.status==="Rascunho"}])}," ("+s(i.status)+") ",3)]),_:2},1032,["href","class"]),F<C.value.length-1?(o(),a("span",fe,"→")):c("",!0)],64))),128))]),pe])):c("",!0),e("div",ye,[e("div",_e,[ve,e("div",we,[e("div",null,[ke,e("p",Ce,s(t.budget.title),1)]),e("div",null,[je,e("span",{class:k(["px-2.5 py-0.5 rounded-full text-xs font-medium",q.value])},s(t.budget.status),3)]),e("div",null,[Ee,e("p",Oe,s(d(p)(t.budget.total_value)),1)]),e("div",null,[Re,e("p",Ae,s(d(B)(t.budget.budget_date,!0)),1)]),e("div",null,[Be,e("p",Te,s(t.budget.validity),1)]),e("div",null,[$e,e("p",Se,s(t.budget.budget_type),1)]),t.budget.original_budget_id?(o(),a("div",De,[Ne,l(d(y),{href:n.route("budgets.show",t.budget.original_budget_id),class:"text-sm text-blue-600 hover:underline"},{default:h(()=>[m(" #"+s(t.budget.original_budget_id),1)]),_:1},8,["href"])])):c("",!0),t.budget.generated_service_id?(o(),a("div",Me,[Ve,e("a",{href:n.route("services.show",t.budget.generated_service_id),target:"_blank",class:"text-sm text-blue-600 hover:underline"}," Ver Serviço #"+s(t.budget.generated_service_id),9,ze)])):c("",!0)])]),e("div",Pe,[qe,e("div",Fe,[e("div",null,[Ie,e("p",Le,s(t.budget.client_name),1)]),t.budget.client_email?(o(),a("div",Ge,[Je,e("p",Ze,s(t.budget.client_email),1)])):c("",!0),t.budget.client_phone?(o(),a("div",He,[Ue,e("p",Ke,s(t.budget.client_phone),1)])):c("",!0),t.budget.client_cpf_cnpj?(o(),a("div",Qe,[We,e("p",Xe,s(t.budget.client_cpf_cnpj),1)])):c("",!0),t.budget.client_address?(o(),a("div",Ye,[et,e("p",tt,s(t.budget.client_address),1)])):c("",!0),t.budget.client_cep?(o(),a("div",st,[ot,e("p",rt,s(t.budget.client_cep),1)])):c("",!0)])])]),t.budget.rejection_reason?(o(),a("div",at,[e("h4",nt,[m("Motivo "),(x=t.budget.deleted_at)!=null&&x.length?(o(),a("span",it,"do Cancelamento")):(o(),a("span",dt,"da Rejeição"))]),e("p",ct,s(t.budget.rejection_reason),1),H(e("p",{class:"text-sm font-medium text-gray-500"},"Data do cancelamento: "+s(d(B)(t.budget.deleted_at,"read")),513),[[U,(E=t.budget.deleted_at)==null?void 0:E.length]])])):c("",!0),e("div",lt,[ut,e("div",gt,[e("table",mt,[bt,e("tbody",xt,[(o(!0),a(_,null,A(t.budget.items,i=>(o(),a("tr",{key:i.id},[e("td",ht,s(i.item_name),1),e("td",ft,s(d(p)(i.subtotal)),1)]))),128))])])]),e("div",pt,[yt,e("p",_t,s(d(p)(t.budget.discount_amount)),1),vt,e("p",wt,s(d(p)(t.budget.additional_amount)),1),kt,e("p",Ct,s(d(p)(t.budget.total_value)),1)])]),(O=t.budget)!=null&&O.description?(o(),a("div",jt,[Et,e("p",Ot,s(t.budget.description),1)])):c("",!0),e("div",Rt,[e("div",At,[Bt,e("div",Tt,[e("div",null,[$t,e("p",St,s(t.budget.deadline)+" "+s(t.budget.deadline_type),1)]),e("div",null,[Dt,e("p",Nt,s(t.budget.deadline_start_description),1)]),e("div",null,[Mt,e("p",Vt,s(t.budget.contracted_responsibility),1)]),t.budget.contractor_responsibility?(o(),a("div",zt,[Pt,e("p",qt,s(t.budget.contractor_responsibility),1)])):c("",!0)])]),e("div",Ft,[It,e("div",Lt,[e("div",null,[Gt,e("p",Jt,s(t.budget.payment_method_description),1)]),e("div",null,[Zt,e("p",Ht,s(t.budget.bank_info_description),1)])])])])])])])]),l(W,{show:v.value,budget:d(u),onSubmit:$,onClose:w},null,8,["show","budget"])]}),_:1},8,["page"])],64))}};export{ds as default};
