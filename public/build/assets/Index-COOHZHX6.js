import{m as W,d as g,y as X,x,T as Y,e as n,o as r,b as c,u as l,Z as b,w as C,a as t,f as p,q as F,v as ee,s as te,F as j,h as L,t as a,n as U,j as z,g as $}from"./app-CZkq5Z-4.js";import{_ as se}from"./AppLayout-D2xbGot6.js";import{t as oe,f as N}from"./general-NIAW1A15.js";/* empty css                    */import{r as ae,_ as ne}from"./BudgetRejectionCancellationModal-DchkoEiA.js";import{_ as re}from"./FloatButton-DfXhYRoG.js";import{r as ie}from"./MagnifyingGlassIcon-G4Sq5WzV.js";import{r as le}from"./EyeIcon-DZjMa3-U.js";import{r as ce,a as de}from"./XMarkIcon-BdHH6tt4.js";import{r as pe}from"./DocumentDuplicateIcon-DcoA8-9j.js";import{r as me,a as he}from"./ChevronRightIcon-CUJTnc2t.js";import"./CreateUpdateModal-BgXUm0af.js";import"./Modal-BmwXH8cy.js";import"./PrimaryButton-d3GyyHQH.js";import"./SecondaryButton-BvordoBr.js";import"./PlusIcon-BzKLYwAn.js";import"./PrinterIcon-4_hv0DdK.js";const ue={class:"font-semibold text-xl text-gray-800 leading-tight"},_e={class:"pt-12 print:hidden print:pt-0"},xe={class:"max-w-7xl mx-auto sm:px-6 lg:px-8 print:w-full"},fe={class:"bg-white overflow-hidden shadow-xl sm:rounded-lg p-5"},ve={class:"flex flex-col sm:flex-row sm:items-center space-y-4 sm:space-y-0 sm:space-x-4"},ye={class:"flex items-center space-x-3 flex-grow"},we={class:"flex items-center space-x-2"},ge=t("label",{for:"status_filter",class:"text-sm font-medium text-gray-700 whitespace-nowrap"},"Status:",-1),Ce=t("option",{value:""},"Todos",-1),je=t("option",{value:"Rascunho"},"Rascunho",-1),ke=t("option",{value:"Enviado"},"Enviado",-1),$e=t("option",{value:"Aprovado"},"Aprovado",-1),Ee=t("option",{value:"Rejeitado"},"Rejeitado",-1),Te=t("option",{value:"Cancelado"},"Cancelado",-1),Oe=[Ce,je,ke,$e,Ee,Te],Ae={class:"py-12 print:py-0"},Se={class:"min-w-7xl max-w-fit mx-auto print:max-w-full"},Re={class:"w-full flex justify-end pb-3 print:hidden px-6 sm:px-0"},ze={class:"px-0 sm:px-0 print:px-0"},Ne={class:"bg-white sm:rounded-xl print:shadow-none"},Me={class:"flex flex-col"},Pe={class:"overflow-x-auto"},Ve={class:"inline-block min-w-full"},Be={class:"overflow-hidden"},De={class:"max-w-fit text-left text-sm font-light"},qe={class:"border-b bg-gray-50 font-medium"},Ie=t("th",{scope:"col",class:"px-6 py-3 text-center"},"#",-1),Fe=t("th",{scope:"col",class:"px-6 py-3 text-left"},"Titulo",-1),Le=t("th",{scope:"col",class:"px-6 py-3 text-left"},"Cliente",-1),Ue=t("th",{scope:"col",class:"px-6 py-3 text-left"},"Itens",-1),Je=t("th",{scope:"col",class:"px-6 py-3 text-center"},"Valor Total",-1),Ze=t("th",{scope:"col",class:"px-6 py-3 text-center"},"Data Orçamento",-1),Ge=t("th",{scope:"col",class:"px-6 py-3 text-center"},"Status",-1),He=t("th",{scope:"col",class:"px-6 py-3 text-center print:hidden"},"Ações ",-1),Ke={key:0,scope:"col",class:"px-6 py-3 text-center print:hidden"},Qe={key:1,scope:"col",class:"px-6 py-3 text-center print:hidden"},We={key:2,scope:"col",class:"px-6 py-3 text-center print:hidden"},Xe={key:3,scope:"col",class:"px-6 py-3 text-center print:hidden"},Ye={class:"whitespace-nowrap px-6 py-4 text-center font-medium"},be={class:"whitespace-nowrap px-6 py-4 text-left"},et={class:"whitespace-nowrap px-6 py-4 text-left"},tt=["title"],st={class:"max-w-xs truncate"},ot={class:"whitespace-nowrap px-6 py-4 text-center"},at={class:"whitespace-nowrap px-6 py-4 text-center"},nt={class:"whitespace-nowrap px-6 py-4 text-center"},rt={class:"whitespace-nowrap px-6 py-4 text-center print:hidden"},it={class:"flex justify-center items-center space-x-5"},lt=["onClick"],ct=["onClick"],dt=["onClick"],pt={key:0,class:"whitespace-nowrap px-6 py-4 text-center print:hidden"},mt={key:1,class:"whitespace-nowrap px-6 py-4 text-center print:hidden"},ht={key:2,class:"whitespace-nowrap px-6 py-4 text-center print:hidden"},ut={key:3,class:"whitespace-nowrap px-6 py-4 text-center print:hidden"},_t={key:1},xt=t("td",{colspan:"10",class:"whitespace-nowrap px-6 py-4 text-center text-gray-500"}," Nenhum orçamento encontrado. ",-1),ft=[xt],vt={key:0,class:"flex items-center justify-between border-t border-gray-200 bg-white px-4 py-3 sm:px-6 mt-6"},yt={class:"flex flex-1 justify-between sm:hidden"},wt=["href","disabled"],gt=["href","disabled"],Ct={class:"hidden sm:flex sm:flex-1 sm:items-center sm:justify-between"},jt={class:"text-sm text-gray-700"},kt={class:"font-medium"},$t={class:"font-medium"},Et={class:"font-medium"},Tt={class:"isolate inline-flex -space-x-px rounded-md shadow-xs","aria-label":"Pagination"},Ot=["href","disabled"],At=t("span",{class:"sr-only"},"Previous",-1),St=["href","disabled","onClick"],Rt={key:1,class:"relative inline-flex items-center px-4 py-2 text-sm font-semibold text-gray-700 ring-1 ring-gray-300 ring-inset focus:outline-offset-0"},zt=["href","disabled"],Nt=t("span",{class:"sr-only"},"Next",-1),Xt={__name:"Index",props:{page:Object,budgets_list:Object,filters:Object},setup(o){const E=o,h=W.useToast(),f=g(E.filters.search||""),v=g(E.filters.status||""),T=g(E.filters.client||"");let O=null;X([f,v,T],()=>{O&&clearTimeout(O),O=setTimeout(()=>{x.get(route("budgets.index"),{search:f.value,status:v.value,client:T.value},{preserveState:!0,replace:!0})},300)});const d=g(!1),A=g(!1),m=Y({id:null,rejection_reason:null,cancellation_reason:null,actionType:null}),J=(i,s)=>{m.id=i,m.actionType=s,m.rejection_reason=null,m.cancellation_reason=null,A.value=!0},S=()=>{A.value=!1,m.reset()},Z=()=>{m.actionType==="reject"?G(m.id,m.rejection_reason):m.actionType==="cancel"&&H(m.id,m.cancellation_reason)},G=(i,s)=>{if(!s||s.length<10){h.error("O motivo da rejeição deve ter pelo menos 10 caracteres.");return}confirm("Tem certeza que deseja REJEITAR este orçamento?")&&x.post(route("budgets.reject",i),{rejection_reason:s},{preserveScroll:!0,onSuccess:()=>{h.success("Orçamento rejeitado!"),S()},onError:u=>{console.error(u),h.error(u.message||"Erro ao rejeitar orçamento.")}})},H=(i,s)=>{if(!s||s.length<10){h.error("O motivo do cancelamento deve ter pelo menos 10 caracteres.");return}confirm("Tem certeza que deseja CANCELAR este orçamento?")&&x.post(route("budgets.cancel",i),{cancellation_reason:s},{preserveScroll:!0,onSuccess:()=>{h.success("Orçamento cancelado!"),S()},onError:u=>{console.error(u),h.error(u.message||"Erro ao cancelar orçamento.")}})},K=i=>{confirm("Tem certeza que deseja DUPLICAR este orçamento?")&&x.get(route("budgets.create",{duplicate_from:i}))},Q=i=>{confirm("Tem certeza que deseja marcar este orçamento como ENVIADO?")&&x.post(route("budgets.send",i),{},{preserveScroll:!0,onSuccess:()=>h.success("Orçamento marcado como enviado!"),onError:s=>{console.error(s),h.error(s.message||"Erro ao marcar como enviado.")}})},y=i=>{i&&x.get(i,{search:f.value,status:v.value,client:T.value},{preserveState:!0,replace:!0})};return(i,s)=>{var u;return r(),n(j,null,[c(l(b),{title:(u=o.page)==null?void 0:u.name},null,8,["title"]),c(se,{page:o.page},{header:C(()=>{var w;return[t("h2",ue,a((w=o.page)==null?void 0:w.name),1),c(l(z),{href:i.route("budgets.create")},{default:C(()=>[c(re,{icon:"plus",title:"Cadastrar Orçamento",class:"print:hidden"})]),_:1},8,["href"])]}),default:C(()=>{var w,M;return[t("div",_e,[t("div",xe,[t("div",fe,[t("div",ve,[t("div",ye,[c(l(ie),{class:"w-4 h-4 text-gray-500"}),F(t("input",{type:"text",name:"search_term",id:"search_term",autocomplete:"on",class:"simple-input flex-grow",autofocus:"true",placeholder:"Pesquisar termo...","onUpdate:modelValue":s[0]||(s[0]=e=>f.value=e)},null,512),[[ee,f.value]])]),t("div",we,[ge,F(t("select",{id:"status_filter","onUpdate:modelValue":s[1]||(s[1]=e=>v.value=e),class:"simple-input"},Oe,512),[[te,v.value]])])])])])]),t("div",Ae,[t("div",Se,[t("div",Re,[d.value?p("",!0):(r(),n("button",{key:0,class:"text-blue-500 text-xs",onClick:s[2]||(s[2]=e=>d.value=!d.value)},"Mostrar dados de usuário")),d.value?(r(),n("button",{key:1,class:"text-red-500 text-xs",onClick:s[3]||(s[3]=e=>d.value=!d.value)},"Esconder dados de usuário")):p("",!0)]),t("div",ze,[t("div",Ne,[t("div",Me,[t("div",Pe,[t("div",Ve,[t("div",Be,[t("table",De,[t("thead",qe,[t("tr",null,[Ie,Fe,Le,Ue,Je,Ze,Ge,He,d.value?(r(),n("th",Ke,"Criado Em")):p("",!0),d.value?(r(),n("th",Qe,"Criado Por")):p("",!0),d.value?(r(),n("th",We,"Modificado Em")):p("",!0),d.value?(r(),n("th",Xe,"Modificado Por")):p("",!0)])]),t("tbody",null,[(M=(w=o.budgets_list)==null?void 0:w.data)!=null&&M.length?(r(!0),n(j,{key:0},L(o.budgets_list.data,e=>{var k,R,P,V,B,D,q,I;return r(),n("tr",{key:e==null?void 0:e.id,class:"border-b transition duration-300 ease-in-out hover:bg-neutral-100"},[t("td",Ye,a(e==null?void 0:e.id),1),t("td",be,a(e==null?void 0:e.title),1),t("td",et,a(e==null?void 0:e.client_name),1),t("td",{class:"whitespace-nowrap px-6 py-4 text-left",title:(k=e==null?void 0:e.items)==null?void 0:k.map(_=>_.item_name).join("; ")},[t("div",st,a((R=e==null?void 0:e.items)==null?void 0:R.map(_=>_.item_name).join("; ")),1)],8,tt),t("td",ot,a(l(oe)(e==null?void 0:e.total_value)),1),t("td",at,a(l(N)(e==null?void 0:e.budget_date,!0)),1),t("td",nt,[t("span",{class:U(["px-2.5 py-0.5 rounded-full text-xs font-medium",{"bg-gray-100 text-gray-800":(e==null?void 0:e.status)==="Rascunho","bg-blue-100 text-blue-800":(e==null?void 0:e.status)==="Enviado","bg-green-100 text-green-800":(e==null?void 0:e.status)==="Aprovado","bg-orange-100 text-orange-800":(e==null?void 0:e.status)==="Rejeitado","bg-red-100 text-red-800":(e==null?void 0:e.status)==="Cancelado"}])},a(e==null?void 0:e.status),3)]),t("td",rt,[t("div",it,[c(l(z),{href:i.route("budgets.show",e==null?void 0:e.id),class:"hover:text-blue-700",title:"Ver Orçamento"},{default:C(()=>[c(l(le),{class:"w-4 h-4"})]),_:2},1032,["href"]),["Rascunho"].includes(e==null?void 0:e.status)&&!(e!=null&&e.generated_service_id)?(r(),n(j,{key:0},[c(l(z),{href:i.route("budgets.edit",e==null?void 0:e.id),class:"hover:text-yellow-700",title:"Editar Orçamento"},{default:C(()=>[c(l(ce),{class:"w-4 h-4"})]),_:2},1032,["href"]),t("button",{onClick:_=>Q(e.id),class:"hover:text-blue-700",title:"Enviar Orçamento"},[c(l(ae),{class:"w-4 h-4"})],8,lt)],64)):p("",!0),t("button",{onClick:_=>K(e==null?void 0:e.id),class:"hover:text-purple-700",title:"Duplicar Orçamento"},[c(l(pe),{class:"w-4 h-4"})],8,ct),!["Aprovado","Rejeitado","Cancelado"].includes(e==null?void 0:e.status)&&((P=i.$page.props.auth.user)==null?void 0:P.hierarchy)<2?(r(),n("button",{key:1,onClick:_=>J(e==null?void 0:e.id,"cancel"),class:"hover:text-red-700",title:"Cancelar Orçamento"},[c(l(de),{class:"w-4 h-4"})],8,dt)):p("",!0)])]),d.value?(r(),n("td",pt,a(l(N)(e.created_at,"reading_date_time")),1)):p("",!0),d.value?(r(),n("td",mt,a(((B=(V=e.procedures[0])==null?void 0:V.user)==null?void 0:B.name)||"-"),1)):p("",!0),d.value?(r(),n("td",ht,a(l(N)(e.updated_at,"reading_date_time")),1)):p("",!0),d.value?(r(),n("td",ut,a(((I=(q=e.procedures[((D=e.procedures)==null?void 0:D.length)-1])==null?void 0:q.user)==null?void 0:I.name)||"-"),1)):p("",!0)])}),128)):(r(),n("tr",_t,ft))])])])])])])])])])]),o.budgets_list.links.length>3?(r(),n("div",vt,[t("div",yt,[t("button",{href:o.budgets_list.prev_page_url,disabled:!o.budgets_list.prev_page_url,onClick:s[4]||(s[4]=e=>y(o.budgets_list.prev_page_url)),class:"relative inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50"},"Previous",8,wt),t("button",{href:o.budgets_list.next_page_url,disabled:!o.budgets_list.next_page_url,onClick:s[5]||(s[5]=e=>y(o.budgets_list.next_page_url)),class:"relative ml-3 inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50"},"Next",8,gt)]),t("div",Ct,[t("div",null,[t("p",jt,[$(" Showing "+a(" ")+" "),t("span",kt,a(o.budgets_list.from),1),$(" "+a(" ")+" to "+a(" ")+" "),t("span",$t,a(o.budgets_list.to),1),$(" "+a(" ")+" of "+a(" ")+" "),t("span",Et,a(o.budgets_list.total),1),$(" "+a(" ")+" results ")])]),t("div",null,[t("nav",Tt,[t("button",{href:o.budgets_list.prev_page_url,disabled:!o.budgets_list.prev_page_url,onClick:s[6]||(s[6]=e=>y(o.budgets_list.prev_page_url)),class:"relative inline-flex items-center rounded-l-md px-2 py-2 text-gray-400 ring-1 ring-gray-300 ring-inset hover:bg-gray-50 focus:z-20 focus:outline-offset-0"},[At,c(l(me),{class:"size-5","aria-hidden":"true"})],8,Ot),(r(!0),n(j,null,L(o.budgets_list.links,(e,k)=>(r(),n(j,null,[e.url&&!["« Previous","Next »","..."].includes(e.label)?(r(),n("button",{key:k,href:e.url,disabled:!e.url,onClick:R=>y(e.url),"aria-current":"page",class:U(["relative inline-flex items-center px-4 py-2 text-sm font-semibold focus:z-20 focus-visible:outline-2 focus-visible:outline-offset-2",{"z-10 bg-indigo-600 text-white focus-visible:outline-indigo-600":e.active,"text-gray-900 ring-1 ring-gray-300 ring-inset hover:bg-gray-50 focus:outline-offset-0":!e.active}])},a(e.label),11,St)):!e.url&&e.label==="..."?(r(),n("span",Rt,"...")):p("",!0)],64))),256)),t("button",{href:o.budgets_list.next_page_url,disabled:!o.budgets_list.next_page_url,onClick:s[7]||(s[7]=e=>y(o.budgets_list.next_page_url)),class:"relative inline-flex items-center rounded-r-md px-2 py-2 text-gray-400 ring-1 ring-gray-300 ring-inset hover:bg-gray-50 focus:z-20 focus:outline-offset-0"},[Nt,c(l(he),{class:"size-5","aria-hidden":"true"})],8,zt)])])])])):p("",!0),c(ne,{show:A.value,budget:l(m),onSubmit:Z,onClose:S},null,8,["show","budget"])]}),_:1},8,["page"])],64)}}};export{Xt as default};
