import{k as y,T as O,r as F,c as f,o as s,w as x,b as w,n as k,f as $,t as c,a as e,h as L,d as a,e as l,s as p,v as _,u as r,x as M,F as X,g as G}from"./app-nxAEGYom.js";import{_ as H}from"./CreateUpdateModal-Cr9-t6ta.js";import{_ as J}from"./PrimaryButton-DeVtbJBJ.js";import{_ as K}from"./SecondaryButton-BQZMIPc2.js";import{f as b,t as V,j as Q}from"./general-D_37hS-e.js";import{_ as W}from"./ClientSelector-CaM6P7Eb.js";import{r as Y}from"./XMarkIcon-B7I7P2AW.js";import{r as Z}from"./PlusIcon-C0zORJhm.js";import{r as ee}from"./PencilIcon-BWmfVFjA.js";import{r as te}from"./BanknotesIcon-BbnfpIH-.js";const oe={class:"pb-12 space-y-12 divide-y-2"},se={class:"py-4"},ae=e("h2",{class:"text-base font-semibold leading-7 text-gray-900"},"Informações Básicas",-1),de=e("p",{class:"mt-1 text-sm leading-6 text-gray-600"},"Informações sobre o redistro de pagamento como devedor, dívida e valor total da dívida",-1),ne={class:"mt-10 grid grid-cols-1 gap-x-6 gap-y-8 sm:grid-cols-6"},le={class:"sm:col-span-6"},re=e("label",{for:"payment-debt",class:"block text-sm font-medium leading-6 text-gray-900 required-input-label"},"Dívida",-1),ie={class:"mt-2"},ce=["disabled"],me={key:0,class:"text-red-500 text-sm"},ue={class:"sm:col-span-3"},pe=e("label",{for:"payment-client",class:"block text-sm font-medium leading-6 text-gray-900 required-input-label"},"Devedor",-1),ye={class:"mt-2"},_e={key:0,class:"text-red-500 text-sm"},he={class:"sm:col-span-3"},xe=e("label",{for:"payment-total-amount",class:"block text-sm font-medium leading-6 text-gray-900 required-input-label"},"Valor total",-1),be={class:"mt-2"},ge=["disabled"],ve={key:0,class:"text-red-500 text-sm"},fe={class:"sm:col-span-6"},we=e("label",{for:"payment-observations",class:"block text-sm font-medium leading-6 text-gray-900"},"Observações",-1),ke={class:"mt-2"},Ve=["disabled"],De={key:0,class:"text-red-500 text-sm"},Ce={key:0,class:"py-4"},qe={class:"sm:col-span-6"},$e=["title"],Ue={class:"flex h-6 items-center"},ze=["disabled"],Te={class:"text-sm leading-6"},je={key:1,class:"py-4"},Pe={key:0},Re=e("h2",{class:"text-base font-semibold leading-7 text-gray-900"},"Pagamentos concluídos",-1),Me=e("p",{class:"mt-1 text-sm leading-6 text-gray-600"},"Insira o adiantamento ou os serviços parciais já realizando desta título",-1),Ne=[Re,Me],Ae={key:1},Ee=e("h2",{class:"text-base font-semibold leading-7 text-gray-900"},"Lista de pagamentos concluídos ",-1),Ie=e("p",{class:"mt-1 text-sm leading-6 text-gray-600"},"Abaixo está listado os registros de serviços realizados. Para adicionar novos serviços, ou remover algum serviço existente, entre na seção de serviço.",-1),Be=[Ee,Ie],Se={key:2},Oe=e("h2",{class:"text-base font-semibold leading-7 text-gray-900"},"Realize um novo pagamento",-1),Fe=e("p",{class:"mt-1 text-sm leading-6 text-gray-600"},"Adicione um serviço ou remova um serviço existente.",-1),Le=[Oe,Fe],Xe={key:3},Ge=e("h2",{class:"text-base font-semibold leading-7 text-gray-900"},"Veja a lista de pagamentos realizados",-1),He=e("p",{class:"mt-1 text-sm leading-6 text-gray-600"},"Abaixo segue a lista dos pagamentos concluídos deste serviço",-1),Je=[Ge,He],Ke={key:4,class:"mt-10 grid grid-cols-1 gap-x-6 gap-y-4 sm:grid-cols-6"},Qe={class:"col-span-2"},We=e("label",{for:"record-amount",class:"block text-sm font-medium leading-6 text-gray-900 required-input-label"},"Valor (R$)",-1),Ye={class:"mt-2"},Ze=["max","disabled"],et={class:"text-gray-400 text-xs py-1"},tt={key:0,class:"text-red-500 text-sm"},ot={class:"sm:col-span-2"},st=e("label",{for:"record-date",class:"block text-sm font-medium leading-6 text-gray-900 required-input-label"},"Data do serviço",-1),at={class:"mt-2"},dt=["max","disabled"],nt=e("p",{class:"text-gray-400 text-xs py-1"},"Não aceita datas no futuro",-1),lt={key:0,class:"text-red-500 text-sm"},rt={class:"sm:col-span-2"},it=e("label",{for:"record-date",class:"block text-sm font-medium leading-6 text-gray-900 required-input-label"},"Forma de Pagamento",-1),ct={class:"mt-2"},mt=e("option",{value:"pix"},"PIX",-1),ut=e("option",{value:"dinheiro"},"Dinheiro",-1),pt=e("option",{value:"cartao_credito"},"Cartão de Crédito",-1),yt=e("option",{value:"cartao_debito"},"Cartão de Débito",-1),_t=e("option",{value:"ted"},"TED",-1),ht=e("option",{value:"cheque"},"Cheque",-1),xt=[mt,ut,pt,yt,_t,ht],bt={key:0,class:"text-red-500 text-sm"},gt={key:5,class:"w-full py-5 flex justify-end"},vt=["disabled"],ft={key:6,class:"flex flex-col"},wt={class:"overflow-x-auto sm:-mx-6 lg:-mx-8"},kt={class:"inline-block min-w-full py-2 sm:px-6 lg:px-8"},Vt={class:"overflow-hidden"},Dt={class:"min-w-full text-left text-sm font-light"},Ct={class:"border-b bg-white font-medium"},qt=e("th",{scope:"col",class:"px-6 py-4 text-center"},"Valor",-1),$t=e("th",{scope:"col",class:"px-6 py-4 text-center"},"Data",-1),Ut=e("th",{scope:"col",class:"px-6 py-4 text-center"},"Método de Pagamento ",-1),zt={key:0,scope:"col",class:"px-6 py-4 text-center"},Tt={key:1,scope:"col",class:"px-6 py-4 text-center"},jt={class:"border-b bg-white"},Pt={class:"whitespace-nowrap px-1 text-center"},Rt={key:0,class:"w-full relative flex flex-wrap items-stretch"},Mt=e("span",{class:"w-1/4 select-none flex items-center whitespace-nowrap rounded-l border border-r-0 border-solid border-neutral-300 px-1 py-[0.25rem] text-center text-xs font-normal leading-[1.6] text-neutral-700",id:"basic-addon1"},"R$",-1),Nt=["max","onUpdate:modelValue"],At={key:1},Et={class:"whitespace-nowrap px-1 py-4 text-center"},It={key:0,class:"w-full relative flex flex-wrap items-stretch"},Bt=["max","onUpdate:modelValue"],St={key:1},Ot={class:"whitespace-nowrap px-1 py-4 text-center"},Ft={key:0,class:"w-full relative flex flex-wrap items-stretch"},Lt=["onUpdate:modelValue"],Xt=e("option",{value:"pix"},"PIX",-1),Gt=e("option",{value:"dinheiro"},"Dinheiro",-1),Ht=e("option",{value:"cartao_credito"},"Cartão de Crédito ",-1),Jt=e("option",{value:"cartao_debito"},"Cartão de Débito",-1),Kt=e("option",{value:"ted"},"TED",-1),Qt=e("option",{value:"cheque"},"Cheque",-1),Wt=[Xt,Gt,Ht,Jt,Kt,Qt],Yt={key:1},Zt={key:0,class:"whitespace-nowrap px-6 py-4 select-none"},eo={key:1,class:"whitespace-nowrap px-6 py-4 select-none"},to={key:2,class:"text-red-500 text-sm"},oo={key:3,class:"text-red-500 text-sm"},so={key:0,class:"text-red-500 text-sm py-5 text-center"},ao={key:1,class:"text-red-500 text-sm py-5 text-center"},no={key:2,class:"text-red-500 text-sm py-5 text-center"},lo={key:7,class:"py-5 text-gray-400 text-center"},bo={__name:"CreateUpdatePayModal",props:{modal:Object,payment:{type:Object,default:null}},emits:["close","submit"],setup(t,{emit:N}){const U=N,i=t,A=y(()=>i.payment.records_list.data.length+1),u=y(()=>z&&i.payment.total_value-i.payment.records_list.data.reduce((m,n)=>m+n.amount,0)),D=y(()=>{const m=new Date;return i.payment.records_list.data.some(n=>new Date(n.date)>m)}),C=y(()=>i.payment.records_list.data.some(m=>m.amount<=0)),E=y(()=>i.payment.records_list.data.sort((m,n)=>new Date(m.date)-new Date(n.date))),g=y(()=>["pay","see"].includes(i.modal.mode)),z=y(()=>i.modal.mode!=="create"||i.payment.records_list.enable_records),v=y(()=>i.payment.debt.length&&i.payment.client_id&&i.payment.total_value>0),d=O({id:A,amount:0,past:!1,register_date:b(),payment_method:"cartao_credito",filepath:null}),T=F(!1),I=()=>{if(i.payment.records_list.enable_records&&i.payment.records_list.data.length)if(confirm("Tem certeza que deseja desmarcar? Todos os registros serão excluídos!"))i.payment.records_list.data.length=[],d.reset();else return;i.payment.records_list.enable_records=!i.payment.records_list.enable_records},B=()=>{if(!d.amount||d.amount>u.value){d.errors.amount=`O valor do registro deve ser maior que R$ 0,00 e menor que ${V(u.value)}`;return}if(d.errors.amount="",!d.register_date||new Date(d.register_date)>new Date){d.errors.date=`A data do registro deve ser menor ou igual a ${b()}`;return}if(d.errors.date="",!d.payment_method){d.errors.payment_method="Um método de pagamento deve ser selecionado";return}d.errors.payment_method="",T.value||(d.filepath=null),i.payment.records_list.data.push({...d}),T.value=!1,d.reset()},S=(m,n=null)=>{if(i.modal.mode==="create"){i.payment.records_list.data=i.payment.records_list.data.filter(o=>o.id!==m);return}else confirm("Você tem certeza que deseja excluir esse registro? (Essa ação não pode ser desfeita)")&&n.delete(route("records.destroy",m),{preserveScroll:!0,onSuccess:()=>{i.payment.records_list.data=i.payment.records_list.data.filter(o=>o.id!==m)}})},q=()=>{U("close")},j=()=>{U("submit")};return(m,n)=>(s(),f(H,{show:t.modal.show,onClose:q},{icon:x(()=>[e("div",{class:k(["mx-auto shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-blue-400 sm:mx-0 sm:h-10 sm:w-10",{"bg-yellow-400":t.modal.mode==="update","bg-green-400":t.modal.mode==="pay"}])},[t.modal.mode==="create"?(s(),f(r(Z),{key:0,class:"w-5 h-5 text-white"})):l("",!0),t.modal.mode==="update"?(s(),f(r(ee),{key:1,class:"w-5 h-5 text-white"})):l("",!0),t.modal.mode==="pay"?(s(),f(r(te),{key:2,class:"w-5 h-5 text-white"})):l("",!0)],2)]),title:x(()=>[$(c(t.modal.title),1)]),content:x(()=>[e("form",{onSubmit:L(j,["prevent"])},[e("div",oe,[e("section",se,[ae,de,e("div",ne,[e("div",le,[re,e("div",ie,[p(e("input",{type:"text",name:"payment-debt",id:"payment-debt",autocomplete:"on",class:"simple-input disabled:bg-gray-200",autofocus:"true",placeholder:"Título da dívida",disabled:g.value||t.payment.type===2,"onUpdate:modelValue":n[0]||(n[0]=o=>t.payment.debt=o),required:""},null,8,ce),[[_,t.payment.debt]]),t.payment.errors.debt?(s(),a("p",me,c(t.payment.errors.debt),1)):l("",!0)])]),e("div",ue,[pe,e("div",ye,[w(W,{modelValue:t.payment.client_id,"onUpdate:modelValue":n[1]||(n[1]=o=>t.payment.client_id=o),disabled:g.value||t.payment.type===2,class:"disabled:bg-gray-200",required:!0},null,8,["modelValue","disabled"]),t.payment.errors.client_id?(s(),a("p",_e,c(t.payment.errors.client_id),1)):l("",!0)])]),e("div",he,[xe,e("div",be,[p(e("input",{id:"payment-total-amount",name:"payment-total-amount",type:"number",step:"0.01",min:"0",autocomplete:"off",class:"simple-input disabled:bg-gray-200",placeholder:"Valor total inicial da dívida",disabled:g.value,"onUpdate:modelValue":n[2]||(n[2]=o=>t.payment.total_value=o),required:""},null,8,ge),[[_,t.payment.total_value]]),t.payment.errors.total_value?(s(),a("p",ve,c(t.payment.errors.total_value),1)):l("",!0)])]),e("div",fe,[we,e("div",ke,[p(e("textarea",{type:"text",observations:"payment-observations",id:"payment-observations",autocomplete:"on",class:"simple-input disabled:bg-gray-200",placeholder:"Descreva a dívida mais detalhadamente ou insira informações adicionais",disabled:g.value,"onUpdate:modelValue":n[3]||(n[3]=o=>t.payment.observations=o)},null,8,Ve),[[_,t.payment.observations]]),t.payment.errors.observations?(s(),a("p",De,c(t.payment.errors.observations),1)):l("",!0)])])])]),t.modal.mode==="create"?(s(),a("section",Ce,[e("div",qe,[e("div",{class:"mt-2 relative flex gap-x-3",title:v.value?"":"Preencha ao menos a dívida, o devedor e o valor total."},[e("div",Ue,[e("input",{id:"payment-enable-records",name:"payment-enable-records",type:"checkbox",onChange:n[4]||(n[4]=o=>I()),disabled:!v.value,class:"h-4 w-4 rounded border-gray-300 text-green-600 focus:ring-green-600 disabled:border-gray-100 disabled:text-green-200 disabled:bg-gray-300"},null,40,ze)]),e("div",Te,[e("label",{for:"payment-enable-records",class:k(["font-medium text-gray-900 select-none cursor-pointer",{"text-gray-300":!v.value,"cursor-not-allowed":!v.value}])},"Adicionar pagamentos concluídos",2)])],8,$e)])])):l("",!0),z.value?(s(),a("section",je,[t.modal.mode==="create"?(s(),a("div",Pe,Ne)):l("",!0),t.modal.mode==="update"?(s(),a("div",Ae,Be)):l("",!0),t.modal.mode==="pay"?(s(),a("div",Se,Le)):l("",!0),t.modal.mode==="see"?(s(),a("div",Xe,Je)):l("",!0),t.modal.mode!=="update"&&t.modal.mode!=="see"?(s(),a("div",Ke,[e("div",Qe,[We,e("div",Ye,[p(e("input",{id:"record-amount",name:"record-amount",type:"number",step:"0.01",min:"0",max:u.value,autocomplete:"off",class:"simple-input disabled:bg-gray-200 disabled:opacity-75",disabled:u.value==0,placeholder:"Valor do serviço parcial","onUpdate:modelValue":n[5]||(n[5]=o=>r(d).amount=o)},null,8,Ze),[[_,r(d).amount]]),e("p",et,"Valor Restante: "+c(r(V)(u.value)),1),r(d).errors.amount?(s(),a("p",tt,c(r(d).errors.amount),1)):l("",!0)])]),e("div",ot,[st,e("div",at,[p(e("input",{id:"record-date",name:"record-date",type:"date",max:r(b)(),autocomplete:"off",class:"simple-input disabled:bg-gray-200",disabled:u.value==0,placeholder:"Data de serviço do valor parcial","onUpdate:modelValue":n[6]||(n[6]=o=>r(d).register_date=o)},null,8,dt),[[_,r(d).register_date]]),nt,r(d).errors.register_date?(s(),a("p",lt,c(r(d).errors.register_date),1)):l("",!0)])]),e("div",rt,[it,e("div",ct,[p(e("select",{name:"payment_method",class:"simple-input","onUpdate:modelValue":n[7]||(n[7]=o=>r(d).payment_method=o)},xt,512),[[M,r(d).payment_method]]),r(d).errors.payment_method?(s(),a("p",bt,c(r(d).errors.payment_method),1)):l("",!0)])])])):l("",!0),t.modal.mode!=="update"?(s(),a("div",gt,[e("button",{type:"button",class:"w-full px-4 py-2 bg-blue-600 border border-gray-300 rounded-md font-semibold text-xs text-white uppercase tracking-widest shadow-sm hover:bg-blue-700 focus:outline-none focus:border-blue-300 focus:ring focus:ring-blue-200 active:text-gray-800 active:bg-gray-50 disabled:opacity-25 transition",disabled:!r(d).amount||!r(d).register_date||r(d).amount>u.value,onClick:n[8]||(n[8]=o=>B())}," Inserir registro ",8,vt)])):l("",!0),t.payment.records_list.data.length?(s(),a("div",ft,[e("div",wt,[e("div",kt,[e("div",Vt,[e("table",Dt,[e("thead",Ct,[e("tr",null,[qt,$t,Ut,t.modal.mode!=="create"?(s(),a("th",zt,"Usuário")):l("",!0),t.modal.mode!=="pay"&&t.modal.mode!=="see"?(s(),a("th",Tt,"Excluir")):l("",!0)])]),e("tbody",null,[(s(!0),a(X,null,G(E.value,o=>{var P,R;return s(),a("tr",jt,[e("td",Pt,[t.modal.mode!=="update"&&!o.past?(s(),a("div",Rt,[Mt,p(e("input",{id:"record_item-amount-edit",name:"record_item-amount-edit",type:"number",step:"0.01",min:"0",max:u.value,autocomplete:"off",class:"relative m-0 block min-w-0 flex-auto rounded-r border border-solid border-neutral-300 bg-transparent bg-clip-padding px-1 py-[0.25rem] text-xs font-normal leading-[1.6] text-neutral-700 outline-none transition duration-200 ease-in-out focus:z-[3] focus:border-primary focus:text-neutral-700 focus:shadow-[inset_0_0_0_1px_rgb(59,113,202)] focus:outline-none disabled:bg-gray-200",placeholder:"Editar serviço parcial","onUpdate:modelValue":h=>o.amount=h},null,8,Nt),[[_,o.amount]])])):(s(),a("p",At,c(r(V)(o.amount)),1))]),e("td",Et,[t.modal.mode!=="update"&&!o.past?(s(),a("div",It,[p(e("input",{id:"record-date",name:"record-date",type:"date",max:r(b)(),autocomplete:"off",class:"w-full relative m-0 block min-w-0 flex-auto rounded-r border border-solid border-neutral-300 bg-transparent bg-clip-padding px-1 py-[0.25rem] text-xs font-normal leading-[1.6] text-neutral-700 outline-none transition duration-200 ease-in-out focus:z-[3] focus:border-primary focus:text-neutral-700 focus:shadow-[inset_0_0_0_1px_rgb(59,113,202)] focus:outline-none disabled:bg-gray-200",placeholder:"Data de serviço do valor parcial","onUpdate:modelValue":h=>o.register_date=h},null,8,Bt),[[_,o.register_date]])])):(s(),a("p",St,c(r(b)(o.register_date,!0)),1))]),e("td",Ot,[t.modal.mode!=="update"&&!o.past?(s(),a("div",Ft,[p(e("select",{name:"payment_method",class:"w-full relative m-0 block min-w-0 flex-auto rounded-r border border-solid border-neutral-300 bg-transparent bg-clip-padding px-1 py-[0.25rem] text-xs font-normal leading-[1.6] text-neutral-700 outline-none transition duration-200 ease-in-out focus:z-[3] focus:border-primary focus:text-neutral-700 focus:shadow-[inset_0_0_0_1px_rgb(59,113,202)] focus:outline-none disabled:bg-gray-200","onUpdate:modelValue":h=>o.payment_method=h},Wt,8,Lt),[[M,o.payment_method]])])):(s(),a("p",Yt,c(r(Q)(o.payment_method)),1))]),t.modal.mode!=="create"?(s(),a("td",Zt,c(((R=(P=o==null?void 0:o.procedure)==null?void 0:P.user)==null?void 0:R.name)||m.$page.props.auth.user.name||"Não identificado"),1)):l("",!0),t.modal.mode!=="pay"&&t.modal.mode!=="see"?(s(),a("td",eo,[w(r(Y),{class:"w-5 h-5 cursor-pointer m-auto text-gray-700 hover:text-red-500 active:text-red-700",onClick:h=>S(o.id,o),title:"Remover este registro"},null,8,["onClick"])])):l("",!0),o.errors.amount?(s(),a("p",to,c(o.errors.amount),1)):l("",!0),o.errors.date?(s(),a("p",oo,c(o.errors.date),1)):l("",!0)])}),256))])]),u.value<0?(s(),a("p",so,"A soma dos pagamentos não pode ser maior que "+c(r(V)(t.payment.total_value)),1)):l("",!0),D.value?(s(),a("p",ao," Todas as datas de registro devem ser não nulas e menores ou iguais a "+c(r(b)(new Date)),1)):l("",!0),C.value?(s(),a("p",no," Todos os valores devem ser maiores que R$ 0,00")):l("",!0)])])])])):(s(),a("div",lo,"Não há registro de pagamento no momento. "))])):l("",!0)])],32)]),footer:x(()=>[w(K,{class:k({disabled:t.payment.processing}),onClick:n[9]||(n[9]=o=>q())},{default:x(()=>[$("Cancelar ")]),_:1},8,["class"]),w(J,{class:k({disabled:t.payment.processing||u.value<0||D.value||C.value}),disabled:t.payment.processing||u.value<0||D.value||C.value,onClick:n[10]||(n[10]=o=>t.modal.mode==="see"?q():j())},{default:x(()=>[$(c(t.modal.primary_button_txt),1)]),_:1},8,["class","disabled"])]),_:1},8,["show"]))}};export{bo as _};
