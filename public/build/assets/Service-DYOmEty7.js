import { o as l, e as c, a as e, T as b, d as k, l as C, b as n, u as r, w as S, F as $, Z as R, t as i, p as U, v as F, h as q, n as G, g as Z, f as X } from "./app-B9AaS3di.js"; import { _ as H } from "./AppLayout-BpgBCMDE.js"; import { _ as J } from "./CreateUpdatePayModal-dNGOSuzY.js"; import { _ as K } from "./FloatButton-Ci1qFIeh.js"; import { _ as Q } from "./ExtraOptionsButton-CdyZ58LY.js"; import { f as A, t as m, a as W, c as L, r as Y, b as ee } from "./general-CT66CFmJ.js"; import { r as te } from "./BanknotesIcon-D31jRm2d.js"; import "./PrimaryButton-C6t27UzX.js"; import "./SecondaryButton-DopaOyGA.js"; import "./PrinterIcon-CisfNOAW.js"; import "./EyeIcon-EVOI874d.js"; import "./Modal-tn0Up1zP.js"; function oe(d, _) { return l(), c("svg", { xmlns: "http://www.w3.org/2000/svg", fill: "none", viewBox: "0 0 24 24", "stroke-width": "1.5", stroke: "currentColor", "aria-hidden": "true", "data-slot": "icon" }, [e("path", { "stroke-linecap": "round", "stroke-linejoin": "round", d: "M9 12.75 11.25 15 15 9.75M21 12c0 1.268-.63 2.39-1.593 3.068a3.745 3.745 0 0 1-1.043 3.296 3.745 3.745 0 0 1-3.296 1.043A3.745 3.745 0 0 1 12 21c-1.268 0-2.39-.63-3.068-1.593a3.746 3.746 0 0 1-3.296-1.043 3.745 3.745 0 0 1-1.043-3.296A3.745 3.745 0 0 1 3 12c0-1.268.63-2.39 1.593-3.068a3.745 3.745 0 0 1 1.043-3.296 3.746 3.746 0 0 1 3.296-1.043A3.746 3.746 0 0 1 12 3c1.268 0 2.39.63 3.068 1.593a3.746 3.746 0 0 1 3.296 1.043 3.746 3.746 0 0 1 1.043 3.296A3.745 3.745 0 0 1 21 12Z" })]) } const se = { class: "font-semibold text-xl text-gray-800 leading-tight" }, ae = { class: "pt-12 print:hidden print:pt-0" }, re = { class: "max-w-7xl mx-auto sm:px-6 lg:px-8 print:w-full" }, ne = { class: "bg-white overflow-hidden shadow-xl sm:rounded-lg p-5" }, ie = { class: "flex flex-row items-center space-x-3" }, le = { class: "py-12 print:py-6" }, ce = { class: "max-w-7xl mx-auto print:max-w-full" }, de = { class: "px-0 print:px-0" }, pe = { class: "bg-white overflow-hidden shadow-xl sm:rounded-lg print:shadow-none" }, ue = { class: "flex flex-col" }, me = { class: "overflow-x-auto sm:-mx-6 lg:-mx-8" }, _e = { class: "inline-block min-w-full py-2 sm:px-6 lg:px-8" }, he = { class: "overflow-hidden" }, xe = { class: "min-w-full text-left text-sm font-light" }, ve = e("thead", { class: "border-b font-medium dark:border-neutral-500" }, [e("tr", null, [e("th", { scope: "col", class: "px-6 py-4 text-center" }, "#"), e("th", { scope: "col", class: "px-6 py-4 text-center" }, "Prazo"), e("th", { scope: "col", class: "px-6 py-4 text-center" }, "Título"), e("th", { scope: "col", class: "px-6 py-4 text-center" }, "Cliente"), e("th", { scope: "col", class: "px-6 py-4 text-center" }, "À pagar"), e("th", { scope: "col", class: "px-6 py-4 text-center" }, "Valor total"), e("th", { scope: "col", class: "px-6 py-4 text-center print:hidden" }, "Entrega"), e("th", { scope: "col", class: "px-6 py-4 text-center print:hidden", colspan: "4" }, "Ações")])], -1), we = { class: "border-b transition duration-300 ease-in-out hover:bg-neutral-100 print:break-inside-avoid" }, fe = { class: "whitespace-nowrap py-4 text-center font-medium" }, ge = { class: "whitespace-normal px-6 py-4 text-center trim" }, ye = ["title"], be = { class: "whitespace-normal px-6 py-4 text-center" }, ke = { class: "whitespace-nowrap px-2 py-4 text-center" }, Ce = { class: "whitespace-nowrap px-2 py-4 text-center" }, Se = { class: "whitespace-nowrap px-2 py-4 text-center print:hidden" }, $e = ["title", "onClick"], Ae = ["title", "onClick"], Le = { key: 0 }, De = { key: 1, class: "m-auto text-center" }, Me = ["title", "onClick"], Oe = ["title", "onClick"], Ve = { key: 1, class: "transition duration-300 ease-in-out hover:bg-neutral-100 print:break-inside-avoid" }, Ee = e("td", { class: "whitespace-nowrap px-6 py-4 text-center", colspan: "9" }, "Não há serviços cadastrados no momento!", -1), Pe = [Ee], Xe = { __name: "Service", props: { page: Object, page_options: { type: Array, default: null }, services_list: Object }, setup(d) { const _ = d, a = b({ id: null, title: "", client: "", total_value: 0, partial_value: 0, observations: "", deadline: A(new Date(Date.now() + 15 * 24 * 60 * 60 * 1e3), "new_date"), records_list: { enable_records: !1, data: [] } }), x = k(""), f = C(() => { const s = x.value.toLowerCase(); return _.services_list.filter(o => o.motive.toLowerCase().includes(s) || o.entity_name.toLowerCase().includes(s) || o.observations.toLowerCase().includes(s) || m(o.accounting.total_value).toString().toLowerCase().includes(s) || m(o.accounting.partial_value).toString().toLowerCase().includes(s) || o.deadline.includes(s)) }), D = C(() => _.services_list.reduce((s, o) => s + o.accounting.partial_value, 0)), M = s => { const o = L(s); return o === 0 ? "text-red-500" : o > 0 && o < 8 ? "text-orange-500" : o > 7 && o < 15 ? "text-yellow-500" : o > 14 && o < 30 ? "text-green-500" : "text-blue-500" }, p = k({ mode: "create", show: !1, get title() { switch (this.mode) { case "create": return "Criar serviço"; case "update": return "Editar serviço"; case "pay": return "Pagar serviço"; case "see": return "Ver informações do serviço" } }, get primary_button_txt() { switch (this.mode) { case "create": return "Cadastrar"; case "update": return "Atualizar"; case "pay": return "Pagar"; case "see": return "Fechar" } } }), v = (s, o = null) => { const t = ["update", "pay"].includes(s); if (o !== null && t) { const u = _.services_list.find(w => w.id === o); if (u) { const { id: w, motive: N, entity_name: j, observations: z, records: g, accounting: y } = u; a.id = w, a.title = N, a.client = j, a.total_value = y.total_value, a.partial_value = y.partial_value, a.observations = z, a.records_list.enable_records = !!g.length, a.records_list.data = g.map(I => b(I)) } } p.value.mode = s, p.value.show = !0 }, h = () => { a.reset(), p.value.show = !1 }, O = () => { a.post(route("services.store"), { preserveScroll: !0, onSuccess: () => h(), onError: s => { console.log(s) } }) }, V = () => { a.put(route("services.update", a.id), { preserveScroll: !0, onSuccess: () => h() }) }, E = () => { a.put(route("services.pay", a.id), { preserveScroll: !0, onSuccess: () => h() }) }, P = (s, o) => { if (o !== 0) { if (!confirm("O serviço será considerado como concluído e será listado apenas na página de pagamentos")) return } else if (!confirm("O serviço será considerado concluído e pago!")) return; a.put(route("services.conclude", s), { preserveScroll: !0 }) }, T = (s, o) => { confirm(`Você tem certeza que deseja excluir o serviço "${o}"? Esta ação não poderá ser desfeita!`) && a.delete(route("services.destroy", s), { preserveScroll: !0, onSuccess: () => alert("Serviço deletado com sucesso!") }) }, B = () => { switch (p.value.mode) { case "create": return O(); case "update": return V(); case "pay": return E(); default: alert("Método desconhecido. Informar o Técnico.") } }; return (s, o) => (l(), c($, null, [n(r(R), { title: d.page.name }, null, 8, ["title"]), n(H, { page: d.page, page_options: d.page_options }, { header: S(() => [e("h2", se, i(d.page.name) + " | " + i(r(m)(D.value)), 1), n(K, { icon: "plus", onClick: o[0] || (o[0] = t => v("create")), title: "Cadastrar Service", class: "print:hidden" })]), default: S(() => [e("div", ae, [e("div", re, [e("div", ne, [e("div", ie, [n(r(W), { class: "w-5 y-5" }), U(e("input", { type: "text", name: "search_term", id: "search_term", autocomplete: "on", class: "simple-input", autofocus: "true", placeholder: "Pesquisar termo...", "onUpdate:modelValue": o[1] || (o[1] = t => x.value = t) }, null, 512), [[F, x.value]])])])])]), e("div", le, [e("div", ce, [e("div", de, [e("div", pe, [e("div", ue, [e("div", me, [e("div", _e, [e("div", he, [e("table", xe, [ve, e("tbody", null, [f.value.length ? (l(!0), c($, { key: 0 }, q(f.value, t => (l(), c("tr", we, [e("td", fe, i(t.id), 1), e("td", { class: G(["whitespace-nowrap py-4 text-center font-medium", M(t.deadline)]) }, i(r(L)(t.deadline)) + " dias ", 3), e("td", ge, [Z(i(t.motive) + " ", 1), t.observations ? (l(), c("span", { key: 0, title: t.observations, class: "inline-flex items-center rounded-md bg-gray-50 px-2 py-1 text-xs font-medium text-gray-600 ring-1 ring-inset ring-gray-500/10 cursor-help" }, "OBS", 8, ye)) : X("", !0)]), e("td", be, i(t.entity_name), 1), e("td", ke, i(r(m)(t.accounting.partial_value)), 1), e("td", Ce, i(r(m)(t.accounting.total_value)), 1), e("td", Se, i(r(A)(t.deadline, !0)), 1), e("td", { class: "whitespace-nowrap px-4 py-4 pl-10 text-center cursor-pointer hover:text-blue-700 active:text-blue-900 select-none print:hidden", title: "CONCLUIR: " + t.motive + "(" + t.entity_name + ")", onClick: u => P(t.id, t.accounting.partial_value) }, [n(r(oe), { class: "w-4 h-4 m-auto" })], 8, $e), e("td", { class: "whitespace-nowrap px-4 py-4 text-center cursor-pointer hover:text-green-700 active:text-green-900 select-none print:hidden", title: "PAGAR: " + t.motive + "(" + t.entity_name + ")", onClick: u => v("pay", t.id) }, [t.accounting.partial_value !== 0 ? (l(), c("span", Le, [n(r(te), { class: "w-4 h-4 m-auto" })])) : (l(), c("span", De, "PAGO"))], 8, Ae), e("td", { class: "whitespace-nowrap px-4 py-4 text-center cursor-pointer hover:text-yellow-700 active:text-yellow-900 select-none print:hidden", title: "EDITAR: " + t.motive + "(" + t.entity_name + ")", onClick: u => v("update", t.id) }, [n(r(Y), { class: "w-4 h-4 m-auto" })], 8, Me), e("td", { class: "whitespace-nowrap px-4 py-4 text-center cursor-pointer hover:text-red-700 active:text-red-900 select-none print:hidden", title: "EXCLUIR: " + t.motive + "(" + t.entity_name + ")", onClick: u => T(t.id, t.name) }, [n(r(ee), { class: "w-4 h-4 m-auto" })], 8, Oe)]))), 256)) : (l(), c("tr", Ve, Pe))])])])])])])])])])]), n(J, { show: p.value.show, modal: p.value, service: r(a), onSubmit: B, onClose: h }, null, 8, ["show", "modal", "service"]), n(Q, { mode: ["rollup", "print_page", "link"], link_type: ["previous"], link: [s.route("services.previous")] }, null, 8, ["link"])]), _: 1 }, 8, ["page", "page_options"])], 64)) } }; export { Xe as default };
