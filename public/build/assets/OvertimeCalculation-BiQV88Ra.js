import{o as s,e as r,a as e,d as _,A as ce,p as G,c as Q,w as E,b as f,u as d,f as S,q as k,v as P,h as T,F as J,g as Y,t as u,B as de,z as ue,l as Z,C as pe,Z as _e,y as L,n as V,D as he}from"./app-DdquKXfZ.js";import{_ as ve}from"./AppLayout-C7GMpQlH.js";import{_ as fe}from"./CreateUpdateModal-CtVS32Jf.js";import{_ as xe}from"./SecondaryButton-BsBTKx1w.js";import{f as U,t as M}from"./general-f63YF4ZR.js";import{r as me}from"./EyeIcon-D7jnqb2_.js";import{_ as be}from"./ExtraOptionsButton-BNC-1bN5.js";/* empty css                    */import{r as ge}from"./DocumentDuplicateIcon-DGwz9Qzt.js";import"./Modal-BEBHt8sy.js";import"./PrinterIcon-BjmEy16_.js";function O(h,x){return s(),r("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 7.5 7.5 3m0 0L12 7.5M7.5 3v13.5m13.5 0L16.5 21m0 0L12 16.5m4.5 4.5V7.5"})])}const we={class:"mx-auto shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-blue-400 sm:mx-0 sm:h-10 sm:w-10"},ke={class:"my-3"},ye=e("label",{for:"older-records-date",class:"text-xs text-neutral-400"},"Dia dos registros",-1),Ce=["max","disabled"],$e={key:0,class:"w-full text-center"},Ve={key:1,class:"text-sm text-neutral-500"},Te={class:"flex justify-between p-3 even:bg-neutral-100 hover:bg-neutral-200"},Ee=["href"],Se={key:2},Ae={__name:"SeeOldOvertimeCalculations",props:{modal:Boolean},emits:["close"],setup(h,{emit:x}){const m=x,l=_([]),A=_(!0),y=_(null),g=async(C="")=>{A.value=!0;try{const o=await de.get(`${route("employee.overtime_calculation_list")}/${C}`);l.value=o.data}catch(o){console.error("Erro ao buscar registros:",o)}finally{A.value=!1}};ce(l,()=>{y.value=l.value.length?U(l.value[0].created_at):U()},{immediate:!0}),G(()=>{g()});const w=()=>m("close");return(C,o)=>(s(),Q(fe,{show:h.modal,maxWidth:"2xl",onClose:w},{icon:E(()=>[e("div",we,[f(d(me),{class:"w-5 h-5 text-white"})])]),title:E(()=>[S(" Tabelas anteriores ")]),content:E(()=>[e("div",ke,[ye,k(e("input",{type:"date",id:"older-records-date",name:"older-records-date",max:d(U)(),"onUpdate:modelValue":o[0]||(o[0]=p=>y.value=p),onChange:o[1]||(o[1]=p=>g(p.target.value)),class:"simple-input disabled:opacity-50",disabled:A.value},null,40,Ce),[[P,y.value]])]),A.value?(s(),r("p",$e,"Carregando dados...")):T("",!0),l.value.length?(s(),r("ul",Ve,[(s(!0),r(J,null,Y(l.value,(p,N)=>(s(),r("li",Te,[e("span",null,u(p.procedure.user.name)+" "+u(p.procedure.user.surname),1),e("span",null,u(d(U)(p.created_at,"reading_date_time")),1),e("a",{href:C.route("employee.overtime_calculation",p.procedure.id),class:"text-green-500 hover:text-green-700 active:text-green-900"},"Ver",8,Ee)]))),256))])):(s(),r("p",Se,"Nenhum registro encontrado."))]),footer:E(()=>[f(xe,{onClick:o[2]||(o[2]=p=>w())},{default:E(()=>[S(" Fechar ")]),_:1})]),_:1},8,["show"]))}},Ne={class:"font-semibold text-xl text-gray-800 leading-tight flex justify-between"},Me={key:0,class:"text-right"},Pe={class:"text-sm text-neutral-500"},Ue={class:"text-xs text-neutral-400"},Fe={class:"pt-6 print:hidden"},Ie={class:"w-fit max-w-7xl mx-auto sm:px-6 lg:px-8 print:w-full"},Oe={class:"bg-white overflow-hidden shadow-xl sm:rounded-lg p-5"},He={class:"flex flex-col items-center justify-center align-middle gap-5"},je=e("h2",{class:"text-green-700 font-extrabold text-2xl"},"Controles da Tabela",-1),Be={key:0,class:"flex flex-col items-center justify-center align-middle gap-5"},De={class:"inline-flex items-center cursor-pointer"},Le=["disabled"],Je=e("div",{class:"relative w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-green-300 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-green-600"},null,-1),Xe=e("span",{class:"ms-3 text-sm font-medium text-gray-900"},"Mostrar funcionário omitidos",-1),Ke=["disabled"],qe=["href"],ze={key:2},Re={key:0,class:"text-xs text-red-300"},We={key:1,class:"text-xs text-neutral-500"},Ze={class:"py-6 print:py-0"},Ge={class:"max-w-full mx-auto print:max-w-full"},Qe={class:"px-0 print:px-0"},Ye={class:"bg-white overflow-hidden shadow-xl sm:rounded-lg print:shadow-none"},et={class:"flex flex-col"},tt={class:"overflow-x-auto sm:-mx-6 lg:-mx-8"},at={class:"inline-block min-w-full sm:px-6 lg:px-8"},nt={class:"overflow-hidden"},st={class:"min-w-full text-left text-sm font-light"},ot={class:"border-b font-medium"},rt={class:"bg-neutral-200"},it={key:0,scope:"col",class:"px-6 py-4 print:px-3 print:py-2 text-center print:hidden"},lt={class:"print:hidden"},ct=["disabled"],dt=e("th",{scope:"col",class:"px-6 py-4 print:px-3 print:py-2 text-center"}," Funcionário ",-1),ut=e("th",{scope:"col",class:"px-6 py-4 print:px-3 print:py-2 text-center print:hidden"}," Salário ",-1),pt=e("th",{scope:"col",class:"px-6 py-4 print:px-3 print:py-2 text-center print:hidden",title:"Início do expediente"}," H. Entrada",-1),_t=e("th",{scope:"col",class:"px-6 py-4 print:px-3 print:py-2 text-center print:hidden",title:"Saída para o horário de Almoço"},"S. Almoço",-1),ht=e("th",{scope:"col",class:"px-6 py-4 print:px-3 print:py-2 text-center print:hidden",title:"Entrada da volta do horário de Almoço"},"E. Almoço",-1),vt=e("th",{scope:"col",class:"px-6 py-4 print:px-3 print:py-2 text-center print:hidden",title:"Saída do expediente"},"H. Saída",-1),ft=e("th",{scope:"col",class:"px-6 py-4 print:px-3 print:py-2 text-center print:hidden",title:"Total de horas do Expediente"},"Total Horas",-1),xt={class:"print:hidden"},mt={class:"print:hidden"},bt=e("th",{scope:"col",class:"px-6 py-4 print:px-3 print:py-2 text-center",colspan:"2"}," Pix",-1),gt={key:0,class:"whitespace-nowrap py-1 print:p-0 text-center font-medium print:hidden"},wt=["value","onChange","checked","disabled"],kt={class:"py-4 text-center font-medium"},yt={class:"whitespace-nowrap py-1 print:p-0 text-center font-medium print:hidden"},Ct={class:"whitespace-nowrap py-1 print:p-0 text-center font-medium print:hidden relative"},$t=["onClick","disabled"],Vt=["disabled","onUpdate:modelValue"],Tt={class:"whitespace-nowrap py-1 print:p-0 text-center font-medium print:hidden relative"},Et=["onClick","disabled"],St=["disabled","onUpdate:modelValue"],At={class:"whitespace-nowrap py-1 print:p-0 text-center font-medium print:hidden relative"},Nt=["onClick","disabled"],Mt=["disabled","onUpdate:modelValue"],Pt={class:"whitespace-nowrap py-1 print:p-0 text-center font-medium print:hidden relative"},Ut=["onClick","disabled"],Ft=["disabled","onUpdate:modelValue"],It={class:"whitespace-nowrap py-1 print:p-0 text-center font-medium print:hidden"},Ot=["onClick"],Ht={class:"flex flex-row justify-center items-center align-middle gap-3"},jt={class:"whitespace-nowrap py-1 print:p-0 text-center font-medium uppercase"},Bt={key:1,class:"border-b transition duration-300 ease-in-out print:break-inside-avoid text-sm print:text-md bg-neutral-200"},Dt={key:0,class:"print:hidden",colspan:"6"},Lt={key:1,class:"print:hidden",colspan:"7"},Jt=e("td",{class:"whitespace-nowrap py-1 print:p-0 font-medium text-center"}," Total ",-1),Xt=e("td",{class:"whitespace-nowrap py-1 print:p-0 text-center font-medium",colspan:"2"},null,-1),Kt={key:2,class:"transition duration-300 ease-in-out hover:bg-neutral-100 print:break-inside-avoid"},qt=e("td",{class:"whitespace-nowrap px-6 py-1 text-center",colspan:"11"},"Não há funcionários cadastradas no momento!",-1),zt=[qt],oa={__name:"OvertimeCalculation",props:{page:Object,page_mode:String,user:Object,procedure_date:String,page_options:{type:Array,default:null},employees_list:Array,account_types_list:Array,payment_methods_list:Array,banks_list:Array,total_fifty_percent_value:Number,total_hundred_percent_value:Number},setup(h){const x=h,m=ue.useToast(),l=_(JSON.parse(JSON.stringify(x.employees_list))),A=JSON.parse(JSON.stringify(x.employees_list)),y=_(!1),g=_(!0),w=_(!0),C=_(!1),o=_(!1),p=_(x.total_fifty_percent_value),N=_(x.total_hundred_percent_value),ee=()=>{m.clear(),l.value=A,o.value=!1,m.success("Tabela resetada com sucesso!")},te=()=>{l.value.forEach(t=>K(t,y.value)),y.value=!y.value,o.value=!0},c=Z(()=>x.page_mode==="old"),ae=t=>{switch(t){case"pix_email":return"E-mail";case"pix_cpf":return"Cpf";case"pix_phone_number":return"Telefone";case"pix_token":return"Token"}return"-"},ne=t=>{let n=t[t.overtime_payment_method.cod];if(m.clear(),navigator.clipboard&&navigator.clipboard.writeText)return navigator.clipboard.writeText(n).then(()=>{m.success(`PIX de ${t.name} copiado para a área de transferência`),console.log("Texto copiado para a área de transferência")}).catch(a=>{m.error(`Não foi possível copiar o PIX de ${t.name} para a área de transferência`),console.error("Erro ao copiar texto para a área de transferência",a)});{const a=document.createElement("textarea");a.value=n,document.body.appendChild(a),a.focus(),a.select();try{document.execCommand("copy"),m.success(`PIX de ${t.name} copiado para a área de transferência`),console.log("Texto copiado para a área de transferência")}catch(v){m.error(`Não foi possível copiar o PIX de ${t.name} para a área de transferência`),console.error("Erro ao copiar texto para a área de transferência",v)}document.body.removeChild(a)}},F=(t,n)=>{if(!l||!l.value||!Array.isArray(l.value)){console.error("As informações dos funcionários não estão devidamente formatadas.");return}l.value.forEach(a=>{a.show&&(console.log("SHOW: ",a.show),a[n]=t,o.value=!0)})},I=t=>{const[n,a]=t.split(":").map(Number);return n*60+a},se=t=>{if(!t.check_in_time||!t.leave_for_lunch_break||!t.check_in_after_lunch_break||!t.check_out_time)return t.total_time=0,t.fifty_percent_value=0,t.hundred_percent_value=0,0;const n=I(t.check_in_time),a=I(t.leave_for_lunch_break),v=I(t.check_in_after_lunch_break),b=I(t.check_out_time),$=a-n,i=b-v,W=($+i)/60;return t.total_time=W.toFixed(2),t.fifty_percent_value=X(t,.5),t.hundred_percent_value=X(t,1),H(),W.toFixed(2)},X=(t,n)=>{const a=parseFloat(t.total_time)||0,v=t.salary/220,b=1+n;return v*a*b},H=()=>{let t=0,n=0;l.value.forEach(a=>{t+=a.fifty_percent_value||0,n+=a.hundred_percent_value||0}),p.value=t,N.value=n},K=(t,n=null)=>{const v=t.salary/220,b=v*8.75*1.5,$=v*8.75*2;n!==null&&(t.show=!n),t.show?(p.value-=t.fifty_percent_value||0,N.value-=t.hundred_percent_value||0,n!==null&&(t.show=n),t.check_in_time=null,t.leave_for_lunch_break=null,t.check_in_after_lunch_break=null,t.check_out_time=null,t.total_time=0,t.fifty_percent_value=0,t.hundred_percent_value=0,H()):(n!==null&&(t.show=n),t.check_in_time="07:00",t.leave_for_lunch_break="12:00",t.check_in_after_lunch_break="13:15",t.check_out_time="17:00",t.total_time=8.75,t.fifty_percent_value=b,t.hundred_percent_value=$,p.value+=b,N.value+=$,H()),n===null&&(t.show=!t.show),o.value=!0},q=Z(()=>({totalFiftyPercentValue:p.value,totalHundredPercentValue:N.value})),j=_(!1),oe=()=>{j.value=!0},re=()=>{j.value=!1},z=async()=>{console.log("KKK"),o.value&&(console.log("hihihi"),x.page_mode!=="old"&&(console.log("rsrsrs"),he.post(route("employee.overtime_calculation_save"),{employees:JSON.stringify(l.value)},{preserveScroll:!0,onSuccess:()=>console.log("Dados salvos com sucesso"),onError:t=>console.log("Erro ao salvar dados: ",t),onFinish:()=>o.value=!1})))};let B=null;const ie=()=>{B=setInterval(z,1e4)},le=()=>{B&&clearInterval(B)},R=t=>{z()};return G(()=>{ie(),window.addEventListener("beforeunload",R)}),pe(()=>{le(),window.removeEventListener("beforeunload",R)}),(t,n)=>(s(),r(J,null,[f(d(_e),{title:h.page.name},null,8,["title"]),f(ve,{page:h.page,page_options:h.page_options},{header:E(()=>[e("h2",Ne,[S(" Cálculo de Horas Extras "),h.user?(s(),r("div",Me,[e("p",Pe,u(h.user.name)+" "+u(h.user.surname),1),e("p",Ue,u(d(U)(h.procedure_date)),1)])):T("",!0)])]),default:E(()=>[e("div",Fe,[e("div",Ie,[e("div",Oe,[e("div",He,[je,c.value?T("",!0):(s(),r("div",Be,[e("label",De,[k(e("input",{type:"checkbox",disabled:c.value,"onUpdate:modelValue":n[0]||(n[0]=a=>C.value=a),class:"sr-only peer disabled:opacity-50"},null,8,Le),[[L,C.value]]),Je,Xe]),e("button",{class:"p-2 rounded-md bg-green-700 hover:bg-green-800 active:bg-green-900 text-white disabled:opacity-50",onClick:ee,disabled:c.value},"Resetar Tabela",8,Ke)])),e("button",{class:"text-xs text-green-600 hover:text-green-800 active:text-green-950 select-none disabled:opacity-50",onClick:oe},"Ver registros anteriores"),c.value?(s(),r("a",{key:1,href:t.route("employee.overtime_calculation"),class:"text-xs text-orange-500 hover:text-orange-700 active:text-orange-900 select-none disabled:opacity-50"},"Voltar para tabela normal",8,qe)):(s(),r("div",ze,[o.value?(s(),r("p",Re,"Existem alterações não salvas (aguarde até 10 segundos)")):(s(),r("p",We,"Todas as alteraçẽos estão salvas"))]))])])])]),e("div",Ze,[e("div",Ge,[e("div",Qe,[e("div",Ye,[e("div",et,[e("div",tt,[e("div",at,[e("div",nt,[e("table",st,[e("thead",ot,[e("tr",rt,[c.value?T("",!0):(s(),r("th",it,[S(" Mostrar "),e("span",lt,[e("button",{class:"text-green-700 hover:text-green-800 active:text-green-900 text-xs disabled:opacity-50",onClick:te,disabled:c.value},"Alternar",8,ct)])])),dt,ut,pt,_t,ht,vt,ft,e("th",{scope:"col",class:V(["px-6 py-4 print:px-3 print:py-2 text-center",{"opacity-50 print:hidden":!g.value}])},[S(" Valor 50% "),e("span",xt,[k(e("input",{type:"checkbox",class:"focus:bg-green-700 focus:ring-green-700 text-green-700 border-neutral-500 rounded-sm disabled:opacity-50","onUpdate:modelValue":n[1]||(n[1]=a=>g.value=a)},null,512),[[L,g.value]])])],2),e("th",{scope:"col",class:V(["px-6 py-4 print:px-3 print:py-2 text-center",{"opacity-50 print:hidden":!w.value}])},[S(" Valor 100% "),e("span",mt,[k(e("input",{type:"checkbox",class:"focus:bg-green-700 focus:ring-green-700 text-green-700 border-neutral-500 rounded-sm disabled:opacity-50","onUpdate:modelValue":n[2]||(n[2]=a=>w.value=a)},null,512),[[L,w.value]])])],2),bt])]),e("tbody",null,[l.value.length?(s(!0),r(J,{key:0},Y(l.value,a=>{var v,b,$;return s(),r("tr",{class:V(["border-b transition duration-100 hover:bg-neutral-100 print:break-inside-avoid text-sm print:text-md",{"opacity-50 print:hidden":!a.show,hidden:!a.show&&!C.value}])},[c.value?T("",!0):(s(),r("td",gt,[e("input",{type:"checkbox",class:"focus:bg-green-700 focus:ring-green-700 text-green-700 border-neutral-500 rounded-sm disabled:opacity-50",value:a.show,onChange:i=>K(a),checked:a.show,disabled:c.value},null,40,wt)])),e("td",kt,u(a.name+" "+a.surname),1),e("td",yt,u(d(M)(a.salary||0)),1),e("td",Ct,[e("button",{class:"absolute left-0 top-1/2 transform -translate-y-1/2 text-neutral-300 hover:text-neutral-500 active:text-neutral-700 ml-3 disabled:opacity-50",onClick:i=>F(a.check_in_time,"check_in_time"),disabled:c.value},[f(d(O),{class:"w-3 h-3"})],8,$t),k(e("input",{type:"time",class:"focus:ring-green-700 simple-input pl-8 disabled:opacity-50",disabled:!a.show||c.value,"onUpdate:modelValue":i=>a.check_in_time=i,onInput:n[3]||(n[3]=i=>o.value=!0)},null,40,Vt),[[P,a.check_in_time]])]),e("td",Tt,[e("button",{class:"absolute left-0 top-1/2 transform -translate-y-1/2 text-neutral-300 hover:text-neutral-500 active:text-neutral-700 ml-3 disabled:opacity-50",onClick:i=>F(a.leave_for_lunch_break,"leave_for_lunch_break"),disabled:c.value},[f(d(O),{class:"w-3 h-3"})],8,Et),k(e("input",{type:"time",class:"focus:ring-green-700 simple-input pl-8 disabled:opacity-50",disabled:!a.show||c.value,"onUpdate:modelValue":i=>a.leave_for_lunch_break=i,onInput:n[4]||(n[4]=i=>o.value=!0)},null,40,St),[[P,a.leave_for_lunch_break]])]),e("td",At,[e("button",{class:"absolute left-0 top-1/2 transform -translate-y-1/2 text-neutral-300 hover:text-neutral-500 active:text-neutral-700 ml-3 disabled:opacity-50",onClick:i=>F(a.check_in_after_lunch_break,"check_in_after_lunch_break"),disabled:c.value},[f(d(O),{class:"w-3 h-3"})],8,Nt),k(e("input",{type:"time",class:"focus:ring-green-700 simple-input pl-8 disabled:opacity-50",disabled:!a.show||c.value,"onUpdate:modelValue":i=>a.check_in_after_lunch_break=i,onInput:n[5]||(n[5]=i=>o.value=!0)},null,40,Mt),[[P,a.check_in_after_lunch_break]])]),e("td",Pt,[e("button",{class:"absolute left-0 top-1/2 transform -translate-y-1/2 text-neutral-300 hover:text-neutral-500 active:text-neutral-700 ml-3 disabled:opacity-50",onClick:i=>F(a.check_out_time,"check_out_time"),disabled:c.value},[f(d(O),{class:"w-3 h-3"})],8,Ut),k(e("input",{type:"time",class:"focus:ring-green-700 simple-input pl-8 disabled:opacity-50",disabled:!a.show||c.value,"onUpdate:modelValue":i=>a.check_out_time=i,onInput:n[6]||(n[6]=i=>o.value=!0)},null,40,Ft),[[P,a.check_out_time]])]),e("td",It,u(se(a)),1),e("td",{class:V(["whitespace-nowrap py-1 print:p-0 text-center font-medium bg-neutral-50",{"opacity-50 print:hidden":!g.value}])},u(d(M)(a.fifty_percent_value||0)),3),e("td",{class:V(["whitespace-nowrap py-1 print:p-0 text-center font-medium bg-neutral-100",{"opacity-50 print:hidden":!w.value}])},u(d(M)(a.hundred_percent_value||0)),3),e("td",{class:"whitespace-nowrap py-1 print:p-0 text-center font-medium hover:text-green-600 active:text-green-700 cursor-pointer",title:"Clique para copiar PIX para área de transferência",onClick:i=>{var D;return(D=a.overtime_payment_method)!=null&&D.cod?ne(a):null}},[e("span",Ht,[S(u((v=a.overtime_payment_method)!=null&&v.cod?a[a.overtime_payment_method.cod]:"-")+" ",1),(b=a.overtime_payment_method)!=null&&b.cod?(s(),Q(d(ge),{key:0,class:"w-4 h-4 print:hidden"})):T("",!0)])],8,Ot),e("td",jt,u(ae((($=a.overtime_payment_method)==null?void 0:$.cod)||"-")),1)],2)}),256)):T("",!0),l.value.length?(s(),r("tr",Bt,[c.value?(s(),r("td",Dt)):(s(),r("td",Lt)),Jt,e("td",{class:V(["whitespace-nowrap py-1 print:p-0 text-center font-medium",{"opacity-50 print:hidden":!g.value}])},u(d(M)(q.value.totalFiftyPercentValue||0)),3),e("td",{class:V(["whitespace-nowrap py-1 print:p-0 text-center font-medium",{"opacity-50 print:hidden":!w.value}])},u(d(M)(q.value.totalHundredPercentValue||0)),3),Xt])):(s(),r("tr",Kt,zt))])])])])])])])])])]),f(be,{mode:["rollup","print_page"]}),f(Ae,{modal:j.value,onClose:re},null,8,["modal"])]),_:1},8,["page","page_options"])],64))}};export{oa as default};
